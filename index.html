<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<title>SecureUp ‚Äî CompTIA Security+ SY0-701 Mastery</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=JetBrains+Mono:wght@400;500&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
/* v4.1-CACHE-BUST-20250225 - Domain 4 complete with subsections */
:root {
  --bg: #0a0b0f;
  --bg2: #111318;
  --bg3: #1a1d25;
  --surface: #1e2230;
  --surface2: #252a3a;
  --border: #2e3448;
  --border2: #3d4460;
  --accent: #4f8ef7;
  --accent2: #7c5cfc;
  --accent3: #00e5c5;
  --warn: #ff7b39;
  --danger: #ff4d6d;
  --success: #22d06b;
  --text: #e8ecf4;
  --text2: #9aa3be;
  --text3: #5c647e;
  --glow: 0 0 30px rgba(79,142,247,0.15);
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: 'Inter', sans-serif;
  min-height: 100vh;
  overflow-x: hidden;
}

/* ‚îÄ‚îÄ‚îÄ‚îÄ PARTICLES BG ‚îÄ‚îÄ‚îÄ‚îÄ */
#canvas-bg {
  position: fixed; top:0; left:0; width:100%; height:100%;
  pointer-events:none; z-index:0; opacity:0.4;
}

/* ‚îÄ‚îÄ‚îÄ‚îÄ APP SHELL ‚îÄ‚îÄ‚îÄ‚îÄ */
#app { position:relative; z-index:1; }

/* ‚îÄ‚îÄ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ‚îÄ */
header {
  display:flex; align-items:center; justify-content:space-between;
  padding: 16px 32px;
  border-bottom: 1px solid var(--border);
  background: rgba(10,11,15,0.9);
  backdrop-filter: blur(20px);
  position: sticky; top:0; z-index:100;
}

.logo {
  font-family: 'Syne', sans-serif;
  font-weight: 800; font-size: 22px;
  background: linear-gradient(135deg, var(--accent), var(--accent3));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  letter-spacing: -0.5px;
}
.logo span { color: var(--text2); -webkit-text-fill-color: var(--text2); font-weight:400; font-size:13px; margin-left:8px; }

.header-right { display:flex; align-items:center; gap:16px; }

.xp-pill {
  display:flex; align-items:center; gap:8px;
  background: var(--surface); border:1px solid var(--border);
  border-radius: 20px; padding: 6px 14px;
  font-size: 13px; font-family: 'JetBrains Mono', monospace;
}
.xp-pill .xp-val { color: var(--accent3); font-weight:600; }
.xp-pill .lvl { color: var(--text2); }

.streak-pill {
  display:flex; align-items:center; gap:6px;
  background: var(--surface); border:1px solid var(--border);
  border-radius: 20px; padding: 6px 14px;
  font-size: 13px;
}
.streak-pill .fire { font-size:16px; }
.streak-pill span { color: var(--warn); font-weight:600; font-family: 'JetBrains Mono', monospace; }

/* ‚îÄ‚îÄ‚îÄ‚îÄ NAV ‚îÄ‚îÄ‚îÄ‚îÄ */
nav {
  display:flex; gap:4px;
  background: var(--bg2);
  border-bottom: 1px solid var(--border);
  padding: 0 32px;
}

.nav-btn {
  padding: 14px 24px;
  background: none; border: none; cursor:pointer;
  color: var(--text2); font-family:'Syne',sans-serif;
  font-weight:600; font-size:14px; letter-spacing:0.3px;
  border-bottom: 2px solid transparent;
  transition: all 0.2s;
}
.nav-btn:hover { color: var(--text); }
.nav-btn.active { color: var(--accent); border-bottom-color: var(--accent); }

/* ‚îÄ‚îÄ‚îÄ‚îÄ MAIN CONTENT ‚îÄ‚îÄ‚îÄ‚îÄ */
main { padding: 32px; max-width: 1200px; margin: 0 auto; }

/* ‚îÄ‚îÄ‚îÄ‚îÄ HOME DASHBOARD ‚îÄ‚îÄ‚îÄ‚îÄ */
#view-home { display:none; }
#view-home.active { display:block; }

.dashboard-hero {
  background: linear-gradient(135deg, rgba(79,142,247,0.1) 0%, rgba(124,92,252,0.1) 100%);
  border: 1px solid var(--border2);
  border-radius: 20px;
  padding: 40px;
  margin-bottom: 32px;
  position: relative;
  overflow: hidden;
}
.dashboard-hero::before {
  content:'';
  position:absolute; top:-50%; right:-10%;
  width:400px; height:400px;
  background: radial-gradient(circle, rgba(79,142,247,0.08) 0%, transparent 70%);
  pointer-events:none;
}

.hero-title {
  font-family:'Syne',sans-serif;
  font-size:36px; font-weight:800;
  line-height:1.2; margin-bottom:8px;
}
.hero-sub { color: var(--text2); font-size:16px; margin-bottom:28px; line-height:1.6; }

.progress-container { margin-top:24px; }
.progress-label {
  display:flex; justify-content:space-between;
  font-size:13px; color: var(--text2); margin-bottom:8px;
}
.progress-bar {
  height:8px; background:var(--bg3);
  border-radius:99px; overflow:hidden;
}
.progress-fill {
  height:100%;
  background: linear-gradient(90deg, var(--accent), var(--accent3));
  border-radius:99px;
  transition: width 0.8s cubic-bezier(0.4,0,0.2,1);
}

.domain-grid {
  display:grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap:16px; margin-bottom:32px;
}

.domain-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius:16px; padding:24px;
  cursor:pointer;
  transition: all 0.25s;
  position:relative; overflow:hidden;
}
.domain-card::before {
  content:'';
  position:absolute; top:0; left:0; right:0; height:3px;
  background: var(--domain-color, var(--accent));
}
.domain-card:hover {
  border-color: var(--border2);
  background: var(--surface2);
  transform: translateY(-2px);
  box-shadow: var(--glow);
}

.domain-badge {
  display:inline-flex; align-items:center; gap:6px;
  background: rgba(255,255,255,0.06);
  border-radius:8px; padding:4px 10px;
  font-size:11px; font-family:'JetBrains Mono',monospace;
  color: var(--text2); margin-bottom:12px;
}

.domain-name {
  font-family:'Syne',sans-serif;
  font-weight:700; font-size:17px;
  margin-bottom:6px; line-height:1.3;
}

.domain-meta {
  display:flex; align-items:center; gap:12px;
  font-size:12px; color: var(--text2); margin-bottom:16px;
}

.domain-pct {
  font-family:'JetBrains Mono',monospace;
  font-size:11px;
  background: var(--bg);
  border:1px solid var(--border);
  border-radius:6px; padding:2px 8px;
  color: var(--accent3);
}

.domain-progress {
  height:4px; background:var(--bg);
  border-radius:99px; overflow:hidden;
}
.domain-progress-fill {
  height:100%;
  border-radius:99px;
  background: var(--domain-color, var(--accent));
  transition: width 0.6s;
}

/* ‚îÄ‚îÄ‚îÄ‚îÄ LEARN VIEW ‚îÄ‚îÄ‚îÄ‚îÄ */
#view-learn { display:none; }
#view-learn.active { display:block; }

.learn-layout {
  display:grid; grid-template-columns: 280px 1fr;
  gap:24px; align-items:start;
}

.sidebar {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius:16px;
  overflow:hidden;
  position:sticky; top:90px;
}

.sidebar-header {
  padding:20px; border-bottom:1px solid var(--border);
  font-family:'Syne',sans-serif; font-weight:700;
  font-size:14px; color: var(--text2);
  text-transform:uppercase; letter-spacing:0.8px;
}

.sidebar-domain {
  padding: 4px 0;
}
.sidebar-domain-header {
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 20px; cursor:pointer;
  font-family:'Syne',sans-serif; font-weight:600; font-size:13px;
  transition:background 0.15s;
}
.sidebar-domain-header:hover { background: var(--surface2); }
.sidebar-domain-header .d-num {
  font-family:'JetBrains Mono',monospace; font-size:11px;
  color: var(--domain-color, var(--accent));
  background: rgba(255,255,255,0.05);
  border-radius:4px; padding:2px 6px;
}
.sidebar-domain-header .chevron {
  color: var(--text3); font-size:10px;
  transition:transform 0.2s;
}
.sidebar-domain-header.open .chevron { transform:rotate(90deg); }

.sidebar-topics { display:none; }
.sidebar-topics.open { display:block; }
.sidebar-topic-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 16px 4px;
  margin-top: 6px;
}
.topic-obj-id {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px;
  font-weight: 600;
  color: var(--accent);
  background: rgba(79,142,247,0.12);
  border: 1px solid rgba(79,142,247,0.25);
  border-radius: 4px;
  padding: 2px 6px;
  white-space: nowrap;
  flex-shrink: 0;
}
.topic-obj-name {
  font-size: 10px;
  font-weight: 600;
  color: var(--text3);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}
.sidebar-topic.indented {
  padding-left: 28px;
}
.sidebar-topic {
  display:flex; align-items:center; gap:10px;
  padding:9px 20px 9px 36px;
  font-size:12px; color:var(--text2); cursor:pointer;
  transition:all 0.15s;
  border-left: 2px solid transparent;
}
.sidebar-topic:hover { background: var(--surface2); color:var(--text); }
.sidebar-topic.active { color:var(--accent); border-left-color:var(--accent); background:rgba(79,142,247,0.07); }
.sidebar-topic .check { width:14px; height:14px; border-radius:50%; background:var(--bg3); border:1px solid var(--border); flex-shrink:0; display:flex;align-items:center;justify-content:center;font-size:8px; }
.sidebar-topic.done .check { background:var(--success); border-color:var(--success); color:#fff; }

/* ‚îÄ‚îÄ‚îÄ‚îÄ LESSON CONTENT ‚îÄ‚îÄ‚îÄ‚îÄ */
.lesson-pane {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius:16px;
  overflow:hidden;
  min-height: 600px;
}

.lesson-header {
  padding:28px 36px 24px;
  border-bottom:1px solid var(--border);
  background: linear-gradient(135deg, rgba(79,142,247,0.05), transparent);
}

.lesson-domain-badge {
  display:inline-flex; align-items:center; gap:6px;
  padding:4px 12px; border-radius:20px;
  font-size:11px; font-family:'JetBrains Mono',monospace;
  border:1px solid; margin-bottom:12px;
}

.lesson-title {
  font-family:'Syne',sans-serif;
  font-size:26px; font-weight:800; line-height:1.3;
  margin-bottom:8px;
}
.lesson-subtitle { color:var(--text2); font-size:14px; line-height:1.6; }

.lesson-body { padding:36px; }

/* Content blocks */
.concept-block {
  margin-bottom:32px;
}
.concept-title {
  font-family:'Syne',sans-serif;
  font-weight:700; font-size:18px;
  margin-bottom:16px;
  display:flex; align-items:center; gap:10px;
}
.concept-title .icon {
  width:32px; height:32px; border-radius:8px;
  display:flex; align-items:center; justify-content:center;
  font-size:16px; flex-shrink:0;
}

.analogy-box {
  background: rgba(0,229,197,0.06);
  border:1px solid rgba(0,229,197,0.2);
  border-radius:12px; padding:20px;
  margin-bottom:16px;
}
.analogy-box .label {
  font-size:11px; font-family:'JetBrains Mono',monospace;
  color: var(--accent3); font-weight:600;
  text-transform:uppercase; letter-spacing:0.8px;
  margin-bottom:8px;
}
.analogy-box p { font-size:14px; line-height:1.7; color:var(--text2); }
.analogy-box p strong { color:var(--text); }

.definition-box {
  background: rgba(79,142,247,0.06);
  border:1px solid rgba(79,142,247,0.2);
  border-radius:12px; padding:20px;
  margin-bottom:16px;
}
.definition-box .label {
  font-size:11px; font-family:'JetBrains Mono',monospace;
  color: var(--accent); font-weight:600;
  text-transform:uppercase; letter-spacing:0.8px;
  margin-bottom:8px;
}
.definition-box p { font-size:14px; line-height:1.7; color:var(--text2); }
.definition-box p strong { color:var(--text); }

.tip-box {
  background: rgba(255,123,57,0.07);
  border:1px solid rgba(255,123,57,0.2);
  border-radius:12px; padding:20px;
  margin-bottom:16px;
}
.tip-box .label {
  font-size:11px; font-family:'JetBrains Mono',monospace;
  color: var(--warn); font-weight:600;
  text-transform:uppercase; letter-spacing:0.8px;
  margin-bottom:8px;
}
.tip-box p { font-size:14px; line-height:1.7; color:var(--text2); }
.tip-box p strong { color:var(--text); }

.concept-text { font-size:14px; line-height:1.8; color:var(--text2); margin-bottom:12px; }
.concept-text strong { color:var(--text); }

.term-grid {
  display:grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap:10px; margin-bottom:16px;
}
.term-card {
  background: var(--bg);
  border:1px solid var(--border);
  border-radius:10px; padding:14px;
  transition: all 0.2s;
}
.term-card:hover { border-color:var(--border2); }
.term-card .term { font-family:'JetBrains Mono',monospace; font-size:13px; font-weight:600; color:var(--accent); margin-bottom:6px; }
.term-card .def { font-size:12px; color:var(--text2); line-height:1.5; }

.table-wrap { overflow-x:auto; margin-bottom:16px; }
table { width:100%; border-collapse:collapse; font-size:13px; }
th { background:var(--bg); color:var(--text2); font-family:'JetBrains Mono',monospace; font-size:11px; text-transform:uppercase; letter-spacing:0.5px; padding:10px 14px; text-align:left; border:1px solid var(--border); }
td { padding:10px 14px; border:1px solid var(--border); color:var(--text2); line-height:1.5; }
td strong { color:var(--text); }
tr:nth-child(even) td { background:rgba(255,255,255,0.02); }

.lesson-nav {
  display:flex; justify-content:space-between; align-items:center;
  padding:24px 36px;
  border-top:1px solid var(--border);
  background: var(--bg2);
}

.btn {
  display:inline-flex; align-items:center; gap:8px;
  padding:10px 22px; border-radius:10px;
  font-family:'Syne',sans-serif; font-weight:600; font-size:14px;
  cursor:pointer; border:none; transition:all 0.2s;
}
.btn-primary {
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  color:#fff;
  box-shadow: 0 4px 16px rgba(79,142,247,0.3);
}
.btn-primary:hover { transform:translateY(-1px); box-shadow: 0 6px 20px rgba(79,142,247,0.4); }
.btn-secondary {
  background: var(--surface2); color:var(--text);
  border:1px solid var(--border);
}
.btn-secondary:hover { background:var(--bg3); border-color:var(--border2); }
.btn-success {
  background: linear-gradient(135deg, var(--success), #1ab05a);
  color:#fff;
  box-shadow: 0 4px 16px rgba(34,208,107,0.3);
}
.btn-warn {
  background: linear-gradient(135deg, var(--warn), #e56020);
  color:#fff;
}
.btn-danger {
  background: linear-gradient(135deg, var(--danger), #c9193e);
  color:#fff;
}
.btn:disabled { opacity:0.4; cursor:not-allowed; transform:none !important; }

/* ‚îÄ‚îÄ‚îÄ‚îÄ MID-SECTION QUIZ ‚îÄ‚îÄ‚îÄ‚îÄ */
.quiz-section {
  background: rgba(124,92,252,0.06);
  border:1px solid rgba(124,92,252,0.2);
  border-radius:16px;
  padding:28px; margin-top:32px;
}
.quiz-section-header {
  display:flex; align-items:center; gap:12px;
  margin-bottom:24px;
}
.quiz-section-header .qs-icon {
  width:40px; height:40px; border-radius:10px;
  background: rgba(124,92,252,0.2);
  display:flex; align-items:center; justify-content:center;
  font-size:18px;
}
.quiz-section-header h3 {
  font-family:'Syne',sans-serif; font-weight:700; font-size:18px;
}
.quiz-section-header p { font-size:12px; color:var(--text2); margin-top:2px; }

/* ‚îÄ‚îÄ‚îÄ‚îÄ PROVE VIEW ‚îÄ‚îÄ‚îÄ‚îÄ */
#view-prove { display:none; }
#view-prove.active { display:block; }

.prove-header {
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom:28px;
}
.prove-title {
  font-family:'Syne',sans-serif; font-weight:800; font-size:28px;
}
.prove-meta { color:var(--text2); font-size:14px; margin-top:4px; }

.prove-modes {
  display:grid; grid-template-columns: repeat(3, 1fr);
  gap:16px; margin-bottom:32px;
}
.mode-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius:16px; padding:24px;
  cursor:pointer; transition:all 0.25s;
  text-align:center;
}
.mode-card:hover { border-color:var(--border2); background:var(--surface2); transform:translateY(-2px); }
.mode-card.selected { border-color:var(--accent); background:rgba(79,142,247,0.08); }
.mode-card .mode-icon { font-size:32px; margin-bottom:12px; }
.mode-card .mode-name { font-family:'Syne',sans-serif; font-weight:700; font-size:16px; margin-bottom:6px; }
.mode-card .mode-desc { font-size:12px; color:var(--text2); line-height:1.5; }

/* ‚îÄ‚îÄ‚îÄ‚îÄ QUESTION UI ‚îÄ‚îÄ‚îÄ‚îÄ */
.question-ui {
  background: var(--surface);
  border:1px solid var(--border);
  border-radius:16px;
  overflow:hidden;
}

.q-header {
  display:flex; align-items:center; justify-content:space-between;
  padding:16px 24px;
  background:var(--bg2);
  border-bottom:1px solid var(--border);
}
.q-progress-track {
  flex:1; height:6px; background:var(--bg3);
  border-radius:99px; overflow:hidden; margin:0 16px;
}
.q-progress-fill {
  height:100%;
  background: linear-gradient(90deg, var(--accent), var(--accent3));
  border-radius:99px;
  transition: width 0.4s;
}
.q-counter {
  font-family:'JetBrains Mono',monospace; font-size:13px; color:var(--text2);
  white-space:nowrap;
}
.q-difficulty {
  padding:3px 10px; border-radius:20px;
  font-size:10px; font-family:'JetBrains Mono',monospace; font-weight:600;
  text-transform:uppercase; letter-spacing:0.5px;
}
.diff-easy { background:rgba(34,208,107,0.15); color:var(--success); }
.diff-medium { background:rgba(79,142,247,0.15); color:var(--accent); }
.diff-hard { background:rgba(255,123,57,0.15); color:var(--warn); }
.diff-expert { background:rgba(255,77,109,0.15); color:var(--danger); }

.q-body { padding:32px; }
.q-domain-tag {
  display:inline-flex; align-items:center; gap:6px;
  padding:4px 12px; border-radius:20px;
  font-size:11px; font-family:'JetBrains Mono',monospace;
  border:1px solid; margin-bottom:20px;
}

.q-text {
  font-size:17px; line-height:1.7; color:var(--text);
  margin-bottom:28px; font-weight:400;
}

.q-scenario {
  background:var(--bg);
  border:1px solid var(--border);
  border-left:3px solid var(--accent);
  border-radius:8px; padding:16px;
  font-size:13px; line-height:1.7;
  font-family:'JetBrains Mono',monospace; color:var(--text2);
  margin-bottom:20px;
}

.choices { display:flex; flex-direction:column; gap:10px; margin-bottom:24px; }

.choice-btn {
  display:flex; align-items:flex-start; gap:14px;
  padding:16px 18px; border-radius:12px;
  background:var(--bg2); border:1.5px solid var(--border);
  cursor:pointer; text-align:left; transition:all 0.2s;
  font-size:14px; color:var(--text); line-height:1.5;
}
.choice-btn:hover:not(:disabled) { border-color:var(--accent); background:rgba(79,142,247,0.07); }
.choice-btn .choice-letter {
  min-width:26px; height:26px; border-radius:6px;
  background:var(--surface); border:1px solid var(--border2);
  display:flex; align-items:center; justify-content:center;
  font-family:'JetBrains Mono',monospace; font-size:12px; font-weight:600;
  color:var(--text2); flex-shrink:0; margin-top:1px;
}
.choice-btn.correct { border-color:var(--success); background:rgba(34,208,107,0.09); }
.choice-btn.correct .choice-letter { background:var(--success); color:#fff; border-color:var(--success); }
.choice-btn.incorrect { border-color:var(--danger); background:rgba(255,77,109,0.09); }
.choice-btn.incorrect .choice-letter { background:var(--danger); color:#fff; border-color:var(--danger); }
.choice-btn:disabled { cursor:not-allowed; }

/* Multi-select */
.choice-btn.multi-selected { border-color:var(--accent2); background:rgba(124,92,252,0.09); }
.choice-btn.multi-selected .choice-letter { background:var(--accent2); color:#fff; border-color:var(--accent2); }

.q-feedback {
  display:none;
  margin-top:20px;
}
.q-feedback.show { display:block; }

.feedback-correct {
  background:rgba(34,208,107,0.09);
  border:1px solid rgba(34,208,107,0.3);
  border-radius:12px; padding:20px;
}
.feedback-incorrect {
  background:rgba(255,77,109,0.07);
  border:1px solid rgba(255,77,109,0.25);
  border-radius:12px; padding:20px;
}

.feedback-title {
  font-family:'Syne',sans-serif; font-weight:700; font-size:16px;
  margin-bottom:8px; display:flex; align-items:center; gap:8px;
}
.feedback-title.good { color:var(--success); }
.feedback-title.bad { color:var(--danger); }

.feedback-explain {
  font-size:13px; line-height:1.7; color:var(--text2);
}
.feedback-explain strong { color:var(--text); }

.q-footer {
  display:flex; justify-content:flex-end; align-items:center;
  padding:20px 32px;
  border-top:1px solid var(--border);
  gap:12px;
}

/* ‚îÄ‚îÄ‚îÄ‚îÄ STATS VIEW ‚îÄ‚îÄ‚îÄ‚îÄ */
#view-stats { display:none; }
#view-stats.active { display:block; }

.stats-grid {
  display:grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap:16px; margin-bottom:32px;
}
.stat-card {
  background:var(--surface); border:1px solid var(--border);
  border-radius:14px; padding:20px;
}
.stat-card .stat-label { font-size:11px; color:var(--text3); font-family:'JetBrains Mono',monospace; text-transform:uppercase; letter-spacing:0.5px; margin-bottom:8px; }
.stat-card .stat-value { font-family:'Syne',sans-serif; font-weight:800; font-size:32px; }
.stat-card .stat-sub { font-size:12px; color:var(--text2); margin-top:4px; }

/* ‚îÄ‚îÄ‚îÄ‚îÄ MODALS ‚îÄ‚îÄ‚îÄ‚îÄ */
.modal-overlay {
  display:none;
  position:fixed; inset:0; z-index:200;
  background:rgba(0,0,0,0.7);
  backdrop-filter:blur(8px);
  align-items:center; justify-content:center;
}
.modal-overlay.open { display:flex; }
.modal {
  background:var(--bg2);
  border:1px solid var(--border2);
  border-radius:20px;
  padding:36px;
  max-width:560px; width:90%;
  animation: modalIn 0.3s cubic-bezier(0.34,1.56,0.64,1);
}
@keyframes modalIn {
  from { opacity:0; transform:scale(0.9) translateY(20px); }
  to { opacity:1; transform:scale(1) translateY(0); }
}
.modal-title { font-family:'Syne',sans-serif; font-weight:800; font-size:22px; margin-bottom:8px; }
.modal-sub { color:var(--text2); font-size:14px; line-height:1.6; margin-bottom:24px; }
.modal-actions { display:flex; gap:12px; justify-content:flex-end; }

/* ‚îÄ‚îÄ‚îÄ‚îÄ ANIMATIONS ‚îÄ‚îÄ‚îÄ‚îÄ */
.fade-in { animation: fadeIn 0.4s ease; }
@keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

.pulse { animation: pulse 2s infinite; }
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.6} }

/* ‚îÄ‚îÄ‚îÄ‚îÄ SECTION DIVIDER ‚îÄ‚îÄ‚îÄ‚îÄ */
.section-title {
  font-family:'Syne',sans-serif; font-weight:700; font-size:18px;
  color:var(--text); margin-bottom:16px;
  display:flex; align-items:center; gap:10px;
}
.section-title::after {
  content:''; flex:1; height:1px; background:var(--border);
}

/* ‚îÄ‚îÄ‚îÄ‚îÄ SCROLLBAR ‚îÄ‚îÄ‚îÄ‚îÄ */
::-webkit-scrollbar { width:6px; height:6px; }
::-webkit-scrollbar-track { background:var(--bg2); }
::-webkit-scrollbar-thumb { background:var(--border2); border-radius:3px; }

/* ‚îÄ‚îÄ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ‚îÄ‚îÄ */
@media (max-width:768px) {
  main { padding:16px; }
  .learn-layout { grid-template-columns:1fr; }
  .sidebar { position:static; }
  .prove-modes { grid-template-columns:1fr; }
  header { padding:12px 16px; }
  nav { padding:0 16px; }
  .nav-btn { padding:12px 14px; font-size:13px; }
}
</style>
</head>
<body>

<canvas id="canvas-bg"></canvas>

<div id="app">
  <!-- HEADER -->
  <header>
    <div style="display:flex;align-items:center;gap:16px">
      <div class="logo">SecureUp <span>SY0-701</span></div>
    </div>
    <div class="header-right">
      <div class="streak-pill">
        <span class="fire">üî•</span>
        <span id="streak-val">0</span>
      </div>
      <div class="xp-pill">
        <span class="lvl">LVL <span id="lvl-val">1</span></span>
        <span>¬∑</span>
        <span class="xp-val"><span id="xp-val">0</span> XP</span>
      </div>
    </div>
  </header>

  <!-- NAV -->
  <nav>
    <button class="nav-btn active" onclick="showView('home')">üè† Dashboard</button>
    <button class="nav-btn" onclick="showView('learn')">üìñ Learn</button>
    <button class="nav-btn" onclick="showView('prove')">‚ö° Prove It</button>
    <button class="nav-btn" onclick="showView('stats')">üìä Progress</button>
  </nav>

  <main>
    <!-- HOME -->
    <div id="view-home" class="active">
      <div class="dashboard-hero fade-in">
        <div class="hero-title">Welcome back, Security Pro üõ°Ô∏è</div>
        <div class="hero-sub">You're training for the CompTIA Security+ SY0-701. Master all 5 domains and become an entry-level analyst who actually knows their stuff.</div>
        <div class="progress-container">
          <div class="progress-label">
            <span>Overall Mastery</span>
            <span id="overall-pct">0%</span>
          </div>
          <div class="progress-bar"><div class="progress-fill" id="overall-fill" style="width:0%"></div></div>
        </div>
      </div>

      <div class="section-title">The 5 Domains</div>

      <div class="domain-grid" id="domain-grid"></div>

      <div class="section-title">Quick Actions</div>
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <button class="btn btn-primary" onclick="showView('learn');selectFirstLesson()">üìñ Continue Learning</button>
        <button class="btn btn-warn" onclick="startProveMode('adaptive')">‚ö° Quick Quiz (10Q)</button>
        <button class="btn btn-secondary" onclick="showView('prove')">üéØ Full Practice Exam</button>
      </div>
    </div>

    <!-- LEARN -->
    <div id="view-learn">
      <div class="learn-layout">
        <div class="sidebar" id="learn-sidebar"></div>
        <div class="lesson-pane fade-in" id="lesson-content">
          <div style="display:flex;align-items:center;justify-content:center;height:400px;flex-direction:column;gap:16px;color:var(--text2)">
            <div style="font-size:48px">üìö</div>
            <div style="font-family:'Syne',sans-serif;font-size:20px;font-weight:700;color:var(--text)">Select a topic to begin</div>
            <div style="font-size:14px">Choose a domain and lesson from the sidebar</div>
          </div>
        </div>
      </div>
    </div>

    <!-- PROVE -->
    <div id="view-prove">
      <div class="prove-header">
        <div>
          <div class="prove-title">‚ö° Prove It</div>
          <div class="prove-meta">Adaptive quizzing that gets harder as you improve ‚Äî just like exam day</div>
        </div>
      </div>

      <div id="prove-setup">
        <div class="section-title">Choose Your Mode</div>
        <div class="prove-modes">
          <div class="mode-card selected" onclick="selectMode('adaptive')" id="mode-adaptive">
            <div class="mode-icon">üß†</div>
            <div class="mode-name">Adaptive Quiz</div>
            <div class="mode-desc">Starts easy, gets harder. The algorithm tracks your weak spots and targets them ruthlessly.</div>
          </div>
          <div class="mode-card" onclick="selectMode('exam')" id="mode-exam">
            <div class="mode-icon">üéØ</div>
            <div class="mode-name">Full Sim Exam</div>
            <div class="mode-desc">90 minutes. 90 questions. Mixed multiple-choice and performance-based. Real exam format.</div>
          </div>
          <div class="mode-card" onclick="selectMode('domain')" id="mode-domain">
            <div class="mode-icon">üî¨</div>
            <div class="mode-name">Domain Drill</div>
            <div class="mode-desc">Hammer one domain until you know it cold. Perfect for targeting weak areas.</div>
          </div>
        </div>

        <div id="domain-selector" style="display:none;margin-bottom:24px;">
          <div class="section-title">Select Domain</div>
          <div style="display:flex;flex-wrap:wrap;gap:10px" id="domain-select-btns"></div>
        </div>

        <div style="display:flex;gap:12px;align-items:center">
          <div style="flex:1">
            <div style="font-size:13px;color:var(--text2);margin-bottom:8px">Questions</div>
            <div style="display:flex;gap:8px">
              <button class="btn btn-secondary" id="q10" onclick="setQCount(10)" style="padding:8px 16px;font-size:13px">10</button>
              <button class="btn btn-secondary active-q" id="q25" onclick="setQCount(25)" style="padding:8px 16px;font-size:13px">25</button>
              <button class="btn btn-secondary" id="q50" onclick="setQCount(50)" style="padding:8px 16px;font-size:13px">50</button>
              <button class="btn btn-secondary" id="q90" onclick="setQCount(90)" style="padding:8px 16px;font-size:13px">90 (Exam)</button>
            </div>
          </div>
          <button class="btn btn-primary" style="margin-top:24px;padding:12px 28px" onclick="startProveMode(currentMode)">
            Start Session ‚Üí
          </button>
        </div>
      </div>

      <div id="prove-quiz" style="display:none"></div>
    </div>

    <!-- STATS -->
    <div id="view-stats">
      <div style="font-family:'Syne',sans-serif;font-weight:800;font-size:28px;margin-bottom:24px">üìä Your Progress</div>
      <div class="stats-grid" id="stats-grid"></div>
      <div class="section-title">Domain Performance</div>
      <div id="domain-stats"></div>
    </div>
  </main>
</div>

<!-- QUIZ COMPLETE MODAL -->
<div class="modal-overlay" id="quiz-done-modal">
  <div class="modal">
    <div id="modal-content"></div>
    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="closeModal();showView('prove')">Back to Setup</button>
      <button class="btn btn-primary" onclick="closeModal();startProveMode(currentMode)">Again ‚Üí</button>
    </div>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PARTICLE BACKGROUND
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
(function(){
  const c = document.getElementById('canvas-bg');
  const ctx = c.getContext('2d');
  let W, H, pts = [];
  function resize(){ W = c.width = window.innerWidth; H = c.height = window.innerHeight; }
  window.addEventListener('resize', resize); resize();
  for(let i=0;i<60;i++) pts.push({ x:Math.random()*W, y:Math.random()*H, vx:(Math.random()-.5)*0.3, vy:(Math.random()-.5)*0.3, r:Math.random()*2+1 });
  function draw(){
    ctx.clearRect(0,0,W,H);
    pts.forEach(p=>{ p.x+=p.vx; p.y+=p.vy; if(p.x<0||p.x>W)p.vx*=-1; if(p.y<0||p.y>H)p.vy*=-1; ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fillStyle='rgba(79,142,247,0.4)'; ctx.fill(); });
    pts.forEach((a,i)=>{ pts.slice(i+1).forEach(b=>{ const d=Math.hypot(a.x-b.x,a.y-b.y); if(d<120){ ctx.beginPath(); ctx.moveTo(a.x,a.y); ctx.lineTo(b.x,b.y); ctx.strokeStyle=`rgba(79,142,247,${0.12*(1-d/120)})`; ctx.stroke(); }}); });
    requestAnimationFrame(draw);
  }
  draw();
})();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let state = JSON.parse(localStorage.getItem('secureup_state') || 'null') || {
  xp: 0, level: 1, streak: 0, lastDate: null,
  lessonsCompleted: [],
  domainMastery: {1:0,2:0,3:0,4:0,5:0},
  questionStats: { correct:0, total:0, byDomain:{1:{c:0,t:0},2:{c:0,t:0},3:{c:0,t:0},4:{c:0,t:0},5:{c:0,t:0}} },
  difficulty: 1, // 1=easy, 2=medium, 3=hard, 4=expert
  currentLesson: null,
  questionsSeen: []
};

function saveState(){localStorage.setItem('secureup_state',JSON.stringify(state));}
function addXP(n){ state.xp+=n; state.level=Math.floor(state.xp/200)+1; saveState(); updateHeader(); }
function updateHeader(){
  document.getElementById('xp-val').textContent=state.xp;
  document.getElementById('lvl-val').textContent=state.level;
  document.getElementById('streak-val').textContent=state.streak;
}
updateHeader();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DOMAIN DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const DOMAINS = [
  { id:1, pct:'12%', name:'General Security Concepts', color:'#4f8ef7', icon:'üîê',
    topics: [
      { id:'1.1', name:'Security Controls', lessons:['controls-intro','control-categories','control-types'] },
      { id:'1.2', name:'Fundamental Security Concepts', lessons:['cia-triad','aaa-model','zero-trust','physical-security','deception-tech'] },
      { id:'1.3', name:'Change Management & Security', lessons:['change-management'] },
      { id:'1.4', name:'Cryptographic Solutions', lessons:['crypto-pki','encryption-types','crypto-tools','hashing-certs'] },
    ]
  },
  { id:2, pct:'22%', name:'Threats, Vulnerabilities, and Mitigations', color:'#ff7b39', icon:'‚ö†Ô∏è',
    topics: [
      { id:'2.1', name:'Threat Actors & Motivations', lessons:['threat-actors'] },
      { id:'2.2', name:'Threat Vectors & Attack Surfaces', lessons:['threat-vectors','social-engineering'] },
      { id:'2.3', name:'Types of Vulnerabilities', lessons:['vuln-types','vuln-app-web'] },
      { id:'2.4', name:'Indicators of Malicious Activity', lessons:['malware','network-attacks','indicators'] },
      { id:'2.5', name:'Mitigation Techniques', lessons:['mitigation-basics','hardening'] },
    ]
  },
  { id:3, pct:'18%', name:'Security Architecture', color:'#22d06b', icon:'üèóÔ∏è',
    topics: [
      { id:'3.1', name:'Architecture Models', lessons:['arch-cloud','arch-network'] },
      { id:'3.2', name:'Securing Enterprise Infrastructure', lessons:['infra-security','firewall-types','secure-comms'] },
      { id:'3.3', name:'Data Protection Concepts', lessons:['data-types','data-security'] },
      { id:'3.4', name:'Resilience & Recovery', lessons:['ha-bcdr','backups-power'] },
    ]
  },
  { id:4, pct:'28%', name:'Security Operations', color:'#7c5cfc', icon:'‚öôÔ∏è',
    topics: [
      { id:'4.1', name:'Security Techniques', lessons:['baselines-hardening','mobile-wireless'] },
      { id:'4.2', name:'Asset Management', lessons:['asset-mgmt'] },
      { id:'4.3', name:'Vulnerability Management', lessons:['vuln-mgmt-process'] },
      { id:'4.4', name:'Alerting & Monitoring', lessons:['siem-monitoring'] },
      { id:'4.5', name:'Enhancing Security', lessons:['firewall-ids','email-security'] },
      { id:'4.6', name:'Identity & Access Management', lessons:['iam-basics','mfa-passwords'] },
      { id:'4.7', name:'Automation & Orchestration', lessons:['automation-soar'] },
      { id:'4.8', name:'Incident Response', lessons:['ir-process','digital-forensics'] },
      { id:'4.9', name:'Investigation Data Sources', lessons:['logs-data-sources'] },
    ]
  },
  { id:5, pct:'20%', name:'Security Program Management', color:'#00e5c5', icon:'üìã',
    topics: [
      { id:'5.1', name:'Security Governance', lessons:['governance-policies'] },
      { id:'5.2', name:'Risk Management', lessons:['risk-process','risk-quantitative'] },
      { id:'5.3', name:'Third-Party Risk', lessons:['vendor-risk'] },
      { id:'5.4', name:'Security Compliance', lessons:['compliance'] },
      { id:'5.5', name:'Audits & Assessments', lessons:['audits-pentest'] },
      { id:'5.6', name:'Security Awareness', lessons:['awareness-training'] },
    ]
  }
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// LESSON CONTENT LIBRARY
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const LESSONS = {

'cia-triad': {
  title: 'The CIA Triad: The Foundation of Security',
  subtitle: 'Understand the three pillars that every security decision is built on',
  domain: 1, domainName: '1.0 General Security Concepts',
  content: [
    { type:'analogy', label:'üè† Think of it like your house', text: 'Your house has a <strong>lock on the door</strong> (Confidentiality ‚Äî only you get in), the <strong>structure doesn\'t randomly collapse</strong> (Integrity ‚Äî things stay as they should be), and the <strong>lights turn on when you need them</strong> (Availability ‚Äî it works when you need it). Cybersecurity is just doing this for data and systems.' },
    { type:'section', title:'üîí Confidentiality', icon:'üîí', bg:'#4f8ef7',
      items:[
        { type:'definition', label:'What it means', text:'<strong>Only authorized people</strong> can access information. Think of it as "who gets to see this?"' },
        { type:'text', text:'Controls that enforce Confidentiality include: <strong>Encryption</strong> (scrambles data so only the right person can read it), <strong>Access Controls</strong> (permissions, role-based access), <strong>Data Classification</strong> (labeling data as Public, Restricted, Confidential), and <strong>Need-to-know</strong> (you only get access to what you actually need for your job).' },
        { type:'tip', label:'üéØ Exam Anchor', text:'If a question mentions preventing <strong>unauthorized disclosure</strong> of data, that\'s <strong>Confidentiality</strong>. Breaches like data leaks attack confidentiality.' }
      ]
    },
    { type:'section', title:'‚úÖ Integrity', icon:'‚úÖ', bg:'#22d06b',
      items:[
        { type:'definition', label:'What it means', text:'Data is <strong>accurate and unaltered</strong>. Think of it as "has anyone tampered with this?"' },
        { type:'text', text:'Controls that enforce Integrity include: <strong>Hashing</strong> (creates a digital fingerprint ‚Äî if the hash changes, data was modified), <strong>Digital Signatures</strong> (proves data came from who it says), <strong>Access Controls</strong> (limiting who can modify data), and <strong>Version Control</strong> (tracking changes).' },
        { type:'tip', label:'üéØ Exam Anchor', text:'If a question mentions <strong>unauthorized modification</strong>, detecting tampering, or ensuring data is accurate ‚Äî that\'s <strong>Integrity</strong>. A hash mismatch = integrity failure.' }
      ]
    },
    { type:'section', title:'üì° Availability', icon:'üì°', bg:'#00e5c5',
      items:[
        { type:'definition', label:'What it means', text:'Systems and data are <strong>accessible when needed</strong> by authorized users. Think of it as "is it working when I need it?"' },
        { type:'text', text:'Controls that enforce Availability include: <strong>Redundancy</strong> (backup systems), <strong>Load Balancing</strong> (spreading traffic so no single server is overwhelmed), <strong>Backups</strong> (copies of data), <strong>DDoS protection</strong>, and <strong>UPS/Generators</strong> (keeping power on).' },
        { type:'tip', label:'üéØ Exam Anchor', text:'A <strong>DDoS attack</strong> attacks Availability. <strong>Ransomware</strong> that locks files attacks Availability (and Confidentiality). If you can\'t access something ‚Äî that\'s an Availability problem.' }
      ]
    },
    { type:'terms', title:'Key Terms to Know Cold', terms:[
      { term:'Non-repudiation', def:'You can\'t deny you did something. Digital signatures prove WHO sent/signed data.' },
      { term:'CIA Triad', def:'Confidentiality + Integrity + Availability = the three pillars of security' },
      { term:'DDoS', def:'Distributed Denial of Service ‚Äî overwhelms a system attacking Availability' },
      { term:'Hashing', def:'One-way function producing a fixed fingerprint. Same input = same hash, always.' }
    ]},
  ],
  quiz: [
    { q:'A hacker intercepts data being sent over the network and reads private customer records. Which pillar of the CIA triad has been violated?', choices:['Integrity','Availability','Confidentiality','Non-repudiation'], answer:2, explain:'Reading private data without authorization is a <strong>Confidentiality</strong> violation. The data was disclosed to someone who shouldn\'t have it.' },
    { q:'An attacker floods a company\'s website with fake traffic, causing it to crash and become unreachable for real customers. Which CIA pillar is primarily affected?', choices:['Confidentiality','Integrity','Non-repudiation','Availability'], answer:3, explain:'A DDoS attack preventing access to a resource is an <strong>Availability</strong> attack. The system can\'t serve legitimate users.' },
    { q:'A junior admin accidentally changes a configuration file, corrupting the data inside. Which CIA pillar has been compromised?', choices:['Availability','Non-repudiation','Integrity','Confidentiality'], answer:2, explain:'Unauthorized (or accidental) modification of data violates <strong>Integrity</strong>. The data is no longer accurate and trustworthy.' },
  ]
},

'controls-intro': {
  title: 'Security Controls: Your Defense Toolkit',
  subtitle: 'Learn the categories and types of controls used to protect systems',
  domain: 1, domainName: '1.0 General Security Concepts',
  content: [
    { type:'analogy', label:'üè¶ Think of a bank', text: 'A bank uses <strong>cameras</strong> (Detective), <strong>armed guards</strong> (Deterrent + Corrective), a <strong>vault</strong> (Preventive), and a <strong>policy that says "don\'t give money without ID"</strong> (Managerial). That\'s exactly how security controls work in IT.' },
    { type:'section', title:'Control Categories (HOW they\'re implemented)', icon:'üìÇ', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Category','Description','Real Example'], rows:[
          ['Technical','Implemented by software/hardware','Firewall, encryption, antivirus, MFA'],
          ['Managerial','Policies and procedures','Password policy, risk assessment, change management'],
          ['Operational','Day-to-day processes by people','Security awareness training, guard patrols, background checks'],
          ['Physical','Physical barriers and protections','Locks, fences, bollards, security cameras'],
        ]}
      ]
    },
    { type:'section', title:'Control Types (WHAT they do)', icon:'üéØ', bg:'#7c5cfc',
      items:[
        { type:'table', headers:['Type','Purpose','Example'], rows:[
          ['Preventive','Stops the attack before it happens','Firewall blocks traffic, locked door'],
          ['Deterrent','Discourages attackers from trying','Warning sign, visible camera, CAPTCHA'],
          ['Detective','Finds attacks after/during they occur','IDS, security logs, camera footage review'],
          ['Corrective','Fixes damage after an incident','Antivirus quarantine, patching after exploit, restore from backup'],
          ['Compensating','Alternative when primary control isn\'t possible','Requiring manager approval instead of MFA for legacy system'],
          ['Directive','Tells people how to behave','Acceptable Use Policy (AUP), security awareness training'],
        ]}
      ]
    },
    { type:'tip', label:'üí° How to remember the types', text:'<strong>Pre-Detect-Cor-Comp-Dir</strong> ‚Äî Prevent bad things, Deter bad actors, Detect when they try, Correct the damage, Compensate for gaps, Direct with policy.' },
    { type:'terms', title:'Quick Wins', terms:[
      { term:'AUP', def:'Acceptable Use Policy ‚Äî a Directive control telling employees how to use company IT' },
      { term:'IDS', def:'Intrusion Detection System ‚Äî a Detective control that alerts on suspicious traffic' },
      { term:'Bollard', def:'Physical barrier (concrete post) preventing vehicles ‚Äî Preventive + Physical' },
      { term:'Honeyfile', def:'A fake file to attract attackers ‚Äî Detective control via deception' }
    ]},
  ],
  quiz: [
    { q:'A company places a sign at the entrance of its data center that says "Warning: This area is under 24/7 surveillance." What type and category of control is this?', choices:['Technical, Preventive','Physical, Deterrent','Operational, Detective','Managerial, Directive'], answer:1, explain:'A warning sign is a <strong>Physical</strong> control (it\'s a physical object) and <strong>Deterrent</strong> (it discourages attackers from attempting entry).' },
    { q:'After a ransomware infection, a security team restores systems from clean backups. What type of control are they using?', choices:['Preventive','Deterrent','Detective','Corrective'], answer:3, explain:'Restoring from backups after an incident is a <strong>Corrective</strong> control ‚Äî it fixes damage that already occurred.' },
    { q:'A company requires annual security awareness training for all employees. What category and type of control does this represent?', choices:['Technical, Preventive','Operational, Directive','Managerial, Detective','Physical, Compensating'], answer:1, explain:'Security awareness training is an <strong>Operational</strong> control (carried out by people) and <strong>Directive</strong> (it guides behavior/tells people what to do).' },
  ]
},

'aaa-model': {
  title: 'AAA: Authentication, Authorization & Accounting',
  subtitle: 'Three processes that control who gets in, what they can do, and what they did',
  domain: 1, domainName: '1.0 General Security Concepts',
  content: [
    { type:'analogy', label:'üé™ Think of a concert', text: '<strong>Authentication</strong> = showing your ticket (proving who you are). <strong>Authorization</strong> = your ticket says "General Admission" not "VIP" (determines what you can access). <strong>Accounting</strong> = the venue logs that you entered at 7:42 PM (record of what happened).' },
    { type:'section', title:'Authentication ‚Äî Proving Identity', icon:'ü™™', bg:'#4f8ef7',
      items:[
        { type:'definition', label:'The 3 Authentication Factors', text:'<strong>Something you know</strong> ‚Äî Password, PIN, security question. <strong>Something you have</strong> ‚Äî Smart card, hardware token, your phone (authenticator app). <strong>Something you are</strong> ‚Äî Biometrics: fingerprint, facial recognition, iris scan.' },
        { type:'text', text:'<strong>MFA (Multifactor Authentication)</strong> requires two or more DIFFERENT factor types. Password + fingerprint = MFA (know + are). Password + SMS code = MFA (know + have). Two passwords = NOT MFA (both are "know").' },
        { type:'text', text:'<strong>Authenticating Systems</strong>: Certificates and digital signatures prove a server/device is legitimate. When you visit a bank website, TLS certificates authenticate the server.' },
        { type:'tip', label:'üéØ Exam Trap', text:'MFA must use factors from <strong>different categories</strong>. Using two passwords is just 2FA, not MFA in the security sense.' }
      ]
    },
    { type:'section', title:'Authorization ‚Äî What Can You Do?', icon:'üîë', bg:'#22d06b',
      items:[
        { type:'text', text:'After authentication, authorization determines your <strong>permissions</strong>. Common models: <strong>Role-Based Access Control (RBAC)</strong> ‚Äî you get permissions based on your job role. <strong>Mandatory Access Control (MAC)</strong> ‚Äî the system enforces labels (used in military/government). <strong>Discretionary Access Control (DAC)</strong> ‚Äî the owner of a resource decides who gets access (like sharing a Google Doc).' },
        { type:'definition', label:'Least Privilege', text:'Users should only have the <strong>minimum permissions needed to do their job</strong>. Nothing more. This limits damage if an account is compromised.' }
      ]
    },
    { type:'section', title:'Accounting ‚Äî The Paper Trail', icon:'üìù', bg:'#ff7b39',
      items:[
        { type:'text', text:'Accounting (also called <strong>Auditing</strong>) tracks what authenticated, authorized users actually DO. Logs capture: who logged in, when, what files they accessed, what commands they ran.' },
        { type:'text', text:'This supports <strong>non-repudiation</strong> ‚Äî users can\'t claim they didn\'t do something if the logs prove they did.' },
        { type:'definition', label:'RADIUS', text:'Remote Authentication Dial-In User Service ‚Äî a common AAA protocol used for network access control (VPNs, Wi-Fi). Centralizes authentication so you don\'t have to manage credentials on every device.' }
      ]
    },
    { type:'terms', title:'Must-Know Terms', terms:[
      { term:'MFA', def:'Multifactor Authentication ‚Äî two+ different factor types' },
      { term:'RBAC', def:'Role-Based Access Control ‚Äî access based on job role' },
      { term:'Least Privilege', def:'Only the minimum permissions needed' },
      { term:'RADIUS', def:'AAA protocol for centralized network access control' },
      { term:'Non-repudiation', def:'Can\'t deny you did it ‚Äî logs prove actions' },
      { term:'Identity Proofing', def:'Verifying a user\'s real identity before giving them an account' }
    ]},
  ],
  quiz: [
    { q:'A user enters their username and password, then receives a code on their smartphone to complete login. Which factor categories are being used?', choices:['Something you know + Something you are','Something you have + Something you are','Something you know + Something you have','Two instances of something you know'], answer:2, explain:'Password = <strong>something you know</strong>. Smartphone code = <strong>something you have</strong>. This is true MFA because it uses two different factor categories.' },
    { q:'After a data breach investigation, security reviewers need to determine exactly which files an insider accessed last Tuesday. What AAA function provides this?', choices:['Authentication','Authorization','Accounting','Attestation'], answer:2, explain:'<strong>Accounting</strong> (auditing) tracks what users do after they\'ve been authenticated and authorized. Logs and audit trails provide this evidence.' },
    { q:'A database administrator\'s account is compromised. To limit the damage, the organization had previously ensured the DBA only had access to the databases they manage. This practice is called:', choices:['Separation of duties','Least privilege','Role-based access control','Need to know'], answer:1, explain:'<strong>Least privilege</strong> means users only have the minimum permissions required for their role. While RBAC is related, "least privilege" is the principle being described here.' },
  ]
},

'zero-trust': {
  title: 'Zero Trust Architecture',
  subtitle: 'Never trust, always verify ‚Äî the modern approach to network security',
  domain: 1, domainName: '1.0 General Security Concepts',
  content: [
    { type:'analogy', label:'üîí The old way vs. Zero Trust', text: '<strong>Old way:</strong> Inside the network = trusted. Outside = untrusted. Like a castle with a moat ‚Äî once you\'re through the drawbridge, you can go anywhere. <strong>Zero Trust:</strong> "I don\'t care if you\'re inside or outside. You need to prove yourself to access EVERYTHING, every time."' },
    { type:'section', title:'Why Zero Trust?', icon:'ü§î', bg:'#ff7b39',
      items:[
        { type:'text', text:'The traditional "perimeter" model breaks down because: employees work remotely (no longer always inside the network), cloud services mean data lives outside the perimeter, compromised insider accounts can roam freely on a trusted network.' },
        { type:'text', text:'Zero Trust assumes: <strong>the network is always hostile</strong>, external and internal threats always exist, and no user or device is trusted by default ‚Äî even inside the network.' }
      ]
    },
    { type:'section', title:'Zero Trust Components', icon:'üèóÔ∏è', bg:'#4f8ef7',
      items:[
        { type:'definition', label:'Control Plane', text:'The "brain" that makes and enforces decisions. Contains: <strong>Policy Engine</strong> (evaluates who/what is requesting access and makes the yes/no decision), <strong>Policy Administrator</strong> (executes the Policy Engine\'s decision ‚Äî enables/disables sessions), <strong>Policy Enforcement Point</strong> (the gateway that allows or blocks access).' },
        { type:'definition', label:'Data Plane', text:'Where actual traffic flows. The data plane is guarded by the Policy Enforcement Point. "Implicit trust zones" in older architectures are replaced by granular verification.' },
        { type:'table', headers:['Concept','What it does'], rows:[
          ['Adaptive Identity','Continuously verifies identity based on behavior, location, device health ‚Äî not just login'],
          ['Threat Scope Reduction','Limit what any one compromised account/device can reach'],
          ['Policy-Driven Access Control','Access decisions based on current risk context, not just group membership'],
        ]}
      ]
    },
    { type:'tip', label:'üéØ Key Zero Trust Principles', text:'<strong>1)</strong> Verify explicitly ‚Äî always authenticate and authorize. <strong>2)</strong> Use least privilege. <strong>3)</strong> Assume breach ‚Äî design as if attackers are already inside.' },
  ],
  quiz: [
    { q:'In a Zero Trust architecture, a remote employee connects to the corporate VPN from a coffee shop. According to Zero Trust principles, what should happen?', choices:['Trust the connection because the VPN is encrypted','Trust the connection because the employee authenticated to VPN','Continuously verify identity and device health regardless of VPN status','Grant full network access since they passed VPN authentication'], answer:2, explain:'Zero Trust requires <strong>continuous verification</strong>. Even authenticated VPN users must have their identity, device health, and access requests continuously evaluated ‚Äî "never trust, always verify."' },
    { q:'Which Zero Trust component is responsible for making the access decision (yes/no) when a user requests a resource?', choices:['Policy Enforcement Point','Policy Administrator','Policy Engine','Data Plane'], answer:2, explain:'The <strong>Policy Engine</strong> evaluates all signals (user identity, device health, location, risk level) and makes the grant/deny decision. The Policy Administrator then executes that decision.' },
  ]
},

'control-categories': {
  title: 'Security Control Categories',
  subtitle: 'Technical, Managerial, Operational, and Physical ‚Äî the four ways controls are implemented',
  domain: 1, domainName: '1.0 General Security Concepts',
  content: [
    { type:'analogy', label:'üè¢ Think of securing an office building', text:'A building uses <strong>keycards</strong> (Technical), <strong>a security policy document</strong> (Managerial), <strong>a guard doing rounds</strong> (Operational), and <strong>a locked steel door</strong> (Physical). Each category is a different layer of protection ‚Äî and the best security uses ALL of them.' },
    { type:'section', title:'The Four Control Categories', icon:'üìÇ', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Category','Who/What Implements It','Real-World Examples'], rows:[
          ['Technical (Logical)','Technology ‚Äî hardware and software systems','Firewalls, encryption, antivirus, MFA, IDS/IPS, access control lists'],
          ['Managerial (Administrative)','People in leadership ‚Äî policies and governance','Security policies, risk assessments, background checks, security audits'],
          ['Operational','Day-to-day human activities and processes','Security awareness training, guard patrols, incident response drills, change management'],
          ['Physical','Physical objects and barriers in the real world','Locks, fences, bollards, security cameras, badge readers, lighting, mantraps'],
        ]}
      ]
    },
    { type:'section', title:'Why Multiple Categories Matter ‚Äî Defense in Depth', icon:'üõ°Ô∏è', bg:'#22d06b',
      items:[
        { type:'definition', label:'Defense in Depth', text:'Using multiple layers of controls so that if one fails, others still protect the asset. An attacker who bypasses a firewall (Technical) still faces policies requiring MFA (Managerial + Technical), a guard checking badges (Operational + Physical), and a locked server room door (Physical).' },
        { type:'text', text:'Categories and Types are independent axes. A <strong>camera</strong> is Physical + Detective. A <strong>firewall rule</strong> is Technical + Preventive. A <strong>security policy</strong> is Managerial + Directive. You must be able to identify BOTH the category AND the type for any control on the exam.' },
      ]
    },
    { type:'tip', label:'üéØ Exam Strategy', text:'When a question describes a control, ask TWO questions: (1) <strong>HOW is it implemented?</strong> ‚Üí Category. (2) <strong>WHAT does it do?</strong> ‚Üí Type. A locked server room door = Physical (how) + Preventive (what it does ‚Äî stops unauthorized entry).' },
    { type:'terms', title:'Quick Reference', terms:[
      { term:'Technical Control', def:'Implemented by technology ‚Äî firewall, encryption, IDS, MFA, ACLs' },
      { term:'Managerial Control', def:'Implemented via policy and administration ‚Äî risk assessments, security policies' },
      { term:'Operational Control', def:'Implemented by people in day-to-day processes ‚Äî training, guard patrols' },
      { term:'Physical Control', def:'Real-world tangible barriers ‚Äî locks, fences, cameras, bollards' },
      { term:'Defense in Depth', def:'Layered security ‚Äî multiple controls so one failure doesn\'t equal total compromise' },
    ]},
  ],
  quiz: [
    { q:'An organization requires all employees to complete annual security awareness training covering phishing, password hygiene, and social engineering. What control category does this represent?', choices:['Technical','Managerial','Operational','Physical'], answer:2, explain:'Security awareness training is an <strong>Operational</strong> control ‚Äî it\'s implemented through human activities and processes (training programs), not technology, policy documents, or physical barriers.' },
    { q:'A company installs concrete bollards around the perimeter of its data center to prevent vehicles from ramming into the building. What control category is this?', choices:['Technical','Managerial','Operational','Physical'], answer:3, explain:'Bollards are physical objects in the real world ‚Äî this is a <strong>Physical</strong> control. They prevent unauthorized vehicle access to the building.' },
    { q:'A CISO develops a formal risk assessment process that requires all new IT projects to be evaluated for security risks before approval. This is BEST categorized as:', choices:['Technical, Preventive','Physical, Detective','Managerial, Preventive','Operational, Directive'], answer:2, explain:'A risk assessment process is a <strong>Managerial</strong> control (it\'s a governance/administrative process) and <strong>Preventive</strong> (it identifies risks before they become incidents, preventing problems from reaching production).' },
  ]
},

'control-types': {
  title: 'Security Control Types',
  subtitle: 'Preventive, Deterrent, Detective, Corrective, Compensating, and Directive ‚Äî what each control DOES',
  domain: 1, domainName: '1.0 General Security Concepts',
  content: [
    { type:'analogy', label:'üè¶ The bank robbery scenario', text:'A bank uses <strong>a sign saying "Smile, you\'re on camera"</strong> (Deterrent ‚Äî discourages robbers), a <strong>locked vault</strong> (Preventive ‚Äî stops the robbery), <strong>cameras recording everything</strong> (Detective ‚Äî catches it happening), <strong>silent alarm to police</strong> (Corrective ‚Äî responds to stop it), and <strong>a policy requiring two employees to open the vault</strong> (Directive ‚Äî tells staff how to behave). Six types, one bank.' },
    { type:'section', title:'All Six Control Types', icon:'üéØ', bg:'#7c5cfc',
      items:[
        { type:'table', headers:['Type','When It Acts','Goal','Memory Hook'], rows:[
          ['Preventive','BEFORE an attack','Stop the attack from happening at all','Lock on the door'],
          ['Deterrent','BEFORE an attack','Discourage attackers from trying','Warning sign ‚Äî no guarantee'],
          ['Detective','DURING or AFTER','Find that an attack is/was occurring','Camera recording'],
          ['Corrective','AFTER an attack','Fix damage, restore normal state','Restore from backup'],
          ['Compensating','INSTEAD OF primary','Alternative when primary control isn\'t available','Extra monitoring on unpatched system'],
          ['Directive','Anytime','Tell people what to do via policy/training','AUP, security training'],
        ]}
      ]
    },
    { type:'section', title:'Deep Dives on Common Exam Traps', icon:'‚ö†Ô∏è', bg:'#ff7b39',
      items:[
        { type:'definition', label:'Deterrent vs. Preventive ‚Äî The Key Difference', text:'A <strong>Deterrent</strong> doesn\'t actually stop anything ‚Äî it just makes the attacker think twice. A warning sign, a visible camera, a CAPTCHA. If a determined attacker ignores it, nothing happens. A <strong>Preventive</strong> control physically or technically BLOCKS the attack ‚Äî a locked door stops entry regardless of whether the attacker is deterred.' },
        { type:'definition', label:'Corrective ‚Äî Often Misidentified', text:'Corrective controls FIX things after an incident. Antivirus quarantine (removes malware after detection), restoring from backup (recovers data after ransomware), patching a system after exploitation. Key: the damage already happened ‚Äî corrective cleans it up.' },
        { type:'definition', label:'Compensating ‚Äî The Workaround Control', text:'When you can\'t implement the IDEAL control (usually because of a legacy system or budget), you use a compensating control. Example: A 20-year-old industrial system can\'t run antivirus ‚Äî so you isolate it on its own network segment, add extra monitoring, and require physical key access. Those are compensating controls.' },
      ]
    },
    { type:'tip', label:'üéØ Multi-Purpose Controls', text:'Controls can serve multiple types simultaneously. A firewall is both <strong>Preventive</strong> (blocks unauthorized traffic) and can be <strong>Detective</strong> (logs suspicious traffic). An IDS is <strong>Detective</strong>. An IPS is <strong>Preventive</strong> (it actually blocks). Know the PRIMARY function for exam purposes.' },
    { type:'terms', title:'Control Type Examples to Memorize', terms:[
      { term:'Preventive Examples', def:'Firewall, encryption, locked door, MFA, input validation, access control' },
      { term:'Deterrent Examples', def:'Warning signs, login banners ("Unauthorized access is prohibited"), visible cameras, CAPTCHA' },
      { term:'Detective Examples', def:'IDS, security logs, SIEM alerts, audit trails, security cameras (recording/reviewing)' },
      { term:'Corrective Examples', def:'Antivirus quarantine, patching after exploit, restoring from backup, incident response' },
      { term:'Compensating Examples', def:'Extra monitoring on unpatched legacy system, requiring manual approval for system without MFA' },
      { term:'Directive Examples', def:'AUP, security awareness training, posted policies, standard operating procedures' },
    ]},
  ],
  quiz: [
    { q:'An IDS alert fires, and a security analyst reviews the logs to determine that a port scan occurred against the company\'s web server 30 minutes ago. The IDS functions as what type of control?', choices:['Preventive','Deterrent','Detective','Corrective'], answer:2, explain:'An IDS (Intrusion Detection System) is a <strong>Detective</strong> control ‚Äî it identifies and alerts on suspicious activity. Unlike an IPS, it does NOT block anything. Finding the port scan after it happened is classic Detective control behavior.' },
    { q:'A login banner that displays "Warning: Unauthorized access to this system is prohibited and will be prosecuted" is BEST classified as what type of control?', choices:['Preventive','Deterrent','Detective','Directive'], answer:1, explain:'A warning banner is a <strong>Deterrent</strong> control. It does not technically prevent anyone from attempting access ‚Äî it warns and discourages. It psychologically deters attackers by communicating legal consequences.' },
    { q:'After a ransomware attack encrypts company files, the IT team restores data from offline backups and brings systems back online. The backup restoration is what type of control?', choices:['Preventive','Detective','Directive','Corrective'], answer:3, explain:'Restoring from backup after an incident is a <strong>Corrective</strong> control ‚Äî it addresses the damage AFTER an attack has occurred and restores normal operations. The incident already happened; corrective fixes the aftermath.' },
  ]
},

'physical-security': {
  title: 'Physical Security Controls',
  subtitle: 'Protecting the physical layer ‚Äî if someone can touch it, they can compromise it',
  domain: 1, domainName: '1.0 General Security Concepts',
  content: [
    { type:'analogy', label:'üè∞ Physical security = the castle walls', text:'All the cybersecurity in the world means nothing if an attacker can walk into your server room and pull the hard drive. Physical security is the FIRST line of defense ‚Äî it protects the hardware that everything else runs on. No amount of encryption protects a stolen, unencrypted drive.' },
    { type:'section', title:'Physical Barriers & Access Controls', icon:'üöß', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Control','What It Is','Control Type'], rows:[
          ['Bollards','Reinforced concrete/steel posts preventing vehicle ramming attacks','Physical + Preventive'],
          ['Fencing','Perimeter barrier controlling who can approach a facility','Physical + Preventive + Deterrent'],
          ['Access Control Vestibule (Mantrap)','A small room between two doors ‚Äî first door must close/lock before second opens. Prevents tailgating.','Physical + Preventive'],
          ['Access Badge/Card Reader','Electronic badge required to open doors ‚Äî logs who entered and when','Physical + Preventive + Detective'],
          ['Security Guard','Human security monitoring access points, responding to incidents','Operational + Physical + Deterrent + Preventive'],
          ['Lighting','Illuminating areas to deter criminal activity and support camera visibility','Physical + Deterrent'],
          ['Fencing','Perimeter barrier controlling access approach','Physical + Preventive + Deterrent'],
        ]}
      ]
    },
    { type:'section', title:'Video Surveillance', icon:'üìπ', bg:'#22d06b',
      items:[
        { type:'definition', label:'CCTV / Video Surveillance', text:'Cameras serve as both <strong>Deterrent</strong> (visible cameras discourage attacks) and <strong>Detective</strong> controls (recordings provide evidence of incidents). PTZ cameras (Pan-Tilt-Zoom) allow remote repositioning. Footage must be stored securely and retained appropriately.' },
        { type:'text', text:'Placement matters: cameras should cover all <strong>entry/exit points</strong>, server rooms, loading docks, and areas with sensitive equipment. Blind spots are a vulnerability.' },
      ]
    },
    { type:'section', title:'Sensors', icon:'üîç', bg:'#ff7b39',
      items:[
        { type:'table', headers:['Sensor Type','How It Works','Best Use Case'], rows:[
          ['Infrared','Detects heat signatures from people/animals moving through its field','Interior motion detection ‚Äî after-hours monitoring of hallways, server rooms'],
          ['Pressure','Detects weight/force on floor panels or mats','Specific high-security areas ‚Äî under server racks, in vaults'],
          ['Microwave','Emits microwave pulses and detects movement based on reflections','Large open areas ‚Äî warehouses, parking garages (works through walls)'],
          ['Ultrasonic','Emits high-frequency sound waves and detects disruptions','Small enclosed spaces ‚Äî detects motion in rooms, works well indoors'],
        ]}
      ]
    },
    { type:'section', title:'Tailgating & Piggybacking', icon:'üö∂', bg:'#ff4d6d',
      items:[
        { type:'definition', label:'Tailgating', text:'An unauthorized person follows an authorized person through a secured door without the authorized person\'s knowledge. The mantrap/access control vestibule is the primary technical control against this.' },
        { type:'definition', label:'Piggybacking', text:'Similar to tailgating, but the authorized person is AWARE and allows the unauthorized person through ‚Äî often out of politeness ("hold the door"). Security awareness training addresses this.' },
        { type:'tip', label:'üéØ Exam Tip', text:'The <strong>access control vestibule (mantrap)</strong> is the most-tested physical control for preventing tailgating. Know that it prevents multiple people from passing through with one badge scan.' },
      ]
    },
  ],
  quiz: [
    { q:'An attacker waits near a secured door of a data center and slips through behind an authorized employee who badges in, without the employee noticing. What physical security attack occurred?', choices:['Piggybacking','Tailgating','Shoulder surfing','Dumpster diving'], answer:1, explain:'<strong>Tailgating</strong> is when an unauthorized person follows an authorized person through a secured entrance WITHOUT their knowledge. The best countermeasure is an access control vestibule (mantrap), which requires each person to badge individually.' },
    { q:'A data center installs a small enclosed room between the parking lot entrance and the main facility. The outer door must fully close and lock before the inner door can open, and only one person can be in the room at a time. What is this called?', choices:['A security operations center','An access control vestibule (mantrap)','A screened subnet','A cold aisle containment system'], answer:1, explain:'This is an <strong>access control vestibule</strong> (also called a mantrap). It prevents tailgating by ensuring only one person passes through at a time, with each person individually authenticating.' },
    { q:'A company wants to prevent vehicles from being driven into the entrance of their headquarters as part of a physical attack. Which control would BEST address this?', choices:['Security cameras','Infrared sensors','Bollards','Access badges'], answer:2, explain:'<strong>Bollards</strong> are reinforced posts specifically designed to prevent vehicle ramming attacks. They physically block vehicles from reaching the building regardless of the driver\'s intent.' },
  ]
},

'deception-tech': {
  title: 'Deception & Disruption Technology',
  subtitle: 'Honeypots, honeynets, honeyfiles, and honeytokens ‚Äî using traps to catch attackers',
  domain: 1, domainName: '1.0 General Security Concepts',
  content: [
    { type:'analogy', label:'üçØ Setting a trap with honey', text:'Imagine a museum that places a fake priceless painting in a room wired with alarms. A thief who targets it triggers every alarm, revealing themselves ‚Äî while the real painting is safe elsewhere. Deception technology works the same way: fake assets that only an attacker would touch.' },
    { type:'section', title:'Deception Technologies', icon:'ü™§', bg:'#7c5cfc',
      items:[
        { type:'table', headers:['Technology','What It Is','What It Catches'], rows:[
          ['Honeypot','A decoy system designed to look like a real, valuable target. Not used by legitimate users.','Attackers probing/attacking systems ‚Äî any connection to a honeypot is suspicious by definition'],
          ['Honeynet','A network of honeypots that simulates an entire network environment (servers, workstations, etc.)','Advanced attackers ‚Äî gives them a fake environment to explore while security teams observe their TTPs'],
          ['Honeyfile','A fake file with an enticing name (like "passwords.xlsx" or "salary_data.csv") that triggers an alert when opened','Insider threats and attackers who have already gained access and are searching for sensitive data'],
          ['Honeytoken','A fake credential, API key, or piece of data embedded in real systems that will trigger an alert if used','Credential theft ‚Äî if this token is ever used, someone stole it from your system'],
        ]}
      ]
    },
    { type:'section', title:'Why Deception Tech Works', icon:'üß†', bg:'#4f8ef7',
      items:[
        { type:'definition', label:'High Signal, Low Noise', text:'Because legitimate users never interact with honeypots, ANY activity involving them is immediately suspicious. There are virtually no false positives ‚Äî only an attacker (or extremely lost legitimate user) would trigger these systems.' },
        { type:'definition', label:'Intelligence Gathering', text:'Honeynets let security teams observe attacker techniques, tools, and procedures (TTPs) in a controlled environment. You can watch exactly how attackers operate without risking real systems.' },
        { type:'text', text:'<strong>Practical placement:</strong> Honeypots should look real but be isolated from actual systems. A honeypot that\'s too obviously fake won\'t attract sophisticated attackers. One that connects to real systems is dangerous.' },
      ]
    },
    { type:'section', title:'Other Disruption Techniques', icon:'üîÄ', bg:'#ff7b39',
      items:[
        { type:'definition', label:'DNS Sinkholing', text:'Redirecting malicious domain requests to a controlled IP address. When malware tries to call home to a command-and-control server, DNS sinkholes intercept the request and send it to a dead end ‚Äî disrupting the malware\'s operation.' },
        { type:'definition', label:'Fake Telemetry', text:'Feeding false data to attackers who have compromised systems ‚Äî misleading them about your environment\'s actual layout while you detect and respond.' },
      ]
    },
    { type:'tip', label:'üéØ Exam Focus', text:'Know which "honey" tech does what: <strong>Honeypot = fake system</strong>, <strong>Honeynet = fake network</strong>, <strong>Honeyfile = fake file</strong>, <strong>Honeytoken = fake credential/data</strong>. All are Detective controls. They don\'t prevent attacks ‚Äî they detect attackers who have already gotten in.' },
  ],
  quiz: [
    { q:'A security team embeds a fake AWS access key into their code repository and configures an alert to fire if that key is ever used to make API calls. What type of deception technology is this?', choices:['Honeypot','Honeynet','Honeyfile','Honeytoken'], answer:3, explain:'A <strong>honeytoken</strong> is a fake piece of data (credential, API key, or other token) embedded in real systems. If it\'s ever used, it proves someone stole it ‚Äî triggering an alert with almost zero false positives.' },
    { q:'A security engineer sets up a server that appears to run outdated, vulnerable software and is listed in the internal network\'s DNS as "payroll-server-backup." The server has no legitimate users. What is the purpose of this system?', choices:['Load balancing production traffic','Providing a backup for payroll data','Acting as a honeypot to attract and detect attackers','Creating a warm standby for disaster recovery'], answer:2, explain:'This is a <strong>honeypot</strong> ‚Äî a decoy system designed to look like a valuable target. Since no legitimate users connect to it, any activity is suspicious. The enticing name ("payroll-server-backup") makes it attractive to attackers searching the network.' },
    { q:'Which deception technology would BEST help a security team understand the tools, techniques, and procedures (TTPs) used by advanced attackers over an extended period?', choices:['Honeytoken','Honeyfile','Honeypot','Honeynet'], answer:3, explain:'A <strong>honeynet</strong> ‚Äî a network of multiple honeypots simulating a full environment ‚Äî gives attackers an entire fake infrastructure to explore. Security teams can observe sophisticated, multi-stage attacks in full, learning the attacker\'s TTPs without risking real systems.' },
  ]
},

'change-management': {
  title: 'Change Management & Security',
  subtitle: 'Why how you change things matters as much as what you change ‚Äî 1.3',
  domain: 1, domainName: '1.0 General Security Concepts',
  content: [
    { type:'analogy', label:'‚úàÔ∏è Airlines don\'t just change planes mid-flight', text:'Every change to an aircraft goes through approval, testing, documentation, and rollback plans. IT change management works the same way ‚Äî uncontrolled changes are one of the top causes of security incidents and outages. "Just push the update" has caused countless breaches.' },
    { type:'section', title:'Change Management Business Processes', icon:'üìã', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Process Element','What It Means','Why It Matters for Security'], rows:[
          ['Approval Process','Changes must be reviewed and approved by appropriate stakeholders before implementation','Prevents unauthorized changes that could introduce vulnerabilities or disable security controls'],
          ['Ownership','Every system/asset has a defined owner responsible for it','Ensures accountability ‚Äî someone is responsible for security of each asset'],
          ['Stakeholders','All parties affected by a change are identified and consulted','Security team must be a stakeholder for any IT change'],
          ['Impact Analysis','Assessment of what the change affects (dependencies, security implications)','Identifies security risks BEFORE the change goes live'],
          ['Test Results','Changes are tested in a non-production environment first','Catches security problems before they hit production'],
          ['Backout Plan','Step-by-step procedure to reverse the change if something goes wrong','Critical if a change introduces a vulnerability or breaks security controls'],
          ['Maintenance Window','Scheduled time period when changes are implemented','Limits exposure ‚Äî changes happen in controlled, monitored periods'],
          ['Standard Operating Procedure','Documented steps for performing routine changes','Ensures consistency; prevents security steps from being skipped'],
        ]}
      ]
    },
    { type:'section', title:'Technical Implications of Changes', icon:'‚öôÔ∏è', bg:'#ff7b39',
      items:[
        { type:'definition', label:'Allow Lists / Deny Lists', text:'Changes may require updating allow lists (what\'s permitted) or deny lists (what\'s blocked) in firewalls, email filters, and application controls. Adding a new application? Update the allow list. Blocking a new malware domain? Update the deny list.' },
        { type:'definition', label:'Restricted Activities During Changes', text:'Certain actions are restricted during maintenance windows or change periods ‚Äî no unrelated changes, strict access control, enhanced monitoring.' },
        { type:'table', headers:['Technical Consideration','Security Implication'], rows:[
          ['Downtime','Systems offline = potential availability incident; plan communications'],
          ['Service/Application Restart','May reset security configurations; verify after restart'],
          ['Legacy Applications','May not support modern security controls; changes carry extra risk'],
          ['Dependencies','Changing one system may break security controls on dependent systems'],
        ]}
      ]
    },
    { type:'section', title:'Documentation Requirements', icon:'üìù', bg:'#22d06b',
      items:[
        { type:'definition', label:'Updating Diagrams', text:'Network diagrams, data flow diagrams, and architecture documents must be updated when changes occur. Outdated diagrams are a security risk ‚Äî incident responders may make wrong decisions based on inaccurate maps.' },
        { type:'definition', label:'Version Control', text:'All configuration files, scripts, and code should be version controlled. This enables rollback, provides audit trail, and shows exactly what changed and when. Git is the most common tool.' },
        { type:'tip', label:'üéØ Exam Insight', text:'The exam loves questions about <strong>what happens when change management is skipped</strong>. Answer: unauthorized changes, security controls disabled by accident, no rollback path, undetected vulnerabilities introduced. Change management IS a security control.' },
      ]
    },
  ],
  quiz: [
    { q:'A developer pushes an emergency patch to a production web server without going through the change management process, causing the web application firewall rules to be reset to default ‚Äî exposing the application to SQL injection. What change management element would have MOST likely prevented this?', choices:['Maintenance window scheduling','Impact analysis and approval process','Version control of the WAF config','Stakeholder notification'], answer:1, explain:'An <strong>impact analysis and approval process</strong> would have required the developer to evaluate what the patch affected (including WAF rules) and get approval from security stakeholders before implementation. This is exactly why bypassing change management is dangerous.' },
    { q:'After deploying a change that breaks a critical business application, the IT team needs to reverse all changes made during the deployment to restore normal operation. What change management element enables this?', choices:['Maintenance window','Backout plan','Impact analysis','Version control'], answer:1, explain:'A <strong>backout plan</strong> (also called rollback plan) is a pre-documented procedure for reversing a change if it causes problems. Every significant change should have one prepared BEFORE implementation.' },
    { q:'A company maintains detailed records of all changes to its firewall configurations, with each change recorded as a new entry showing what changed, when, by whom, and why. This practice is BEST described as:', choices:['Change approval process','Backout planning','Version control','Impact analysis'], answer:2, explain:'<strong>Version control</strong> tracks the history of changes to files and configurations, showing what changed, who changed it, and when. This provides an audit trail, enables rollback, and is a fundamental security and change management practice.' },
  ]
},

'encryption-types': {
  title: 'Encryption Levels and Types',
  subtitle: 'Full-disk, file, database, symmetric, asymmetric ‚Äî knowing when to use each',
  domain: 1, domainName: '1.0 General Security Concepts',
  content: [
    { type:'analogy', label:'üîí Encryption is like a safe ‚Äî but which kind?', text:'You wouldn\'t store your passport in the same safe as your grocery list. Different data needs different protection. A fireproof safe for documents at rest, a locked briefcase for documents in transit, a lockbox at the bank (HSM) for the most critical things. Encryption has the same tiers.' },
    { type:'section', title:'Encryption by Level (What Gets Encrypted)', icon:'üìä', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Level','What It Encrypts','Key Tool/Example','Best For'], rows:[
          ['Full-Disk (FDE)','The entire storage drive ‚Äî everything on it','BitLocker (Windows), FileVault (Mac), uses TPM','Laptops ‚Äî if stolen, drive is unreadable without key'],
          ['Partition','A specific partition/section of a disk','BitLocker on specific volumes','Separating sensitive data on a multi-use drive'],
          ['File','Individual files only','VeraCrypt, EFS (Encrypted File System)','Specific sensitive files when full-disk isn\'t possible'],
          ['Volume','A logical volume (like an encrypted container file)','VeraCrypt volumes, encrypted DMG on Mac','Portable encrypted containers; can be moved between systems'],
          ['Database','Entire database or specific columns/records','Transparent Data Encryption (TDE), column-level encryption','Protecting customer PII, credit cards in databases'],
          ['Record','Individual records or fields within a database','Column-level encryption, application-layer encryption','HIPAA-protected fields; credit card numbers; SSNs'],
        ]}
      ]
    },
    { type:'section', title:'Encryption for Data in Transit', icon:'üîÑ', bg:'#22d06b',
      items:[
        { type:'definition', label:'Transport/Communication Encryption', text:'Encrypts data WHILE IT\'S MOVING between systems. <strong>TLS (Transport Layer Security)</strong> is the primary protocol ‚Äî used for HTTPS, email (SMTP/S), and most network communication. <strong>IPSec</strong> encrypts at the network layer (used in VPNs). <strong>SSH</strong> encrypts terminal/admin sessions.' },
        { type:'tip', label:'üéØ Data States on the Exam', text:'<strong>Data at rest</strong> = stored on disk ‚Üí use FDE, database encryption, file encryption. <strong>Data in transit</strong> = moving across a network ‚Üí use TLS, IPSec, HTTPS. <strong>Data in use</strong> = actively being processed in RAM ‚Üí hardest to protect; secure enclaves help.' }
      ]
    },
    { type:'section', title:'Algorithm Strength', icon:'üî¢', bg:'#7c5cfc',
      items:[
        { type:'table', headers:['Algorithm','Type','Status','Key Length'], rows:[
          ['AES (Advanced Encryption Standard)','Symmetric','Current gold standard','128, 192, or 256-bit'],
          ['RSA','Asymmetric','Widely used for key exchange and signatures','2048-bit minimum (4096 preferred)'],
          ['ECC (Elliptic Curve Cryptography)','Asymmetric','Modern, efficient ‚Äî same security as RSA with smaller keys','256-bit ECC ‚âà 3072-bit RSA'],
          ['DES / 3DES','Symmetric','Deprecated ‚Äî too weak','56-bit (DES), 112/168-bit (3DES)'],
          ['RC4','Symmetric','Deprecated ‚Äî broken','40-128 bit'],
        ]}
      ]
    },
    { type:'definition', label:'Key Length ‚Äî Why It Matters', text:'Longer keys = more possible combinations = harder to brute force. A 128-bit key has 2^128 possible combinations. Doubling key length doesn\'t double security ‚Äî it squares it. AES-256 is considered quantum-resistant for the foreseeable future.' },
  ],
  quiz: [
    { q:'A company deploys laptops to field sales employees who travel frequently. The security team is concerned that a stolen laptop could expose customer data. Which encryption level would BEST protect ALL data on the laptop if it\'s stolen?', choices:['File-level encryption on sensitive folders','Database encryption for the CRM application','Full-disk encryption (FDE)','Volume encryption on the user profile folder'], answer:2, explain:'<strong>Full-disk encryption (FDE)</strong> encrypts the entire drive ‚Äî the OS, all applications, all data files. If the laptop is stolen, the drive cannot be read without the encryption key/password, even if removed and placed in another computer.' },
    { q:'A web application stores customer credit card numbers in a database. For PCI DSS compliance, the credit card numbers must be encrypted at rest. The rest of the customer record (name, address) does not require encryption. What encryption approach should be used?', choices:['Full-disk encryption on the database server','Record-level or column-level encryption on the credit card field','Volume encryption of the database files','Transport Layer Security (TLS) for database connections'], answer:1, explain:'<strong>Column-level (record-level) encryption</strong> encrypts only specific fields ‚Äî like the credit card number column ‚Äî leaving other fields readable for normal application function. This is the right-sized solution for PCI DSS compliance without encrypting more than necessary.' },
    { q:'Which algorithm should a security architect choose to provide the strongest encryption for sensitive data at rest in 2024?', choices:['DES','RC4','AES-256','3DES'], answer:2, explain:'<strong>AES-256</strong> is the current industry standard for symmetric encryption. DES (56-bit) and RC4 are deprecated and broken. 3DES is being phased out. AES-256 is used by governments, militaries, and enterprises worldwide for the most sensitive data.' },
  ]
},

'crypto-tools': {
  title: 'Cryptographic Tools',
  subtitle: 'TPM, HSM, key management systems, and secure enclaves ‚Äî the hardware that protects your keys',
  domain: 1, domainName: '1.0 General Security Concepts',
  content: [
    { type:'analogy', label:'üîë The key to encryption is... the key', text:'Even AES-256 encryption is worthless if the encryption key is stored in a text file next to the encrypted data. Cryptographic tools are specialized hardware and software designed to protect keys ‚Äî they\'re the lockboxes for your lockboxes.' },
    { type:'section', title:'Hardware Cryptographic Tools', icon:'üíæ', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Tool','What It Is','Primary Use','Where You\'ll Find It'], rows:[
          ['TPM (Trusted Platform Module)','A dedicated microchip soldered to the motherboard that stores cryptographic keys and performs crypto operations','Full-disk encryption key storage (BitLocker), platform integrity verification, secure boot','Built into most modern laptops and desktops (check Device Manager)'],
          ['HSM (Hardware Security Module)','A dedicated external hardware device for high-assurance cryptographic operations. Much more powerful than TPM.','Certificate Authority private key protection, payment card processing, enterprise key management','Data centers, banks, Certificate Authorities ‚Äî expensive specialized hardware'],
          ['Secure Enclave','A isolated, secure processor within a main CPU that handles sensitive operations separately from the main OS','Biometric data processing (Face ID, fingerprint), secure key storage on mobile devices','Apple A-series chips, Intel SGX, ARM TrustZone'],
        ]}
      ]
    },
    { type:'section', title:'Key Management', icon:'üóùÔ∏è', bg:'#22d06b',
      items:[
        { type:'definition', label:'Key Management System (KMS)', text:'Software that manages the entire lifecycle of cryptographic keys: generation, distribution, storage, rotation, and destruction. Cloud providers offer KMS services (AWS KMS, Azure Key Vault). The principle: never store keys alongside encrypted data.' },
        { type:'definition', label:'Key Escrow', text:'A copy of encryption keys is held by a trusted third party. Allows recovery if keys are lost, and may be required for law enforcement access. Controversial ‚Äî some argue it creates a backdoor. Used in enterprise environments where data recovery is critical.' },
        { type:'tip', label:'üéØ TPM vs. HSM ‚Äî Know the Difference', text:'<strong>TPM</strong> = chip on your motherboard, consumer/enterprise laptops, used for BitLocker and secure boot. Relatively limited. <strong>HSM</strong> = dedicated external hardware appliance, used by Certificate Authorities and banks, extremely high-assurance. TPM is built-in and basic; HSM is dedicated and enterprise-grade.' }
      ]
    },
    { type:'section', title:'Obfuscation Techniques', icon:'üå´Ô∏è', bg:'#7c5cfc',
      items:[
        { type:'table', headers:['Technique','What It Does','Common Use'], rows:[
          ['Steganography','Hides data inside other data ‚Äî embedding a secret message inside an image file. The image looks normal.','Covert communication; watermarking; malware command delivery hidden in images'],
          ['Tokenization','Replaces sensitive data with a non-sensitive placeholder (token). The token has no mathematical relationship to the original.','Credit card processing ‚Äî merchants store tokens, not actual card numbers (PCI DSS)'],
          ['Data Masking','Replaces real data with realistic but fake data for non-production environments','Giving developers realistic test data without exposing real customer SSNs/credit cards'],
        ]}
      ]
    },
  ],
  quiz: [
    { q:'A company\'s Certificate Authority uses a dedicated hardware appliance to store its private root key, ensuring the key can never be extracted by software or an OS-level compromise. What technology is being used?', choices:['TPM','Secure Enclave','HSM (Hardware Security Module)','Key Management System'], answer:2, explain:'An <strong>HSM (Hardware Security Module)</strong> is specifically designed for high-assurance key protection in enterprise/CA environments. Private keys stored in an HSM cannot be extracted ‚Äî all crypto operations happen inside the hardware.' },
    { q:'A retailer processes credit cards but wants to minimize its PCI DSS scope by never storing actual card numbers in its systems. Instead, their payment processor returns a random string that the retailer stores and uses for future reference. What technique is this?', choices:['Encryption','Tokenization','Data masking','Steganography'], answer:1, explain:'<strong>Tokenization</strong> replaces sensitive data (the real credit card number) with a non-sensitive token (random string). The token has no mathematical relationship to the card number, so if stolen it\'s worthless. This is the foundation of payment security systems like Apple Pay.' },
    { q:'A security analyst discovers an image file being exfiltrated from the network. Closer examination reveals that a secret text document is embedded invisibly within the image\'s pixel data. What technique was used?', choices:['Encryption','Tokenization','Steganography','Data masking'], answer:2, explain:'<strong>Steganography</strong> hides data within other data ‚Äî in this case, hiding a document inside an image. Unlike encryption (which makes data unreadable but obvious it exists), steganography hides the very EXISTENCE of the secret data.' },
  ]
},

'hashing-certs': {
  title: 'Hashing, Salting & Digital Certificates',
  subtitle: 'Proving data integrity and identity ‚Äî the building blocks of trust on the internet',
  domain: 1, domainName: '1.0 General Security Concepts',
  content: [
    { type:'analogy', label:'üñäÔ∏è Hashing is like a fingerprint for data', text:'Every human has a unique fingerprint. Every piece of data has a unique hash. If even ONE character in a file changes, the hash completely changes ‚Äî like if a fingerprint suddenly had a different pattern. Hashes don\'t tell you what the data IS, just whether it\'s changed.' },
    { type:'section', title:'Hashing Deep Dive', icon:'#Ô∏è‚É£', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Hash Algorithm','Output Length','Status','Use Today'], rows:[
          ['MD5','128-bit (32 hex chars)','Broken ‚Äî collision attacks possible','File checksums only (not security); NEVER passwords'],
          ['SHA-1','160-bit','Deprecated ‚Äî weak','Being phased out; avoid for new implementations'],
          ['SHA-256 (SHA-2)','256-bit','Current standard','Certificates, file integrity, password hashing (with salt)'],
          ['SHA-3','256/512-bit','Modern alternative to SHA-2','High-security applications; different internal design than SHA-2'],
          ['bcrypt/scrypt/Argon2','Variable','Purpose-built for passwords','Password storage ‚Äî deliberately SLOW to resist brute force'],
        ]},
        { type:'definition', label:'Collision Attack', text:'When two different inputs produce the same hash output. This breaks the uniqueness property of hashing. MD5 and SHA-1 are vulnerable to collision attacks ‚Äî that\'s why they\'re deprecated for security use.' },
      ]
    },
    { type:'section', title:'Salting & Key Stretching', icon:'üßÇ', bg:'#22d06b',
      items:[
        { type:'definition', label:'Salting', text:'A random value (salt) is added to a password BEFORE hashing. Each user gets a unique salt, stored alongside their hash. This means: (1) same password ‚Üí different hash for each user, (2) rainbow tables are useless because they\'d need a table for every possible salt.' },
        { type:'definition', label:'Key Stretching', text:'Running a password through a hashing function thousands or millions of times, making it computationally expensive to crack. Algorithms like <strong>bcrypt, PBKDF2, and Argon2</strong> are designed specifically for this. A function that takes 100ms to compute requires 100ms per guess ‚Äî making brute force infeasible.' },
        { type:'tip', label:'üéØ Password Storage Best Practice', text:'Correct password storage = <strong>bcrypt/Argon2 + unique per-user salt</strong>. NEVER store plaintext passwords. NEVER use unsalted MD5 or SHA-1 for passwords. If a site emails you your password, they stored it in plaintext ‚Äî that\'s a red flag.' }
      ]
    },
    { type:'section', title:'Digital Certificates ‚Äî The Full Picture', icon:'üìú', bg:'#7c5cfc',
      items:[
        { type:'definition', label:'What a Certificate Contains', text:'1) <strong>Subject</strong>: Who the cert belongs to (domain name, organization). 2) <strong>Public Key</strong>: The subject\'s public key. 3) <strong>Issuer</strong>: The CA that signed it. 4) <strong>Validity Period</strong>: Start and expiration dates. 5) <strong>CA\'s Digital Signature</strong>: Proves the CA verified the subject\'s identity.' },
        { type:'table', headers:['Certificate Type','Description','When Used'], rows:[
          ['Domain Validated (DV)','Only proves ownership of the domain. Quick and cheap.','Personal sites, blogs, basic HTTPS'],
          ['Organization Validated (OV)','Verifies the organization\'s identity. More trust.','Business websites'],
          ['Extended Validation (EV)','Most rigorous ‚Äî thorough vetting of the organization','Banking, e-commerce, high-trust sites'],
          ['Wildcard','Valid for *.domain.com ‚Äî covers all subdomains','When you have many subdomains (mail.example.com, app.example.com)'],
          ['Self-Signed','Signed by itself, not a CA. Browsers will warn users.','Internal systems, development environments'],
        ]},
        { type:'definition', label:'Certificate Revocation', text:'When a certificate must be invalidated before expiration (key compromise, employee departure). Two methods: <strong>CRL (Certificate Revocation List)</strong> ‚Äî a downloadable list of revoked certs (can be stale). <strong>OCSP (Online Certificate Status Protocol)</strong> ‚Äî real-time query to check if a cert is revoked (faster, more current).' }
      ]
    },
  ],
  quiz: [
    { q:'A security team downloads a software patch from a vendor\'s website. The vendor provides an MD5 hash of the file. After downloading, the team computes the hash of the downloaded file and it matches. However, a senior analyst says this is insufficient for security purposes. Why?', choices:['MD5 hashes are too short to be secure','MD5 is vulnerable to collision attacks, meaning a malicious file could produce the same hash','The team should use SHA-3 instead of SHA-256','MD5 cannot be computed on large files'], answer:1, explain:'<strong>MD5 is broken</strong> ‚Äî it\'s vulnerable to collision attacks, meaning an attacker could craft a malicious file that produces the same MD5 hash as the legitimate file. For security integrity checking, use SHA-256 or SHA-3.' },
    { q:'Two users have the same password ("Password123!"). After a database breach, an attacker notices their password hashes are completely different. What security measure caused this?', choices:['Key stretching','Key escrow','Salting','Tokenization'], answer:2, explain:'<strong>Salting</strong> adds a unique random value to each password before hashing. Even identical passwords produce completely different hashes because each user has a unique salt. This defeats rainbow table attacks and makes per-user cracking much harder.' },
    { q:'A company\'s certificate authority private key is compromised. The company immediately needs to notify relying parties that all certificates issued by this CA should no longer be trusted. What mechanism allows them to do this in real-time?', choices:['Certificate Signing Request (CSR)','Certificate Revocation List (CRL)','Online Certificate Status Protocol (OCSP)','Root of Trust update'], answer:2, explain:'<strong>OCSP (Online Certificate Status Protocol)</strong> allows real-time certificate status checking. While CRLs work, they can be stale (only updated periodically). OCSP provides immediate revocation status, which is critical when a CA key is compromised.' },
  ]
},

'threat-vectors': {
  title: 'Threat Vectors & Attack Surfaces',
  subtitle: 'Every path an attacker can use to reach your systems ‚Äî 2.2',
  domain: 2, domainName: '2.0 Threats, Vulnerabilities, and Mitigations',
  content: [
    { type:'analogy', label:'üè† Think of your house\'s attack surface', text:'Every window, door, doggy door, and chimney is a potential entry point. The more entry points, the bigger your attack surface. Reducing attack surface means closing, removing, or securing every unnecessary way in.' },
    { type:'section', title:'Message-Based Vectors', icon:'‚úâÔ∏è', bg:'#ff7b39',
      items:[
        { type:'table', headers:['Vector','Description','Example Attack'], rows:[
          ['Email','Most common attack vector ‚Äî phishing, malicious attachments, malicious links','Fake invoice email with macro-enabled Excel attachment'],
          ['SMS (Smishing)','Text messages with malicious links or urgent fake alerts','"Your bank account is locked ‚Äî click here to verify"'],
          ['Instant Messaging','Slack, Teams, Discord used to deliver malware or phishing links','Attacker joins Slack workspace, sends malicious file in DM'],
        ]}
      ]
    },
    { type:'section', title:'Network & System Vectors', icon:'üåê', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Vector','Why It\'s Dangerous'], rows:[
          ['Open Service Ports','Every open port is a potential entry point ‚Äî only open what\'s necessary'],
          ['Default Credentials','Devices shipped with "admin/admin" ‚Äî attackers scan for these constantly'],
          ['Unsupported Systems','OS past end-of-life gets no more patches ‚Äî forever vulnerable to new exploits'],
          ['Vulnerable Software','Unpatched applications with known CVEs ‚Äî often the easiest way in'],
          ['Removable Media','USB drives carry malware, bypass network controls entirely (Stuxnet used this)'],
          ['Unsecured Wireless','Open/WEP Wi-Fi allows eavesdropping and injection attacks'],
          ['Bluetooth','Short-range but real ‚Äî bluejacking, bluesnarfing, blueborne attacks'],
        ]}
      ]
    },
    { type:'section', title:'Supply Chain Vectors', icon:'‚õìÔ∏è', bg:'#22d06b',
      items:[
        { type:'definition', label:'Supply Chain Attack', text:'Instead of attacking you directly, attackers compromise a vendor, supplier, or MSP who has access to YOUR systems. The SolarWinds attack (2020) is the landmark example ‚Äî attackers compromised SolarWinds\'s build process, pushing malicious updates to 18,000+ organizations including US government agencies.' },
        { type:'table', headers:['Supply Chain Target','Attack Method'], rows:[
          ['Managed Service Provider (MSP)','Compromise the MSP to gain access to all their clients at once'],
          ['Software Vendor','Inject malware into a legitimate software update (SolarWinds, CCleaner)'],
          ['Hardware Supplier','Implant hardware backdoors during manufacturing'],
        ]}
      ]
    },
    { type:'tip', label:'üéØ Attack Surface Reduction', text:'The exam loves this concept: <strong>disable unused ports/services</strong>, remove unnecessary software, change default credentials, segment networks, keep software patched. Every unnecessary feature is a potential attack vector.' },
  ],
  quiz: [
    { q:'A company discovers an attacker gained access by compromising a third-party IT management firm that had remote access to their systems. What type of attack vector was used?', choices:['Phishing','Supply chain / MSP compromise','Removable media','Open service port'], answer:1, explain:'This is a <strong>supply chain attack via an MSP</strong>. Instead of attacking the company directly, the attacker compromised a trusted third party. MSPs are high-value targets because compromising one provides access to all their clients simultaneously.' },
    { q:'A security audit reveals a network printer using the manufacturer\'s default username "admin" and password "admin." What threat vector does this represent?', choices:['Unsupported system','Vulnerable software','Default credentials','Open service port'], answer:2, explain:'<strong>Default credentials</strong> are a major threat vector ‚Äî attackers actively scan for devices using factory-default usernames and passwords. Changing default credentials is one of the most basic hardening steps and should be done immediately on any new device.' },
    { q:'An attacker drops USB drives labeled "Q3 Salary Review - Confidential" in a company parking lot, hoping employees will plug them in. What threat vector is being exploited?', choices:['Email phishing','Supply chain','Removable media','Bluetooth'], answer:2, explain:'This is a <strong>removable media</strong> attack ‚Äî physical USB drives used to deliver malware. The social engineering element (enticing label) makes employees curious enough to plug them in. This technique bypasses all network-based security controls entirely.' },
  ]
},

'vuln-types': {
  title: 'Types of Vulnerabilities',
  subtitle: 'Application, OS, hardware, cloud, mobile ‚Äî every weakness category for 2.3',
  domain: 2, domainName: '2.0 Threats, Vulnerabilities, and Mitigations',
  content: [
    { type:'analogy', label:'üß± A vulnerability is a crack in the wall', text:'It doesn\'t mean the wall falls down ‚Äî it means there\'s a weakness an attacker could exploit. Different walls have different cracks. Software has memory bugs. Hardware has firmware flaws. The cloud has misconfiguration problems. Know each type cold for the exam.' },
    { type:'section', title:'Application Vulnerabilities', icon:'üíª', bg:'#ff4d6d',
      items:[
        { type:'table', headers:['Vulnerability','What It Is','Impact'], rows:[
          ['Buffer Overflow','Writing more data into a memory buffer than it can hold, overflowing into adjacent memory','Code execution, privilege escalation, crashes'],
          ['Memory Injection','Injecting malicious code directly into a running process\'s memory space','Bypasses disk-based antivirus; hard to detect'],
          ['Race Condition (TOC/TOU)','Time-of-Check to Time-of-Use: a condition changes between when it\'s checked and when it\'s used','Privilege escalation; authentication bypass'],
          ['Malicious Update','A legitimate software update process is hijacked to deliver malware','Bypasses security because the update is "trusted"'],
        ]}
      ]
    },
    { type:'section', title:'Hardware & System Vulnerabilities', icon:'üîß', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Type','Description'], rows:[
          ['Firmware Vulnerability','Bugs in low-level hardware software (BIOS/UEFI, router firmware) ‚Äî often persist through OS reinstalls'],
          ['End-of-Life (EOL)','Hardware/software no longer supported ‚Äî no more patches, forever vulnerable to newly discovered exploits'],
          ['Legacy Systems','Older systems running outdated OS/software that cannot be updated ‚Äî common in healthcare, manufacturing'],
          ['VM Escape','Attacker breaks out of a virtual machine to access the hypervisor or other VMs on the same host'],
          ['Resource Reuse','VM/container resources not properly cleared between uses ‚Äî previous tenant\'s data may leak'],
        ]}
      ]
    },
    { type:'section', title:'Cloud & Mobile Vulnerabilities', icon:'‚òÅÔ∏è', bg:'#7c5cfc',
      items:[
        { type:'definition', label:'Cloud Misconfiguration', text:'The #1 cloud vulnerability. S3 buckets left public, overly permissive IAM roles, security groups allowing 0.0.0.0/0. The cloud is secure ‚Äî but only if configured correctly. Most cloud breaches are misconfigurations, not sophisticated hacks.' },
        { type:'definition', label:'Side Loading', text:'Installing apps on mobile devices from outside the official app store (APK files on Android). Apps from unofficial sources aren\'t vetted and may contain malware.' },
        { type:'definition', label:'Jailbreaking / Rooting', text:'Removing manufacturer restrictions from iOS (jailbreak) or Android (root). Bypasses security controls, removes app sandboxing, makes the device significantly more vulnerable.' },
        { type:'definition', label:'Zero-Day', text:'A vulnerability unknown to the vendor ‚Äî no patch exists. Called "zero-day" because the vendor has had zero days to fix it. Extremely valuable to attackers and nation-states.' },
      ]
    },
  ],
  quiz: [
    { q:'A web developer creates a login form that directly concatenates user input into a SQL query without sanitization. An attacker enters specially crafted input to bypass authentication. What vulnerability is being exploited?', choices:['Cross-site scripting','Buffer overflow','SQL injection','Directory traversal'], answer:2, explain:'This is <strong>SQL injection</strong> ‚Äî user input inserted directly into a SQL query allows attackers to manipulate the query. The fix is parameterized queries (prepared statements) that treat user input as data, never as executable code.' },
    { q:'A hospital runs a medical device controlling patient monitors. The device runs Windows XP, which Microsoft stopped supporting in 2014. What type of vulnerability does this represent?', choices:['Zero-day','Misconfiguration','End-of-life / Legacy system','Jailbreaking'], answer:2, explain:'Running <strong>end-of-life software</strong> means no more security patches. Every new vulnerability discovered after EOL is a permanent, unpatched weakness. This is extremely common in healthcare with medical devices that have long lifecycles.' },
    { q:'An attacker exploits a vulnerability in a virtualization platform that allows code running inside a guest VM to execute commands on the hypervisor, gaining access to other VMs on the same physical server. What is this called?', choices:['Resource reuse','VM escape','Side loading','Memory injection'], answer:1, explain:'<strong>VM escape</strong> is when an attacker breaks out of the VM boundary to access the hypervisor or other VMs. It\'s one of the most severe virtualization vulnerabilities because it compromises the isolation that makes VMs valuable as a security boundary.' },
  ]
},

'vuln-app-web': {
  title: 'Application & Web Attack Techniques',
  subtitle: 'Injection, traversal, privilege escalation, forgery ‚Äî the web attacker\'s toolkit',
  domain: 2, domainName: '2.0 Threats, Vulnerabilities, and Mitigations',
  content: [
    { type:'analogy', label:'üîì Web apps are the front door attackers love most', text:'Most organizations expose web applications directly to the internet. Every input field, URL parameter, and API endpoint is a potential attack surface. Web attacks are the top source of data breaches year after year ‚Äî the OWASP Top 10 is required reading.' },
    { type:'section', title:'Injection Attacks', icon:'üíâ', bg:'#ff4d6d',
      items:[
        { type:'table', headers:['Injection Type','How It Works','Prevention'], rows:[
          ['SQL Injection (SQLi)','Malicious SQL inserted into input fields manipulates database queries','Parameterized queries, input validation, WAF'],
          ['Command Injection','Attacker injects OS commands into an app that passes input to the shell','Input sanitization, avoid shell calls, use safe APIs'],
          ['XSS (Cross-Site Scripting)','Malicious scripts injected into web pages run in other users\' browsers','Output encoding, Content Security Policy, input validation'],
          ['LDAP Injection','Malicious LDAP statements injected to manipulate directory queries','Input validation, use safe LDAP libraries'],
        ]}
      ]
    },
    { type:'section', title:'Other Critical Web Attacks', icon:'üåê', bg:'#ff7b39',
      items:[
        { type:'definition', label:'Directory Traversal (Path Traversal)', text:'Attacker uses "../../../" sequences in URLs or file parameters to navigate outside the intended directory and access files they shouldn\'t. Example: requesting <code>../../etc/passwd</code> to read the Linux password file.' },
        { type:'definition', label:'Privilege Escalation', text:'Gaining higher permissions than originally granted. <strong>Vertical escalation</strong>: regular user ‚Üí admin. <strong>Horizontal escalation</strong>: accessing another user\'s data at the same privilege level. Often follows initial compromise as attackers move toward high-value targets.' },
        { type:'definition', label:'Replay Attack', text:'Intercepting and re-sending a valid authentication token or session to gain unauthorized access. Like copying someone\'s keycard swipe data and replaying it later. Prevented by timestamps, nonces, and session expiration.' },
        { type:'definition', label:'CSRF (Cross-Site Request Forgery)', text:'A malicious website tricks a victim\'s authenticated browser into making requests to another site where they\'re logged in. If you\'re logged into your bank and visit a malicious site, that site can make your browser submit a bank transfer without you knowing. Prevention: CSRF tokens, SameSite cookies.' },
        { type:'definition', label:'SSRF (Server-Side Request Forgery)', text:'Attacker makes the server itself send requests to internal resources. From the server\'s perspective, it\'s a local trusted request ‚Äî bypassing firewalls that only check external traffic. Major cloud attack vector for accessing metadata endpoints.' },
      ]
    },
    { type:'tip', label:'üéØ CSRF vs. XSS ‚Äî The Key Difference', text:'<strong>XSS</strong>: attacker injects script into a website that runs in OTHER users\' browsers (attacks the site\'s users). <strong>CSRF</strong>: attacker\'s malicious site tricks your browser into making requests to a legitimate site you\'re already authenticated to (abuses your existing session). Different mechanism, different fix.' },
  ],
  quiz: [
    { q:'An attacker crafts a URL: "https://app.com/view?file=../../etc/shadow" ‚Äî if successful, they can read the Linux shadow password file. What attack is this?', choices:['SQL injection','Directory traversal','Command injection','CSRF'], answer:1, explain:'This is <strong>directory traversal</strong> (path traversal) ‚Äî using "../" sequences to navigate outside the intended directory. The attacker is escaping the web root to read system files. Prevented by input validation and confining file access to allowed directories.' },
    { q:'A logged-in bank customer visits a malicious website. The site contains hidden code that causes the customer\'s browser to automatically submit a $5,000 transfer to their bank using their existing session. What attack is this?', choices:['XSS','Phishing','CSRF (Cross-Site Request Forgery)','Session hijacking'], answer:2, explain:'This is <strong>CSRF</strong> ‚Äî the attacker\'s site abuses the victim\'s existing authenticated session with another site. The bank sees a legitimate, authenticated request. Prevention: CSRF tokens, SameSite cookie attribute, re-authentication for sensitive transactions.' },
    { q:'After exploiting a vulnerability to gain regular user access, an attacker finds a bug that lets them access the admin panel and create new administrator accounts. What type of attack did they perform second?', choices:['Horizontal privilege escalation','Vertical privilege escalation','Replay attack','SSRF'], answer:1, explain:'Moving from a regular user to administrator is <strong>vertical privilege escalation</strong> ‚Äî gaining higher privileges than originally granted. Horizontal escalation would be accessing another user\'s data at the same privilege level (e.g., reading another customer\'s records).' },
  ]
},

'threat-actors': {
  title: 'Threat Actors: Know Your Enemy',
  subtitle: 'Understanding who attacks systems and why ‚Äî critical for 2.1',
  domain: 2, domainName: '2.0 Threats, Vulnerabilities, and Mitigations',
  content: [
    { type:'analogy', label:'üé≠ Attackers come in all flavors', text: 'Just like crimes in the real world are committed by different people with different motives ‚Äî hackers aren\'t all the same. A teenager in a basement has very different capabilities than a government-sponsored spy team.' },
    { type:'section', title:'Types of Threat Actors', icon:'üé≠', bg:'#ff7b39',
      items:[
        { type:'table', headers:['Actor','Sophistication','Resources','Primary Motivation'], rows:[
          ['Nation-State (APT)','Very High','Extensive government funding','Espionage, critical infrastructure attacks, warfare'],
          ['Organized Crime','High','Well-funded crime syndicates','Financial gain, ransomware, data theft to sell'],
          ['Hacktivist','Medium','Moderate, ideologically driven','Political/philosophical beliefs, disruption, publicity'],
          ['Insider Threat','Varies','Has legitimate access already','Revenge, financial gain, ideology, unintentional'],
          ['Unskilled Attacker','Low','Minimal ‚Äî uses existing tools','Curiosity, minor disruption, learning'],
          ['Shadow IT','Low-Med','Company resources (used improperly)','Convenience ‚Äî bypassing IT to use unauthorized tools'],
        ]}
      ]
    },
    { type:'section', title:'Threat Actor Attributes', icon:'üîç', bg:'#4f8ef7',
      items:[
        { type:'definition', label:'Internal vs. External', text:'<strong>Internal</strong> threats are employees, contractors, or partners with existing access. They\'re dangerous because they already have credentials and know the network. <strong>External</strong> threats are outsiders trying to get in.' },
        { type:'definition', label:'APT ‚Äî Advanced Persistent Threat', text:'A long-term, targeted attack campaign ‚Äî typically nation-state level. The attacker gets in quietly and stays hidden for months or years, slowly exfiltrating data. Think of it as a spy operation, not a smash-and-grab.' }
      ]
    },
    { type:'section', title:'Motivations', icon:'üí°', bg:'#22d06b',
      items:[
        { type:'terms', title:'', terms:[
          { term:'Data Exfiltration', def:'Stealing data ‚Äî the most common objective for organized crime and nation-states' },
          { term:'Espionage', def:'Spying on competitors or governments ‚Äî nation-state specialty' },
          { term:'Financial Gain', def:'Ransomware, bank fraud, selling stolen data ‚Äî organized crime' },
          { term:'Service Disruption', def:'Taking down systems via DDoS ‚Äî hacktivists, nation-states' },
          { term:'Revenge', def:'Disgruntled employee deleting data or leaking information' },
          { term:'Ethical/Disruption', def:'Hacktivists attacking organizations they disagree with politically' }
        ]}
      ]
    },
  ],
  quiz: [
    { q:'A foreign government\'s intelligence agency spends 18 months silently inside a defense contractor\'s network, slowly copying classified documents. This is best described as:', choices:['An insider threat attack','An unskilled attacker (script kiddie) attack','An Advanced Persistent Threat (APT)','A hacktivist operation'], answer:2, explain:'This is a classic <strong>APT (Advanced Persistent Threat)</strong> ‚Äî nation-state backed, highly sophisticated, targeted, and persistent over a long period. The "slow copy" = exfiltration, the "18 months silently" = persistence.' },
    { q:'An employee who was just passed over for a promotion begins copying sensitive customer data to a personal USB drive. What type of threat actor is this?', choices:['Nation-state','Unskilled attacker','Insider threat','Organized crime'], answer:2, explain:'This is an <strong>insider threat</strong> ‚Äî an authorized user abusing legitimate access. The motivation is revenge (passed over for promotion).' },
    { q:'A group of hackers takes down a pharmaceutical company\'s website to protest what they consider unethical drug pricing. Which threat actor category BEST describes them?', choices:['Nation-state','Organized crime','Unskilled attacker','Hacktivist'], answer:3, explain:'This is a <strong>hacktivist</strong> attack ‚Äî politically or ethically motivated, using hacking as a form of protest or activism.' },
  ]
},

'malware': {
  title: 'Malware: The Rogue\'s Gallery of Bad Code',
  subtitle: 'Every type of malicious software you must know for the exam',
  domain: 2, domainName: '2.0 Threats, Vulnerabilities, and Mitigations',
  content: [
    { type:'analogy', label:'ü¶† Malware is like disease', text: 'Just like diseases, malware spreads, hides, and causes damage in different ways. A virus needs a host file. A worm travels on its own. Ransomware holds you hostage. Know each one cold.' },
    { type:'section', title:'Malware Types', icon:'ü¶†', bg:'#ff4d6d',
      items:[
        { type:'table', headers:['Type','How it works','Key trait'], rows:[
          ['Virus','Attaches to legitimate files; spreads when host is executed','Requires human action to spread (opening infected file)'],
          ['Worm','Self-replicates and spreads across networks automatically','Spreads WITHOUT human interaction ‚Äî uses network vulnerabilities'],
          ['Trojan','Disguises as legitimate software; malicious payload inside','Tricks users into installing it; creates backdoors'],
          ['Ransomware','Encrypts victim\'s files; demands payment for decryption key','Attacks Confidentiality AND Availability; most costly malware type'],
          ['Spyware','Secretly monitors user activity; collects credentials, keystrokes','Runs silently in background; sends data to attacker'],
          ['Keylogger','Records every keystroke the user types','Captures passwords, credit cards, sensitive communications'],
          ['Rootkit','Hides deep in OS, often in kernel; very hard to detect/remove','Modifies OS itself to conceal attacker presence'],
          ['Logic Bomb','Dormant code that triggers on a specific condition or date','"Time bomb" ‚Äî activates on a specific date or event'],
          ['Bloatware','Unwanted pre-installed software; wastes resources; may be adware','Usually not malicious but reduces performance/privacy'],
        ]}
      ]
    },
    { type:'tip', label:'üéØ Virus vs. Worm ‚Äî The Exam Trap', text:'A <strong>virus</strong> needs you to DO something (click, open a file). A <strong>worm</strong> spreads on its own through networks. The WannaCry ransomware was actually a worm ‚Äî it spread itself automatically.' },
    { type:'definition', label:'Rootkit ‚Äî The Sneakiest', text:'A rootkit operates at the kernel level ‚Äî the deepest part of the OS. Because it modifies the OS itself, it can hide files, processes, and network connections from normal security tools. Often requires specialized detection tools or a full OS reinstall.' },
  ],
  quiz: [
    { q:'A piece of malware spreads automatically through a company network by exploiting an unpatched vulnerability in the remote desktop protocol, without any user clicking on anything. This is BEST described as a:', choices:['Virus','Worm','Trojan','Ransomware'], answer:1, explain:'A <strong>worm</strong> self-replicates and spreads automatically without human interaction. Exploiting a network vulnerability to spread independently is the defining trait of a worm.' },
    { q:'A user downloads what appears to be a free game from an unofficial website. Once installed, it creates a hidden backdoor that gives an attacker remote access. This is a:', choices:['Logic Bomb','Worm','Trojan','Rootkit'], answer:2, explain:'This is a <strong>Trojan</strong> ‚Äî malware that disguises itself as legitimate software. The user was tricked into installing it by the "free game" lure.' },
    { q:'An attacker compromises a bank\'s system. Their code sits dormant for six months and then, on January 1st, begins deleting all financial records. This is a:', choices:['Ransomware','Worm','Logic Bomb','Spyware'], answer:2, explain:'This is a <strong>Logic Bomb</strong> ‚Äî code that lies dormant and triggers on a specific condition (in this case, a date: January 1st). Logic bombs are often planted by insiders.' },
  ]
},

'baselines-hardening': {
  title: 'Secure Baselines & Hardening Targets',
  subtitle: 'Establish, deploy, maintain ‚Äî securing every device type in the enterprise',
  domain: 4, domainName: '4.0 Security Operations',
  content: [
    { type:'analogy', label:'üèóÔ∏è Building codes for IT systems', text:'A building code sets minimum standards ‚Äî ceiling height, fire exits, electrical requirements. Security baselines are building codes for IT systems ‚Äî minimum security requirements every system must meet before production.' },
    { type:'section', title:'Secure Baseline Lifecycle', icon:'üîÑ', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Phase','Activities'], rows:[
          ['Establish','Define what the baseline should be ‚Äî use CIS Benchmarks, NIST guides, vendor hardening guides as starting points. Document specific settings for each OS/device type.'],
          ['Deploy','Apply the baseline to new systems before they go to production. Automated tools (Group Policy, Ansible, SCCM) enforce baseline settings at deployment.'],
          ['Maintain','Continuously monitor for configuration drift ‚Äî systems changing from baseline over time. Re-apply settings. Update baseline when new vulnerabilities are discovered.'],
        ]}
      ]
    },
    { type:'section', title:'Hardening by Device Type', icon:'üñ•Ô∏è', bg:'#22d06b',
      items:[
        { type:'table', headers:['Target','Key Hardening Steps'], rows:[
          ['Workstations','Full-disk encryption (BitLocker), EDR agent, standard user accounts (no local admin), screen lock policy, patch management, disable USB boot'],
          ['Servers','Disable unnecessary services/roles, remove GUI if not needed, configure host firewall, enable comprehensive logging, regular patching, principle of least function'],
          ['Switches','Change default credentials, disable unused ports, enable port security (802.1X), disable Telnet ‚Üí use SSH only, configure VLAN segmentation, update firmware'],
          ['Routers','Change default credentials, disable unnecessary services (SNMP v1/v2, finger), enable SSH, implement ACLs, update firmware, disable HTTP management ‚Üí HTTPS only'],
          ['Cloud Infrastructure','Disable public access by default, IAM least privilege policies, MFA for all accounts, enable CloudTrail/logging, encrypt all storage by default, monitor for misconfigurations'],
          ['ICS/SCADA','Network isolation (air gap or strict segmentation), application whitelisting, remove internet connectivity, strict physical access, compensating controls for systems that cannot be patched'],
          ['Mobile Devices','MDM enrollment mandatory, screen lock + PIN, full-device encryption, remote wipe capability, disable sideloading (unauthorized app installation), certificate-based Wi-Fi'],
          ['IoT Devices','Change default credentials immediately, update firmware, isolate on dedicated VLAN, disable unused features, monitor for anomalous traffic patterns'],
        ]}
      ]
    },
    { type:'definition', label:'CIS Benchmarks', text:'The Center for Internet Security publishes free, consensus-driven hardening benchmarks for most operating systems, network devices, cloud platforms, and applications. These are the industry standard baselines referenced in audits and compliance frameworks. Know that they exist and what they\'re for.' },
    { type:'tip', label:'üéØ Configuration Drift', text:'Systems that start secure become insecure over time ‚Äî patches skipped, settings changed for convenience, software installed. <strong>Configuration enforcement</strong> (continuous baseline monitoring via SCAP scanners, DSC, Ansible) catches drift before attackers can exploit it.' },
  ],
  quiz: [
    { q:'A security team discovers several previously hardened servers have had their host-based firewalls disabled over time, deviating from the approved baseline. What process monitors and corrects this?', choices:['Patch management','Vulnerability scanning','Configuration enforcement / drift detection','Incident response'], answer:2, explain:'<strong>Configuration enforcement</strong> (configuration drift detection) continuously monitors systems against their approved baseline and alerts on or automatically corrects deviations. Systems naturally drift from baselines over time as changes accumulate ‚Äî this process keeps them compliant.' },
    { q:'A new industrial control system cannot be patched due to vendor restrictions, and antivirus cannot be installed without voiding the warranty. What is the BEST security approach?', choices:['Accept the risk and document an exception','Isolate it on a dedicated network segment with strict access controls and enhanced monitoring','Demand the vendor allow patching before installation','Replace it with a modern system that supports patching'], answer:1, explain:'When traditional controls can\'t be applied to ICS/SCADA systems, <strong>network isolation plus compensating controls</strong> is the correct approach. Isolate on its own network segment, restrict all communication to only necessary systems, add enhanced monitoring for anomalous behavior, and formally document the compensating controls.' },
  ]
},

'mobile-wireless': {
  title: 'Mobile & Wireless Security',
  subtitle: 'MDM, BYOD models, WPA2/WPA3, site surveys ‚Äî securing the mobile attack surface',
  domain: 4, domainName: '4.0 Security Operations',
  content: [
    { type:'analogy', label:'üì± Mobile devices are pocket computers with massive attack surfaces', text:'Your phone has your email, corporate apps, location data, camera, microphone, and VPN credentials. Losing it is worse than losing a laptop in many cases. MDM is how organizations maintain control over devices they don\'t physically own.' },
    { type:'section', title:'Mobile Deployment Models', icon:'üì±', bg:'#7c5cfc',
      items:[
        { type:'table', headers:['Model','Who Owns Device','IT Control Level','Privacy Concern'], rows:[
          ['BYOD (Bring Your Own Device)','Employee','Limited ‚Äî only corporate data/apps can be managed','High ‚Äî employee has personal data on same device'],
          ['COPE (Corporate-Owned, Personally Enabled)','Company','Full device control','Medium ‚Äî company owns device but allows personal use'],
          ['CYOD (Choose Your Own Device)','Company','Full device control','Low ‚Äî employee chooses from approved list; company owned'],
          ['Company-Owned, Business Only','Company','Full device control','None ‚Äî no personal use permitted'],
        ]}
      ]
    },
    { type:'section', title:'MDM ‚Äî Mobile Device Management', icon:'üîß', bg:'#4f8ef7',
      items:[
        { type:'definition', label:'What MDM Controls', text:'Enforces security policies on mobile devices: screen lock and PIN requirements, encryption enforcement, remote wipe capability (lost/stolen device), app management (push/remove apps), VPN configuration, certificate distribution, compliance checking (blocks jailbroken/rooted devices).' },
        { type:'definition', label:'Connection Security', text:'<strong>Cellular</strong>: encrypted by carrier; risk of IMSI catchers (fake cell towers). <strong>Wi-Fi</strong>: must use WPA3 or WPA2-Enterprise; open Wi-Fi is dangerous. <strong>Bluetooth</strong>: disable when not in use; vulnerable to bluejacking (spam), bluesnarfing (data theft), bluebee attacks.' },
      ]
    },
    { type:'section', title:'Wireless Security Protocols', icon:'üì°', bg:'#22d06b',
      items:[
        { type:'table', headers:['Protocol','Security Level','Authentication','Notes'], rows:[
          ['WEP','Broken ‚Äî do NOT use','Shared key','RC4 with fatal flaws ‚Äî cracked in minutes with aircrack-ng'],
          ['WPA2-Personal','Acceptable for home','PSK (Pre-Shared Key)','Shared passphrase; vulnerable to offline dictionary attacks if weak password'],
          ['WPA2-Enterprise','Good','802.1X + RADIUS','Individual user credentials; compromising one user doesn\'t compromise all'],
          ['WPA3-Personal','Better','SAE (Simultaneous Authentication of Equals)','Eliminates offline dictionary attacks; forward secrecy'],
          ['WPA3-Enterprise','Best','192-bit security mode + 802.1X','Highest security; required for government/classified environments'],
        ]},
        { type:'definition', label:'Site Survey', text:'Physical wireless assessment of signal coverage, interference, and access point placement before or after deployment. Identifies dead zones, overlap areas, and rogue access points. Heat maps visualize signal strength across a physical space. Essential for both performance and security planning.' },
        { type:'definition', label:'AAA/RADIUS for Wireless', text:'Enterprise Wi-Fi uses 802.1X with a RADIUS server ‚Äî each user authenticates with their own credentials, not a shared password. Compromised credentials affect only that one user and can be revoked individually without changing the network password for everyone.' },
      ]
    },
  ],
  quiz: [
    { q:'A company allows employees to use personal smartphones for work email and calendar. The IT policy requires remote wipe capability, encryption, and screen lock enforcement. What technology enables this?', choices:['802.1X network access control','MDM (Mobile Device Management)','VPN split tunneling','WPA3-Enterprise'], answer:1, explain:'<strong>MDM</strong> allows organizations to enforce security policies (encryption, screen lock, remote wipe) on mobile devices ‚Äî including personal BYOD devices. The MDM profile is installed on the device, giving IT the ability to enforce policies and remotely wipe corporate data if the device is lost.' },
    { q:'A company\'s wireless network uses a shared Wi-Fi password known by all 500 employees. When an employee is terminated, what is the primary security concern?', choices:['The terminated employee could still connect until the password is changed for everyone','WPA2-Personal is not encrypted','The password might expire','MDM cannot manage this configuration'], answer:0, explain:'With a shared PSK, every employee knows the same password. A terminated employee retains access until the password is changed ‚Äî which forces ALL 500 employees to update their devices simultaneously. WPA2/WPA3-Enterprise with 802.1X solves this ‚Äî each user has individual credentials that can be revoked without affecting others.' },
  ]
},

'asset-mgmt': {
  title: 'Asset Management',
  subtitle: 'Acquisition, assignment, tracking, and secure disposal ‚Äî lifecycle management',
  domain: 4, domainName: '4.0 Security Operations',
  content: [
    { type:'analogy', label:'üì¶ You can\'t secure what you don\'t know you have', text:'A hospital that doesn\'t know it has 50 networked infusion pumps can\'t patch them. A company that doesn\'t track its laptops can\'t know if one goes missing. Asset management is the foundation ‚Äî without it, every other security control has blind spots.' },
    { type:'section', title:'Asset Lifecycle', icon:'üîÑ', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Phase','Key Activities','Security Importance'], rows:[
          ['Acquisition/Procurement','Purchasing hardware, software, cloud services through approved vendor process','Security review before purchase; vet vendors; enforce approved software lists'],
          ['Assignment/Accounting','Assigning assets to owners; classifying assets by criticality and data sensitivity','Establishes who is responsible; determines what level of protection is required'],
          ['Monitoring/Tracking','Inventory database; asset tags; automated discovery tools; location tracking','Know what you have; detect unauthorized devices; track physical location'],
          ['Disposal/Decommissioning','Secure end-of-life process for retiring hardware and destroying data','Prevent data from leaving the organization on retired hardware ‚Äî the forgotten phase that causes breaches'],
        ]}
      ]
    },
    { type:'section', title:'Secure Disposal ‚Äî Critical and Often Overlooked', icon:'üóëÔ∏è', bg:'#ff4d6d',
      items:[
        { type:'table', headers:['Method','Description','Use When'], rows:[
          ['Data Sanitization','Overwriting data with zeros/random patterns (DoD 5220.22-M standard = 7-pass overwrite)','HDDs being reused or donated ‚Äî makes data unrecoverable while preserving hardware'],
          ['Degaussing','Exposing magnetic media to a powerful magnetic field, destroying the magnetic pattern completely','HDDs/tapes that won\'t be reused ‚Äî makes the device permanently unusable'],
          ['Physical Destruction','Shredding, crushing, pulverizing, or incinerating the storage media','Classified data; media where any risk of recovery is unacceptable'],
          ['Cryptographic Erasure','If the drive was fully encrypted, destroying the encryption key renders all data permanently unrecoverable','SSDs (difficult to physically overwrite all cells); encrypted cloud storage'],
        ]},
        { type:'definition', label:'Certificate of Destruction', text:'A formal document from a certified media destruction vendor proving that hardware/data was disposed of properly according to standards. Required for compliance (HIPAA, PCI DSS) and provides legal protection in the event of a data breach investigation.' },
        { type:'definition', label:'Data Retention Policy', text:'How long different types of data must be kept before deletion. Legal requirements vary: HIPAA = 6 years, PCI DSS = 1 year for certain logs, SOX = 7 years for financial records. Keeping data longer than required increases risk and storage costs without benefit.' },
      ]
    },
  ],
  quiz: [
    { q:'A company is decommissioning 200 old laptops. Some will be donated to a local school; some will be physically destroyed. For the laptops being donated, which disposal method is MOST appropriate?', choices:['Physical destruction (shredding)','Degaussing','Data sanitization (secure overwrite)','Simply formatting the drives'], answer:2, explain:'For hardware being reused/donated, <strong>data sanitization</strong> (secure overwrite per DoD 5220.22-M or similar) is appropriate ‚Äî it destroys the data while leaving the hardware functional. Physical destruction works but destroys usable hardware wastefully. Standard formatting does NOT securely erase data ‚Äî it only removes file system pointers.' },
    { q:'An organization retires a fleet of SSDs that stored classified government data. Standard data overwriting may not reach all memory cells on SSDs due to wear-leveling. What is the BEST disposal method?', choices:['Standard 7-pass overwrite','Degaussing','Cryptographic erasure if encrypted, or physical destruction','Formatting and reuse'], answer:2, explain:'SSDs have wear-leveling and over-provisioning that make complete software overwriting unreliable ‚Äî some cells may be unreachable. If the SSD was <strong>encrypted, cryptographic erasure</strong> (destroying the encryption key) renders all data permanently unrecoverable. Otherwise, <strong>physical destruction</strong> is required. Degaussing doesn\'t work on SSDs (they\'re not magnetic storage).' },
  ]
},

'firewall-ids': {
  title: 'Firewalls, IDS/IPS & Web Filtering',
  subtitle: 'Rules, signatures, anomaly detection, URL filtering, NAC ‚Äî defense in depth',
  domain: 4, domainName: '4.0 Security Operations',
  content: [
    { type:'analogy', label:'üîç Security tools work like different types of security staff', text:'A bouncer checks IDs at the door (firewall). A detective reviews camera footage for suspicious behavior (IDS). An undercover officer stops crimes in real time (IPS). A content moderator filters what comes through the mail room (web filter). All different jobs, all necessary for complete security.' },
    { type:'section', title:'Firewall Rule Management', icon:'üî•', bg:'#ff4d6d',
      items:[
        { type:'definition', label:'Firewall Rules & ACLs', text:'Rules processed top-to-bottom, first match wins. Best practice: specific rules first, broad rules last, implicit deny all at bottom. Each rule specifies: source IP, destination IP, protocol, port, action (permit/deny). Regularly audit and remove stale rules ‚Äî rule sprawl creates security gaps.' },
        { type:'definition', label:'Screened Subnet (DMZ)', text:'A network segment between the internet and internal network, protected by two firewalls. Public-facing servers (web, email, DNS) live here. If a DMZ server is compromised, the attacker still faces the inner firewall protecting the internal network. Also called a three-legged firewall architecture.' },
      ]
    },
    { type:'section', title:'IDS vs. IPS Configuration', icon:'üõ°Ô∏è', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Aspect','IDS','IPS'], rows:[
          ['Action','Alert only ‚Äî cannot block traffic','Can actively block/drop malicious traffic'],
          ['Network Placement','Tap/SPAN port (out of band) ‚Äî sees copy of traffic','Inline ‚Äî all traffic flows through it'],
          ['Failure Mode','Fail-open (traffic continues flowing)','Should fail-closed (blocks all if it fails ‚Äî safer but impacts availability)'],
          ['Detection Methods','Signature-based AND anomaly-based','Same as IDS'],
          ['False Positive Impact','Analyst gets alert (nuisance but no business impact)','Traffic is BLOCKED (business impact if false positive!)'],
        ]},
        { type:'definition', label:'Signatures vs. Anomaly Detection', text:'<strong>Signature-based</strong>: matches known attack patterns from a signature database ‚Äî excellent against known threats, completely blind to new ones. <strong>Anomaly-based</strong>: detects deviation from normal baseline behavior ‚Äî catches zero-days but higher false positive rate. Most modern IDS/IPS use both methods together for comprehensive coverage.' },
      ]
    },
    { type:'section', title:'Web & DNS Filtering', icon:'üåê', bg:'#22d06b',
      items:[
        { type:'definition', label:'Web Filter / URL Filter', text:'Blocks access to websites by category (gambling, adult content, malware, phishing) or specific URL/domain. Can be agent-based (software on each endpoint) or centralized proxy (all traffic routed through filter). Reputation-based filtering blocks sites known to host malware or participate in phishing campaigns.' },
        { type:'definition', label:'DNS Filtering', text:'Blocking malicious domains at the DNS level ‚Äî if you can\'t resolve a malicious domain name to an IP, you can\'t connect to it. Faster than URL filtering and works for all protocols (not just HTTP/HTTPS). Services like Cloudflare for Teams, Cisco Umbrella operate at this layer.' },
        { type:'definition', label:'NAC (Network Access Control)', text:'Checks device health and compliance before granting network access. A device that lacks antivirus, isn\'t patched, or is jailbroken can be quarantined to a remediation VLAN or granted limited guest-only access. Often works with 802.1X for enforcement. NAC is the bouncer checking credentials AND vaccination card.' },
      ]
    },
  ],
  quiz: [
    { q:'A security team configures their IPS with very sensitive signature rules. The IPS begins blocking legitimate business application traffic that matches broad attack signatures. What problem occurred, and what should be done?', choices:['The IPS signatures need updating; reinstall from scratch','High false positive rate; tune signatures to be more specific and reduce blocking of legitimate traffic','The IPS should be replaced with an IDS','Increase IPS sensitivity further'], answer:1, explain:'This is a <strong>high false positive rate</strong> ‚Äî the IPS is blocking legitimate traffic. The solution is <strong>signature tuning</strong>: refining rules to be more specific so they catch real attacks without blocking legitimate business traffic. This is why IPS deployment requires careful testing in monitor mode before going live with blocking enabled.' },
    { q:'An organization wants to prevent employees from accessing known malware distribution sites and C2 domains without inspecting HTTPS traffic or deploying endpoint agents. What is the most efficient solution?', choices:['Proxy-based URL filtering requiring SSL inspection','DNS filtering ‚Äî block resolution of known malicious domains','Host-based firewall rules on each endpoint','IDS signature-based detection'], answer:1, explain:'<strong>DNS filtering</strong> blocks at the DNS resolution level ‚Äî before a connection is even attempted. It works for all protocols (not just HTTP/S), requires no SSL inspection, and needs no endpoint agents. If malware can\'t resolve its C2 domain, it can\'t phone home regardless of protocol or encryption.' },
  ]
},

'email-security': {
  title: 'Email Security: SPF, DKIM, DMARC',
  subtitle: 'The authentication trio that protects against email spoofing at the protocol level',
  domain: 4, domainName: '4.0 Security Operations',
  content: [
    { type:'analogy', label:'‚úâÔ∏è Email was designed with zero authentication', text:'The original SMTP protocol has no built-in sender authentication ‚Äî anyone can send email claiming to be from anyone. SPF, DKIM, and DMARC were added LATER to fix this fundamental design flaw. Think of them as adding a return address verification system to a postal service that originally had none.' },
    { type:'section', title:'The Email Authentication Trio', icon:'üîê', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Protocol','What It Does','How It Works','What It Stops'], rows:[
          ['SPF (Sender Policy Framework)','Verifies sending mail server is authorized for this domain','Domain owner publishes list of authorized sending server IPs in DNS TXT record. Receiving server checks if sender IP is on the list.','Domain spoofing from unauthorized mail servers'],
          ['DKIM (DomainKeys Identified Mail)','Cryptographically signs outgoing email to verify authenticity and integrity','Sending server adds digital signature to email headers using private key. Receiver verifies signature against public key published in DNS.','Email tampering in transit; verifies email came from claimed domain and wasn\'t modified'],
          ['DMARC (Domain-based Message Authentication, Reporting & Conformance)','Policy for what to do when SPF/DKIM fail + reporting on authentication failures','Domain owner publishes policy in DNS: "If SPF/DKIM fail, reject/quarantine/do nothing." Also specifies where to send authentication failure reports.','Domain impersonation; provides visibility into spoofing attempts against your domain'],
        ]}
      ]
    },
    { type:'section', title:'How They Work Together', icon:'üîÑ', bg:'#22d06b',
      items:[
        { type:'text', text:'SPF and DKIM operate independently ‚Äî you can have one without the other. DMARC uses the results of BOTH to make a final policy decision. A properly protected domain has: <strong>SPF</strong> to verify the sending server is authorized, <strong>DKIM</strong> to cryptographically verify message integrity and origin, <strong>DMARC</strong> with "reject" policy to tell receivers to block authentication failures and send you aggregate reports of all authentication attempts.' },
        { type:'tip', label:'üéØ The Key Differences', text:'<strong>SPF</strong>: Is this server IP allowed to send email for this domain? (IP-based check). <strong>DKIM</strong>: Was this email actually sent by this domain and not modified in transit? (Cryptographic signature). <strong>DMARC</strong>: What should receiving servers do if SPF or DKIM fail, and please send me reports on all authentication attempts against my domain.' },
      ]
    },
    { type:'section', title:'Email Gateway & Defense', icon:'üõ°Ô∏è', bg:'#7c5cfc',
      items:[
        { type:'definition', label:'Email Security Gateway', text:'Inline security appliance or cloud service that filters email before it reaches users\' inboxes. Provides: spam filtering, malware scanning (attachments and links), phishing detection, content filtering (DLP), sandboxing of suspicious attachments. Acts as the first line of defense before mail reaches the user.' },
      ]
    },
  ],
  quiz: [
    { q:'An attacker sends emails spoofed to appear from "ceo@company.com" requesting wire transfers. The company has an SPF record listing their authorized mail servers. Why might the spoofed emails still get through?', choices:['SPF records only work on inbound email','SPF only checks the envelope sender (technical SMTP sender), not the From header visible to users ‚Äî attackers can spoof the display From while sending from an authorized server','SPF requires DKIM to function','SPF records expire after 30 days'], answer:1, explain:'SPF checks the <strong>envelope sender</strong> (technical SMTP sender) against authorized IPs, but email clients display the <strong>header From</strong> field which can be different. Attackers can send through an authorized server with a spoofed display From header. DMARC with alignment checking helps close this gap by requiring the header From to match the authenticated domain.' },
    { q:'An organization wants to receive reports about which servers are sending email claiming to be from their domain, and instruct receiving mail servers to reject unauthenticated email from their domain. Which protocol should be configured?', choices:['SPF with hardfail (~all)','DKIM with strong key length','DMARC with reject policy and aggregate reporting (RUA)','Email gateway with anti-spoofing rules'], answer:2, explain:'<strong>DMARC</strong> does both: enforces what happens when authentication fails (p=reject) and provides reporting (rua= tag) so the domain owner receives aggregate reports of authentication results. Start with p=none (monitoring only), analyze reports, then move to p=quarantine, then p=reject as confidence increases.' },
  ]
},

'iam-basics': {
  title: 'Identity & Access Management Fundamentals',
  subtitle: 'Provisioning, federation, SSO, LDAP, SAML, OAuth ‚Äî managing digital identities',
  domain: 4, domainName: '4.0 Security Operations',
  content: [
    { type:'analogy', label:'ü™™ IAM is the HR department for digital identity', text:'HR hires people, gives them a badge, defines what offices they can access, and revokes everything when they leave. IAM does exactly this for digital systems ‚Äî creates accounts, assigns permissions, federates identity across systems, and deprovisions when someone leaves.' },
    { type:'section', title:'Identity Lifecycle', icon:'üîÑ', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Phase','Activities','Security Consideration'], rows:[
          ['Provisioning','Creating user accounts, assigning roles and permissions','Follow least privilege; use role templates; require approval workflow'],
          ['Identity Proofing','Verifying the person is who they claim to be before issuing credentials','Critical for privileged accounts; use government ID verification for high-risk access'],
          ['Attestation','Regular review of user accounts and permissions ‚Äî do they still need this access?','Quarterly access reviews minimum; remove stale permissions; catch privilege creep'],
          ['De-provisioning','Disabling/deleting accounts when employees leave or change roles','Day-zero process ‚Äî revoke access immediately on termination; most critical IAM phase'],
        ]}
      ]
    },
    { type:'section', title:'Federation & SSO', icon:'üîó', bg:'#22d06b',
      items:[
        { type:'definition', label:'Federation', text:'Allowing users from one organization to access resources in another using their home organization\'s credentials. Example: Using your Google account to log into a third-party app ‚Äî Google is the Identity Provider (IdP), the app is the Service Provider (SP). The user never creates a new account with the app.' },
        { type:'definition', label:'SSO (Single Sign-On)', text:'Authenticate once, access many systems without re-entering credentials. Users log in once and access all authorized applications during that session. Benefits: reduces password fatigue, centralizes authentication, simplifies deprovisioning (disable one account = revoke access everywhere).' },
        { type:'table', headers:['Protocol','What It\'s Used For','Key Fact'], rows:[
          ['LDAP','Directory services ‚Äî looking up user accounts, group membership, organizational structure','Used internally; Active Directory uses LDAP; LDAP queries find users and their attributes'],
          ['SAML (Security Assertion Markup Language)','Enterprise SSO for web applications ‚Äî passes authentication assertions between IdP and SP','XML-based; used for enterprise SSO; exam favorite for web app federation'],
          ['OAuth 2.0','Authorization framework ‚Äî "this app can access X on your behalf"','NOT authentication by itself ‚Äî authorization only; grants limited access to resources'],
          ['OIDC (OpenID Connect)','Authentication layer built on top of OAuth 2.0','Used for "Sign in with Google/Facebook"; adds identity to OAuth; modern consumer SSO'],
        ]}
      ]
    },
    { type:'section', title:'Access Control Models', icon:'üîë', bg:'#7c5cfc',
      items:[
        { type:'table', headers:['Model','How Access is Determined','Used In'], rows:[
          ['MAC (Mandatory)','System enforces security labels ‚Äî users cannot change their own access levels','Military/government classified systems with clearance levels'],
          ['DAC (Discretionary)','Resource owners decide who gets access ‚Äî can delegate permissions','File system permissions; sharing a document with specific people'],
          ['RBAC (Role-Based)','Access based on job role ‚Äî "Nurse" role grants access to patient records','Enterprise systems; most common model in business'],
          ['Rule-Based','Access based on rules/conditions ‚Äî time of day, location, device type','Firewalls, network access control, conditional access policies'],
          ['ABAC (Attribute-Based)','Access based on attributes of user, resource, and environment','Fine-grained access; cloud IAM policies; context-aware access'],
        ]}
      ]
    },
  ],
  quiz: [
    { q:'When an employee is terminated, which IAM process is MOST time-critical to perform on the same day?', choices:['Attestation review','Identity proofing','De-provisioning (account revocation)','Role assignment audit'], answer:2, explain:'<strong>De-provisioning</strong> ‚Äî disabling all accounts immediately on termination ‚Äî is the most time-critical IAM process. A disgruntled former employee with active credentials can cause significant damage. Best practice: security team is notified simultaneously with HR, and accounts are disabled before or as the employee is informed of termination.' },
    { q:'A user clicks "Sign in with Google" on a third-party SaaS application. Google verifies the user and passes a token to the SaaS app confirming authentication. Which protocol is handling this?', choices:['LDAP','SAML','RADIUS','OAuth 2.0 with OpenID Connect (OIDC)'], answer:3, explain:'"Sign in with Google" uses <strong>OAuth 2.0 + OIDC</strong>. OAuth 2.0 handles authorization (permission to access resources); OIDC adds the identity/authentication layer on top (who is this person). SAML is typically used in enterprise B2B federation, not consumer "Sign in with..." flows.' },
    { q:'A hospital implements a system where nursing staff automatically receive access to patient records in their assigned unit based on their job title and department. Doctors receive access to different systems based on their specialty. What access control model is this?', choices:['MAC','DAC','RBAC','ABAC'], answer:2, explain:'<strong>RBAC (Role-Based Access Control)</strong> grants access based on job role ‚Äî nurses get nurse permissions, doctors get doctor permissions. Access is determined by the role assignment, not by individual identity decisions (DAC) or system-enforced labels (MAC).' },
  ]
},

'mfa-passwords': {
  title: 'MFA, Passwords & Privileged Access Management',
  subtitle: 'Authentication factors, passwordless, PAM tools, just-in-time permissions',
  domain: 4, domainName: '4.0 Security Operations',
  content: [
    { type:'analogy', label:'üîê A password alone is like a single lock on a treasure chest', text:'One lock can be picked. Add a fingerprint scanner AND a time-locked mechanism ‚Äî now all three must be defeated simultaneously. MFA does this for authentication: even if your password is stolen, the attacker still can\'t get in without your second factor.' },
    { type:'section', title:'MFA Deep Dive', icon:'üîë', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Factor Type','Examples','Strength / Weakness'], rows:[
          ['Something You Know','Password, PIN, security question','Weakest ‚Äî can be stolen, guessed, phished'],
          ['Something You Have','Hardware token (YubiKey), TOTP app (Google Authenticator), smart card, SMS code','Medium-Strong ‚Äî can be lost or stolen; SMS vulnerable to SIM swapping'],
          ['Something You Are','Fingerprint, facial recognition, iris scan, voice recognition','Strong ‚Äî difficult to replicate; but biometrics can\'t be changed if compromised'],
          ['Somewhere You Are','Geolocation, IP address restriction','Supplemental ‚Äî used in conjunction with other factors, not standalone'],
        ]},
        { type:'tip', label:'üéØ SMS vs. Authenticator App vs. Hardware Token', text:'<strong>SMS codes</strong>: weakest MFA ‚Äî vulnerable to SIM swapping (attacker transfers your number to their SIM). <strong>Authenticator app (TOTP)</strong>: much better ‚Äî codes generated locally on device, no network dependency. <strong>Hardware token (FIDO2/WebAuthn)</strong>: strongest ‚Äî phishing-resistant, physical possession required, cryptographic proof.' },
      ]
    },
    { type:'section', title:'Password Best Practices (NIST SP 800-63B)', icon:'üîí', bg:'#22d06b',
      items:[
        { type:'table', headers:['Practice','Current NIST Guidance'], rows:[
          ['Length','Minimum 8 characters; encourage long passphrases ‚Äî length matters more than complexity'],
          ['Complexity Requirements','Don\'t force special characters/numbers/uppercase ‚Äî they lead to predictable patterns like "Password1!"'],
          ['Expiration','Do NOT require periodic rotation UNLESS there\'s evidence of compromise ‚Äî forced rotation leads to weak incremental passwords'],
          ['Password Reuse','Prevent reuse of last N passwords; check against known-breached password databases (Have I Been Pwned)'],
          ['Password Managers','Strongly recommended ‚Äî enables unique, long, random passwords for every site without memorization'],
          ['Passwordless','The future: biometric + device-based authentication replacing passwords entirely ‚Äî FIDO2/WebAuthn'],
        ]}
      ]
    },
    { type:'section', title:'Privileged Access Management (PAM)', icon:'üëë', bg:'#ff7b39',
      items:[
        { type:'definition', label:'What PAM Does', text:'Specialized systems managing, monitoring, and controlling privileged (admin) accounts. Privileged accounts are the keys to the kingdom ‚Äî PAM ensures they\'re used appropriately, access is logged, and sessions are recorded for audit.' },
        { type:'definition', label:'Just-in-Time (JIT) Permissions', text:'Privileged access is granted ONLY when needed and automatically revoked after the task is complete or a time limit expires. Admins don\'t have standing admin rights ‚Äî they request them, get approved, do the work, and access expires. Eliminates persistent privileged sessions that attackers target.' },
        { type:'definition', label:'Password Vaulting', text:'Privileged account passwords are stored in a secure vault, rotated automatically by the PAM system, and checked out for use. The admin may not even see the actual password ‚Äî they access the system through the vault, which logs the entire session. Prevents password sharing and ensures accountability.' },
        { type:'definition', label:'Ephemeral Credentials', text:'Temporary credentials that exist for a short time and are automatically destroyed. One-time passwords, short-lived certificates, temporary cloud IAM credentials. Even if stolen, they expire before the attacker can use them effectively.' },
      ]
    },
  ],
  quiz: [
    { q:'An attacker social-engineers a mobile carrier into transferring a victim\'s phone number to a new SIM card controlled by the attacker. The attacker can now receive all SMS messages including MFA codes. What attack defeated SMS-based MFA?', choices:['SIM jacking / SIM swapping','Phishing for OTP codes','Credential stuffing','Man-in-the-middle'], answer:0, explain:'<strong>SIM swapping (SIM jacking)</strong> is when an attacker convinces a mobile carrier to transfer a victim\'s phone number to an attacker-controlled SIM. This allows them to receive all SMS messages ‚Äî including MFA codes. This is why hardware tokens and TOTP apps are superior to SMS for MFA.' },
    { q:'A company implements a PAM system where database administrators must request access to production databases, receive a time-limited token that expires in 2 hours, and all session activity is recorded. What PAM feature is the time-limited token?', choices:['Password vaulting','Ephemeral credentials / Just-in-time permissions','Privileged session management','Mandatory access control'], answer:1, explain:'Time-limited access that automatically expires describes <strong>Just-in-Time (JIT) permissions</strong> with <strong>ephemeral credentials</strong>. The admin gets access only when needed, only for as long as needed, and the credentials automatically expire. This eliminates standing privileged access which is a major attack target.' },
  ]
},

'automation-soar': {
  title: 'Automation, Orchestration & SOAR',
  subtitle: 'Security automation that makes your team faster than any attacker',
  domain: 4, domainName: '4.0 Security Operations',
  content: [
    { type:'analogy', label:'ü§ñ Automation is like a well-trained response team', text:'When a fire alarm goes off, the sprinkler system activates automatically ‚Äî it doesn\'t wait for someone to push a button. Security automation does the same: when a phishing email is detected, it automatically quarantines it, blocks the domain, and creates a ticket ‚Äî in seconds, not minutes.' },
    { type:'section', title:'SOAR ‚Äî Security Orchestration, Automation & Response', icon:'‚öôÔ∏è', bg:'#7c5cfc',
      items:[
        { type:'definition', label:'What SOAR Platforms Do', text:'SOAR orchestrates security tools and automates response workflows (playbooks). When an alert fires, the SOAR playbook automatically: collects additional context via threat intel APIs, performs triage steps, takes containment actions, creates tickets, notifies stakeholders ‚Äî all without human intervention until analyst review is needed.' },
        { type:'table', headers:['Automation Use Case','What Gets Automated'], rows:[
          ['User Provisioning','New employee ‚Üí auto-create AD account, assign to groups, provision email, send welcome email with credentials'],
          ['Resource Provisioning','New server request ‚Üí auto-provision cloud instance, apply security baseline, enroll in monitoring, configure backups'],
          ['Incident Response','SIEM alert ‚Üí SOAR queries threat intel, checks if IP is known-bad, quarantines host if confirmed malicious, creates priority ticket'],
          ['Security Group Management','New department ‚Üí auto-create appropriate security groups, assign permissions based on role templates'],
          ['Ticket Creation & Escalation','Alert threshold exceeded ‚Üí auto-create ticket, page on-call if SLA breach imminent'],
          ['Continuous Integration Security','Code commit ‚Üí auto-run SAST security scan, fail pipeline and notify developer if critical vulnerabilities found'],
        ]}
      ]
    },
    { type:'section', title:'Benefits & Considerations', icon:'‚öñÔ∏è', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Benefits','Considerations/Risks'], rows:[
          ['Efficiency ‚Äî analysts focus on decisions, not repetitive tasks','Complexity ‚Äî automation can be harder to troubleshoot than manual processes'],
          ['Enforcing Baselines ‚Äî automated config enforcement catches drift instantly','Cost ‚Äî SOAR platforms and integration work are expensive'],
          ['Reaction Time ‚Äî response in seconds vs. hours for known threat patterns','Single Point of Failure ‚Äî if automation fails, manual processes may not be documented'],
          ['Workforce Multiplier ‚Äî small team can handle large scale with automation','Technical Debt ‚Äî automations must be maintained as environment changes'],
          ['Consistency ‚Äî automation doesn\'t forget steps or get fatigued','Supportability ‚Äî who maintains playbooks when the expert leaves?'],
        ]}
      ]
    },
    { type:'tip', label:'üéØ APIs ‚Äî The Glue of Automation', text:'Automation works by connecting different security tools via <strong>APIs (Application Programming Interfaces)</strong>. The SIEM calls the threat intel API for reputation data, the SOAR calls the firewall API to add a block rule, calls the ticketing API to create a ticket. APIs make orchestration across different vendor products possible.' },
  ],
  quiz: [
    { q:'A SOAR platform is configured so that when the SIEM detects more than 5 failed logins from the same IP in 60 seconds, it automatically blocks that IP at the firewall, disables the targeted account temporarily, and creates a high-priority incident ticket. What is this automated workflow called?', choices:['A SIEM correlation rule','A SOAR playbook','An IPS signature','A vulnerability scan policy'], answer:1, explain:'This is a <strong>SOAR playbook</strong> ‚Äî an automated response workflow that orchestrates multiple security tools (SIEM detection ‚Üí firewall block ‚Üí account disable ‚Üí ticket creation) in response to a security event. Playbooks define the automated response steps for different incident types.' },
    { q:'A security team implements automation for their alert triage process. A junior analyst points out that the automation sometimes incorrectly blocks legitimate user activity. What is the MOST important consideration when deploying security automation?', choices:['Automation should be trusted completely once deployed','False positives in automation have greater business impact than in manual processes ‚Äî careful tuning is critical','Automation cannot produce false positives by definition','Manual processes should be eliminated entirely once automation is running'], answer:1, explain:'Automation amplifies both correct actions and mistakes. A <strong>false positive in an automated block</strong> immediately impacts legitimate users ‚Äî unlike an IDS false positive that just creates an alert for analyst review. Automation requires careful tuning, testing, and maintained manual override capabilities. Over-automation without human oversight creates operational risk.' },
  ]
},

'digital-forensics': {
  title: 'Digital Forensics',
  subtitle: 'Legal hold, chain of custody, acquisition, e-discovery ‚Äî collecting and preserving evidence',
  domain: 4, domainName: '4.0 Security Operations',
  content: [
    { type:'analogy', label:'üîç Digital forensics is crime scene investigation for computers', text:'Every detective show gets this right: don\'t touch anything, photograph everything before moving it, document who had custody of every piece of evidence, and ensure the chain of custody is unbroken. Digital forensics follows the same principles ‚Äî except the "crime scene" is a hard drive or RAM.' },
    { type:'section', title:'The Forensic Process', icon:'üî¨', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Step','What It Means','Why It Matters'], rows:[
          ['Legal Hold','Immediately preserve all potentially relevant data ‚Äî stop deletion, stop log rotation, freeze retention policies','Failure to preserve evidence after litigation notice = spoliation ‚Äî can result in severe legal sanctions'],
          ['Identification','Determine what systems, devices, and data are relevant to the incident or investigation','Scope the investigation before collecting ‚Äî collect too little = gaps; too much = unmanageable data volume'],
          ['Collection / Acquisition','Create forensically sound copies of evidence before any analysis','Never work on originals ‚Äî always work from forensic images; document hash values at collection time'],
          ['Preservation','Maintain integrity of evidence ‚Äî proper storage, write blockers for drives, tamper-evident packaging','Any modification to evidence destroys its legal admissibility in court'],
          ['Analysis','Examine collected evidence for artifacts, timelines, attacker activities','Done on forensic copies using specialized tools (Autopsy, FTK, EnCase, Volatility for memory)'],
          ['Reporting','Formal documentation of findings, methodology, and conclusions','Must withstand legal scrutiny; explain technical findings to non-technical audience (jury)'],
          ['E-Discovery','Electronically stored information provided in legal proceedings','Specific formats required, metadata preservation, privileged material review'],
        ]}
      ]
    },
    { type:'section', title:'Chain of Custody', icon:'üìã', bg:'#22d06b',
      items:[
        { type:'definition', label:'What Chain of Custody Requires', text:'A documented, unbroken record of: who collected the evidence, when it was collected, how it was stored, who accessed it and when, and how it was transported. A gap in chain of custody makes evidence potentially inadmissible ‚Äî the defense can argue evidence was tampered with during the gap.' },
        { type:'definition', label:'Write Blockers', text:'Hardware or software devices that allow reading a storage device without writing anything to it. Used during forensic acquisition to ensure the original evidence is not modified in any way. Required for admissible evidence ‚Äî any write to the original could be challenged as tampering.' },
        { type:'definition', label:'Forensic Image & Hashing', text:'A bit-for-bit exact copy of a storage device ‚Äî including empty space, deleted files, and filesystem metadata. Hash values (SHA-256) are computed for both original and image immediately at acquisition time. Matching hashes prove the copy is identical and unmodified. The hash becomes the integrity proof for the entire investigation.' },
      ]
    },
    { type:'tip', label:'üéØ Order of Volatility ‚Äî Collect Volatile First', text:'Before touching ANYTHING: <strong>capture the most volatile data first</strong>. CPU registers ‚Üí RAM ‚Üí Network connections ‚Üí Running processes ‚Üí Disk ‚Üí Logs. RAM is lost when the system powers off ‚Äî if you shut down before capturing RAM, you\'ve permanently lost running processes, open network connections, and potentially encryption keys in memory.' },
  ],
  quiz: [
    { q:'A forensic investigator receives a hard drive from a compromised server. Before analyzing it, they connect it through a device that allows reading but prevents any writes to the drive. What device is this?', choices:['RAID controller','Write blocker','Chain of custody logger','Forensic workstation'], answer:1, explain:'A <strong>write blocker</strong> is a hardware (or software) device that allows reading a storage device while preventing any writes whatsoever. This ensures the original evidence is not modified during examination, preserving its forensic integrity and legal admissibility. Any write to original evidence can be challenged in court.' },
    { q:'A company receives a lawsuit notification on Monday morning. What must happen IMMEDIATELY regarding their data retention and deletion processes?', choices:['Notify all employees to preserve their emails','Implement a legal hold ‚Äî suspend all routine data deletion, log rotation, and retention policy enforcement for potentially relevant data','Contact law enforcement to handle evidence collection','Perform a complete backup of all systems'], answer:1, explain:'A <strong>legal hold</strong> must be implemented immediately when litigation is reasonably anticipated. This suspends all normal data deletion, log rotation, and retention purging for potentially relevant data. Failing to preserve evidence after notice (spoliation) can result in severe legal sanctions, including adverse inference instructions (judge tells jury to assume the destroyed evidence was harmful to your case).' },
  ]
},

'logs-data-sources': {
  title: 'Log Data & Investigation Sources',
  subtitle: 'Firewall logs, endpoint logs, metadata, packet captures ‚Äî the data sources that tell the story',
  domain: 4, domainName: '4.0 Security Operations',
  content: [
    { type:'analogy', label:'üìñ Logs are the security camera footage of your network', text:'When a crime is committed, detectives review camera footage, visitor logs, and access records. When a security incident occurs, analysts do the same ‚Äî but with firewall logs, endpoint logs, and network traffic data. The quality of your investigation depends entirely on the quality and completeness of your logs.' },
    { type:'section', title:'Critical Log Sources', icon:'üìã', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Log Source','What It Captures','Investigative Value'], rows:[
          ['Firewall Logs','Allowed/denied traffic ‚Äî source IP, destination IP, port, protocol, action, timestamp','Detecting port scans, unauthorized connection attempts, C2 communication, policy violations, lateral movement patterns'],
          ['Application Logs','Application-specific events ‚Äî logins, errors, transactions, user actions, database queries','Detecting brute force attacks, unauthorized access, application errors, data access patterns, privilege abuse'],
          ['Endpoint / OS Logs','Process creation, file access, registry changes, network connections on individual hosts','Detecting malware execution, lateral movement, persistence mechanisms, data exfiltration from compromised endpoints'],
          ['Windows Security Event Log','Event ID 4624=logon success, 4625=failed logon, 4688=process created, 4720=user created','Account usage patterns, privilege escalation attempts, policy changes, unauthorized account creation'],
          ['IDS/IPS Logs','Alert events, matched signatures, blocked connections, attack attempts','Attack detection, signature matches, blocked attack attempts, threat intelligence'],
          ['Network Flow Logs','NetFlow/IPFIX data ‚Äî source/dest IPs, ports, bytes transferred, duration (no payload content)','Lateral movement detection, C2 communication patterns, data exfiltration volume, network mapping'],
          ['DNS Query Logs','DNS queries made ‚Äî what domains were requested, when, by whom','DNS tunneling detection, C2 domain lookups, malware beacon detection, data exfiltration via DNS'],
          ['Metadata','Data about data ‚Äî file timestamps, email headers, document properties, GPS EXIF data','Timeline reconstruction, attribution, detecting anomalies without inspecting content'],
        ]}
      ]
    },
    { type:'section', title:'Investigation Data Sources', icon:'üîç', bg:'#22d06b',
      items:[
        { type:'table', headers:['Source','What It Provides'], rows:[
          ['Vulnerability Scans','Known vulnerabilities on systems ‚Äî helps explain HOW the attacker got in'],
          ['Automated Reports','SIEM-generated reports on security events, trends, compliance status, recurring patterns'],
          ['Dashboards','Visual real-time and historical representation of security data ‚Äî see patterns at a glance'],
          ['Packet Captures (PCAP)','Full network traffic content including payload ‚Äî the absolute "ground truth" for network forensics'],
        ]},
        { type:'definition', label:'Metadata ‚Äî Often More Valuable Than Content', text:'Metadata (data about data) can reveal: who created a document and when, where a photo was taken (GPS EXIF data), email routing path and all recipients (email headers), network connection timing and volume. Metadata can prove actions even when content is encrypted or deleted. Email headers show the entire routing path even if the body is encrypted.' },
      ]
    },
    { type:'tip', label:'üéØ Log Management Best Practices', text:'<strong>Centralize immediately</strong>: ship logs to SIEM in real time ‚Äî local logs can be deleted by attackers. <strong>Time synchronization</strong>: NTP is critical ‚Äî logs from different systems must have synchronized timestamps to build accurate timelines. <strong>Retention</strong>: must meet compliance (PCI DSS = 1 year, HIPAA = 6 years). Encrypted transmission and storage for sensitive logs.' },
  ],
  quiz: [
    { q:'During a breach investigation, a forensic analyst needs to determine the exact content of network packets exchanged between a compromised workstation and an external IP last Tuesday. What data source provides this?', choices:['NetFlow data','Firewall logs','Packet capture (PCAP) files','IDS alert logs'], answer:2, explain:'<strong>Packet capture (PCAP)</strong> files contain the full content of network packets including payload data. NetFlow only captures metadata (source, destination, port, byte count) without payload content. Firewall logs show allow/deny decisions. Only PCAP provides the actual packet payload ‚Äî the "ground truth" for network forensics.' },
    { q:'A security analyst investigates a potential insider threat. The suspect\'s laptop was encrypted, preventing access to files. However, email server logs show the suspect\'s account sent 47 emails with large attachments to a personal Gmail account over 3 weeks. What type of data provided this intelligence?', choices:['Packet capture payload data','Endpoint antivirus logs','Email server application logs and metadata','IDS signatures'], answer:2, explain:'<strong>Email server application logs and metadata</strong> capture email activity ‚Äî sender, recipient, timestamp, attachment size, routing path ‚Äî without necessarily containing the email content itself. This metadata tells the story of data exfiltration even without decrypting the laptop or reading the actual emails. Metadata is powerful evidence that often survives encryption and deletion.' },
  ]
},

'ir-process': {
  title: 'Incident Response: When Bad Things Happen',
  subtitle: 'The 7-phase IR lifecycle you must know for 4.8',
  domain: 4, domainName: '4.0 Security Operations',
  content: [
    { type:'analogy', label:'üöë IR is like emergency medicine', text: 'When a patient arrives: Triage (Preparation/Detection) ‚Üí Diagnose (Analysis) ‚Üí Stabilize (Containment) ‚Üí Remove the problem (Eradication) ‚Üí Treat and heal (Recovery) ‚Üí Learn what happened (Lessons Learned). Security incidents follow the same logic.' },
    { type:'section', title:'The IR Process (PDACER-L)', icon:'üîÑ', bg:'#7c5cfc',
      items:[
        { type:'table', headers:['Phase','What Happens','Key Activities'], rows:[
          ['1. Preparation','Before any incident occurs','IR plan, playbooks, team training, tools in place, contact lists'],
          ['2. Detection','Identify that an incident has occurred','SIEM alerts, IDS/IPS alerts, user reports, anomaly detection'],
          ['3. Analysis','Understand the scope and nature','Log review, forensic evidence collection, determine what was compromised'],
          ['4. Containment','Stop the damage from spreading','Isolate infected systems, block network segments, disable accounts'],
          ['5. Eradication','Remove the threat completely','Delete malware, patch vulnerability, remove attacker\'s backdoors'],
          ['6. Recovery','Restore normal operations','Restore from backups, monitor for reinfection, validate systems'],
          ['7. Lessons Learned','Document and improve','Post-incident report, what went wrong, how to improve IR process'],
        ]}
      ]
    },
    { type:'section', title:'Digital Forensics', icon:'üî¨', bg:'#4f8ef7',
      items:[
        { type:'definition', label:'Legal Hold', text:'When litigation is anticipated, all potentially relevant data must be preserved immediately. You cannot delete, modify, or destroy any evidence.' },
        { type:'definition', label:'Chain of Custody', text:'Documentation proving who had evidence, when, and that it was not tampered with. Breaks in chain of custody can make evidence inadmissible in court.' },
        { type:'definition', label:'Order of Volatility', text:'Collect evidence from most volatile to least: CPU registers/RAM ‚Üí Network state ‚Üí Running processes ‚Üí Disk ‚Üí Remote logs ‚Üí Archival media.' },
        { type:'text', text:'<strong>E-Discovery</strong>: Electronically stored information gathered for legal proceedings. Requires specific processes to ensure integrity and admissibility.' }
      ]
    },
    { type:'tip', label:'üéØ Containment vs. Eradication', text:'Containment = STOP THE SPREAD (isolate). Eradication = KILL THE THREAT (remove). You ALWAYS contain before you eradicate. Never skip straight to eradication or you risk further spread.' },
  ],
  quiz: [
    { q:'During a ransomware attack, the security team disconnects infected workstations from the network to prevent the malware from spreading to other systems. Which phase of the incident response process is this?', choices:['Eradication','Recovery','Containment','Analysis'], answer:2, explain:'Disconnecting systems to stop the spread of malware is <strong>Containment</strong>. The goal is to limit the scope of the incident ‚Äî not yet remove the threat (that\'s Eradication).' },
    { q:'After a security incident, the IR team discovers a critical vulnerability that was exploited. They apply the patch to all systems. Which IR phase is this?', choices:['Containment','Eradication','Recovery','Lessons Learned'], answer:1, explain:'Patching the vulnerability and removing the attacker\'s access is <strong>Eradication</strong> ‚Äî eliminating the root cause and any remnants of the attack.' },
    { q:'Legal counsel notifies the security team that a lawsuit may be filed regarding a data breach. The team immediately secures all logs and evidence to prevent deletion. This action is called:', choices:['Chain of custody','E-discovery','Legal hold','Evidence acquisition'], answer:2, explain:'A <strong>Legal Hold</strong> requires preserving all potentially relevant evidence when litigation is reasonably anticipated. Failure to do so can result in spoliation charges.' },
  ]
},

'risk-process': {
  title: 'Risk Management: Quantifying the Unknown',
  subtitle: 'How organizations identify, assess, and manage risk ‚Äî Domain 5.2',
  domain: 5, domainName: '5.0 Security Program Management & Oversight',
  content: [
    { type:'analogy', label:'üìä Risk is just math on uncertainty', text: 'A casino knows exactly how much it will lose on blackjack tables over a year ‚Äî not because every hand is predictable, but because they\'ve calculated the statistics. Risk management does the same for security threats.' },
    { type:'section', title:'Risk Formula Basics', icon:'üßÆ', bg:'#00e5c5',
      items:[
        { type:'definition', label:'The Core Formula', text:'<strong>Risk = Threat √ó Vulnerability √ó Impact</strong>. A threat that exploits a vulnerability causes an impact. Remove any one of these and risk drops.' },
        { type:'table', headers:['Term','Definition','Example'], rows:[
          ['Threat','Something that could cause harm','Ransomware, disgruntled employee, fire'],
          ['Vulnerability','A weakness that could be exploited','Unpatched software, weak password policy'],
          ['Likelihood','Probability the threat will occur','How often does this type of attack happen?'],
          ['Impact','The damage if the threat occurs','Financial loss, reputation damage, downtime'],
          ['Risk','Combination of likelihood √ó impact','High likelihood + high impact = critical risk'],
        ]}
      ]
    },
    { type:'section', title:'Quantitative Risk Analysis', icon:'üí∞', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Term','Formula/Definition'], rows:[
          ['Asset Value (AV)','Dollar value of the asset (e.g., server = $50,000)'],
          ['Exposure Factor (EF)','Percentage of asset lost in an incident (e.g., 40% = 0.4)'],
          ['Single Loss Expectancy (SLE)','SLE = AV √ó EF (cost of one incident)'],
          ['Annualized Rate of Occurrence (ARO)','How many times per year the incident is expected to occur'],
          ['Annualized Loss Expectancy (ALE)','ALE = SLE √ó ARO (expected annual loss)'],
        ]},
        { type:'tip', label:'üí° Example Calculation', text:'A server (AV=$100,000) could be damaged by floods (EF=40%). Floods happen every 5 years (ARO=0.2). <strong>SLE = $100K √ó 0.4 = $40,000. ALE = $40K √ó 0.2 = $8,000/year</strong>. If flood insurance costs less than $8K/year, it makes financial sense.' }
      ]
    },
    { type:'section', title:'Risk Management Strategies', icon:'üéØ', bg:'#ff7b39',
      items:[
        { type:'terms', title:'', terms:[
          { term:'Avoid', def:'Stop doing the risky activity entirely (don\'t store credit cards if you don\'t need to)' },
          { term:'Transfer', def:'Shift the financial risk to someone else (buy cyber insurance)' },
          { term:'Mitigate', def:'Reduce likelihood or impact (patch the vulnerability, add MFA)' },
          { term:'Accept', def:'Acknowledge the risk and accept the potential consequences (via exception or exemption)' }
        ]}
      ]
    },
    { type:'section', title:'Business Impact Analysis (BIA)', icon:'üìà', bg:'#22d06b',
      items:[
        { type:'terms', title:'', terms:[
          { term:'RTO', def:'Recovery Time Objective ‚Äî maximum acceptable downtime before business impact becomes critical' },
          { term:'RPO', def:'Recovery Point Objective ‚Äî maximum acceptable data loss (how far back backups can go)' },
          { term:'MTBF', def:'Mean Time Between Failures ‚Äî average time a system runs before failing (reliability)' },
          { term:'MTTR', def:'Mean Time to Repair ‚Äî average time to restore a failed system' }
        ]}
      ]
    },
  ],
  quiz: [
    { q:'A company\'s server is valued at $200,000. A flood could damage 30% of it. Floods occur approximately twice every 10 years. What is the Annualized Loss Expectancy (ALE)?', choices:['$12,000','$6,000','$60,000','$3,000'], answer:0, explain:'SLE = AV √ó EF = $200,000 √ó 0.30 = <strong>$60,000</strong>. ARO = 2/10 years = 0.2. ALE = SLE √ó ARO = $60,000 √ó 0.2 = <strong>$12,000</strong> per year.' },
    { q:'A healthcare organization decides to purchase cyber liability insurance to offset the financial impact of potential data breaches. Which risk management strategy is this?', choices:['Risk Avoidance','Risk Mitigation','Risk Transference','Risk Acceptance'], answer:2, explain:'Buying cyber insurance <strong>transfers</strong> the financial risk to the insurance company. The organization still faces the operational and reputational risk, but the financial impact is covered.' },
    { q:'An organization\'s Recovery Time Objective (RTO) is 4 hours for its email system. What does this mean?', choices:['Email backups must be no more than 4 hours old','The email system must be restored within 4 hours of failure','Email can only be down 4 times per year','The organization must detect email outages within 4 hours'], answer:1, explain:'<strong>RTO</strong> is the maximum acceptable time the system can be down. An RTO of 4 hours means the email system must be restored and operational within 4 hours of failure.' },
  ]
},

'vuln-mgmt-process': {
  title: 'Vulnerability Management: Find, Fix, Repeat',
  subtitle: 'The lifecycle for identifying and remediating security weaknesses',
  domain: 4, domainName: '4.0 Security Operations',
  content: [
    { type:'analogy', label:'üîç Think of vulnerability management like health checkups', text: 'You get regular checkups to catch problems before they become serious. Vuln management does the same for your systems ‚Äî regular scans to find weaknesses before attackers exploit them.' },
    { type:'section', title:'Vulnerability Identification Methods', icon:'üî≠', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Method','Description','When to Use'], rows:[
          ['Vulnerability Scanner','Automated tool that probes systems for known vulns (Nessus, OpenVAS)','Regular scheduled scans, new system onboarding'],
          ['Penetration Testing','Simulated attack by ethical hackers to find and exploit vulnerabilities','Annual or after major changes; goes beyond scanner findings'],
          ['Static Analysis (SAST)','Analyze source code without running it','During development, catches code-level vulns early'],
          ['Dynamic Analysis (DAST)','Test application while it\'s running (black-box testing)','Test web apps in staging/production environments'],
          ['Bug Bounty Program','Invite external researchers to find vulns for rewards','Crowdsourced testing; continuous external perspective'],
          ['OSINT','Open-source intelligence ‚Äî what can attackers find publicly about you?','Passive recon; social engineering risk assessment'],
          ['Dark Web Monitoring','Watch for company credentials or data being sold','Detect breaches early; monitor for credential exposure'],
        ]}
      ]
    },
    { type:'section', title:'Vulnerability Scoring: CVSS', icon:'üìä', bg:'#ff7b39',
      items:[
        { type:'definition', label:'CVSS ‚Äî Common Vulnerability Scoring System', text:'A standardized framework for rating the severity of vulnerabilities on a 0-10 scale. <strong>0-3.9 = Low. 4.0-6.9 = Medium. 7.0-8.9 = High. 9.0-10.0 = Critical.</strong>' },
        { type:'definition', label:'CVE ‚Äî Common Vulnerability Enumeration', text:'A standardized naming system for known vulnerabilities. Example: <strong>CVE-2021-44228</strong> is the Log4Shell vulnerability. CVE IDs let everyone refer to the same vulnerability consistently.' },
        { type:'tip', label:'üéØ CVSS Factors', text:'CVSS considers: Attack vector (how is it accessed?), Attack complexity, Privileges required, User interaction required, Impact on CIA triad.' }
      ]
    },
    { type:'section', title:'Vuln Response & Remediation', icon:'üîß', bg:'#22d06b',
      items:[
        { type:'table', headers:['Response Option','When Used'], rows:[
          ['Patching','Primary response ‚Äî apply vendor patch to fix the vulnerability'],
          ['Compensating Controls','Can\'t patch? Add extra protection around the vulnerable system'],
          ['Segmentation','Isolate vulnerable systems so attackers can\'t easily reach them'],
          ['Insurance','Transfer financial risk of exploitation'],
          ['Exception/Exemption','Formal documented acceptance that a vuln won\'t be fixed (with justification)'],
        ]}
      ]
    },
    { type:'terms', title:'Key Concepts', terms:[
      { term:'False Positive', def:'Scanner reports a vulnerability that doesn\'t actually exist ‚Äî wastes time investigating' },
      { term:'False Negative', def:'Scanner misses a real vulnerability ‚Äî more dangerous than false positive' },
      { term:'Responsible Disclosure', def:'Researcher privately notifies vendor of vulnerability before going public' },
      { term:'Exposure Factor', def:'Percentage of asset value lost if the vulnerability is exploited' },
    ]},
  ],
  quiz: [
    { q:'A vulnerability scanner reports that a server is running a vulnerable version of software, but investigation reveals the server has additional controls that make the vulnerability unexploitable in this environment. This scan result is a:', choices:['True positive','False positive','True negative','False negative'], answer:1, explain:'A <strong>false positive</strong> is when a scanner reports a vulnerability that, upon investigation, isn\'t actually exploitable or doesn\'t exist in the tested context. The vulnerability was reported, but it\'s not real in this environment.' },
    { q:'A security researcher discovers a critical zero-day in a popular web framework and privately contacts the vendor, giving them 90 days to release a patch before public disclosure. This practice is called:', choices:['Bug bounty','Penetration testing','Responsible disclosure','OSINT gathering'], answer:2, explain:'<strong>Responsible disclosure</strong> (also called coordinated disclosure) is the practice of privately notifying a vendor about a vulnerability and giving them time to fix it before going public. This balances researcher credit with user protection.' },
    { q:'A CVE is assigned a CVSS base score of 9.8. How should this be treated in your vulnerability management process?', choices:['Low priority ‚Äî schedule for next quarter\'s patch cycle','Medium priority ‚Äî address within 30 days','High priority ‚Äî address within 1-2 weeks','Critical ‚Äî immediate remediation required'], answer:3, explain:'A CVSS score of 9.8 is in the <strong>Critical range (9.0-10.0)</strong>. Critical vulnerabilities require immediate attention, often within hours to days, not weeks. They represent near-maximum exploitability and impact.' },
  ]
},

'network-attacks': {
  title: 'Network Attacks',
  subtitle: 'DDoS, DNS attacks, on-path, credential replay ‚Äî attacks targeting your network infrastructure',
  domain: 2, domainName: '2.0 Threats, Vulnerabilities, and Mitigations',
  content: [
    { type:'analogy', label:'üåä Network attacks are floods, ambushes, and wrong road signs', text:'DDoS is a flood ‚Äî overwhelming volume. On-path attacks are ambushes ‚Äî intercepting traffic mid-journey. DNS attacks are like changing road signs ‚Äî redirecting traffic to wrong destinations. Each requires a different defense strategy.' },
    { type:'section', title:'Denial of Service Attacks', icon:'üí•', bg:'#ff4d6d',
      items:[
        { type:'table', headers:['Attack Type','How It Works','Scale'], rows:[
          ['DoS','Single attacker overwhelms a target with traffic or requests','Limited ‚Äî one machine\'s bandwidth'],
          ['DDoS','Thousands of compromised machines (botnet) attack simultaneously','Massive ‚Äî can hit terabits per second'],
          ['Amplified DDoS','Attacker sends small requests to open servers spoofing victim\'s IP ‚Äî servers send large responses to victim','Amplified 100x+ with minimal attacker bandwidth'],
          ['Reflected DDoS','Attack traffic bounces off legitimate third-party servers to victim ‚Äî hides attacker origin','Hard to trace; looks like legitimate traffic'],
        ]}
      ]
    },
    { type:'section', title:'DNS Attacks', icon:'üåê', bg:'#ff7b39',
      items:[
        { type:'definition', label:'DNS Cache Poisoning', text:'Corrupting a DNS resolver\'s cache with false records. When users query for "bank.com", the poisoned DNS returns the attacker\'s IP. Users are silently redirected without knowing ‚Äî the URL in their browser still looks correct.' },
        { type:'definition', label:'DNS Hijacking', text:'Modifying DNS settings on routers or systems to point to attacker-controlled DNS servers. All DNS queries go through attacker infrastructure ‚Äî full visibility into every domain queried.' },
        { type:'definition', label:'Domain Hijacking', text:'Taking over a domain name registration by compromising the domain registrar account. Attacker then controls all DNS for that domain ‚Äî can redirect mail, web traffic, and more.' },
      ]
    },
    { type:'section', title:'On-Path & Credential Attacks', icon:'üïµÔ∏è', bg:'#4f8ef7',
      items:[
        { type:'definition', label:'On-Path Attack (Man-in-the-Middle)', text:'Attacker positions themselves between communicating parties, intercepting and potentially modifying traffic. Both sides think they\'re talking directly to each other. Achieved via ARP spoofing, rogue AP, or compromised DNS.' },
        { type:'definition', label:'Credential Replay / Pass-the-Hash', text:'Capturing authentication tokens or hashed credentials and replaying them without cracking. Pass-the-Hash works on Windows networks ‚Äî the attacker needs only the hash, not the plaintext password. Prevented by session tokens with timestamps and nonces.' },
        { type:'definition', label:'Evil Twin / Rogue Access Point', text:'Fake wireless access point mimicking a legitimate one ‚Äî users connect to the attacker\'s AP instead of the real one. All their traffic is visible to the attacker. Deauthentication attacks forcibly disconnect clients from the real AP to force reconnection to the evil twin.' },
      ]
    },
  ],
  quiz: [
    { q:'An attacker sends DNS queries to thousands of open resolvers with the victim\'s IP as the source. The resolvers send large responses to the victim, overwhelming it. This is a:', choices:['Reflected DDoS','Amplified DDoS','DNS poisoning','On-path attack'], answer:1, explain:'This is an <strong>amplified DDoS</strong>. The attacker sends small queries but DNS responses are much larger ‚Äî amplifying their effective bandwidth. Spoofing the victim\'s IP causes all those amplified responses to flood the victim, achieving massive traffic volume with minimal attacker resources.' },
    { q:'A security analyst finds that when employees try to visit the company banking portal, they\'re silently redirected to a convincing fake login page. Investigation reveals the local DNS resolver has incorrect records for the bank\'s domain. What attack occurred?', choices:['Domain hijacking','On-path attack','DNS cache poisoning','Credential replay'], answer:2, explain:'<strong>DNS cache poisoning</strong> corrupts a resolver\'s cached records with false IPs. Legitimate domain queries return the attacker\'s IP, silently redirecting users to fake sites. The browser URL still shows the legitimate domain name ‚Äî making it especially convincing.' },
    { q:'During a penetration test, a tester captures NTLMv2 hashes from network traffic and uses them to authenticate to other systems without ever cracking the passwords. What technique is this?', choices:['Credential replay / Pass-the-Hash','Brute force','Rainbow table attack','Kerberoasting'], answer:0, explain:'<strong>Pass-the-Hash</strong> is a credential replay attack ‚Äî captured password hashes are used directly for Windows NTLM authentication without needing the plaintext. NTLM accepts the hash directly, making this attack highly effective on Windows networks.' },
  ]
},

'indicators': {
  title: 'Indicators of Malicious Activity',
  subtitle: 'Recognizing the signals that tell you you\'re under attack before it\'s too late',
  domain: 2, domainName: '2.0 Threats, Vulnerabilities, and Mitigations',
  content: [
    { type:'analogy', label:'üö® Indicators are the smoke before the fire', text:'A house fire gives off smoke before flames. A network attack gives off indicators before full compromise. Knowing what to look for ‚Äî and acting on it ‚Äî is the difference between catching an attack early and dealing with a full breach investigation months later.' },
    { type:'section', title:'Account & Access Indicators', icon:'üë§', bg:'#ff4d6d',
      items:[
        { type:'table', headers:['Indicator','What It Suggests','Example'], rows:[
          ['Account Lockout','Repeated failed logins ‚Äî possible brute force or password spraying','5 accounts locked simultaneously = spraying attack in progress'],
          ['Concurrent Session Usage','Same account logged in from multiple locations at once','One account active in New York and Tokyo simultaneously'],
          ['Impossible Travel','Login from location A, then location B within physically impossible timeframe','Login from LA at 9AM, login from London at 9:15AM'],
          ['Time-of-Day Anomaly','Access during hours inconsistent with the user\'s normal behavior','Finance system accessed at 3AM by account that normally logs in 9-5'],
        ]}
      ]
    },
    { type:'section', title:'Resource & Log Indicators', icon:'üìä', bg:'#ff7b39',
      items:[
        { type:'table', headers:['Indicator','What It Suggests'], rows:[
          ['Unexpected Resource Consumption','CPU/memory/bandwidth spike with no business explanation ‚Äî possible cryptomining, DDoS participation, or data exfiltration'],
          ['Resource Inaccessibility','Systems or files suddenly unavailable ‚Äî possible ransomware or DoS attack'],
          ['Blocked Content Alerts','Security tools blocking outbound connections ‚Äî possible malware trying to call home to C2'],
          ['Out-of-Cycle Logging','Log entries at unusual times or logs being modified ‚Äî attacker may be covering tracks'],
          ['Missing Logs','Logs that should exist are gone ‚Äî attackers commonly delete logs to erase evidence'],
          ['Data on Dark Web','Your organization\'s data appears in breach databases ‚Äî you\'ve already been compromised'],
        ]}
      ]
    },
    { type:'definition', label:'IoC ‚Äî Indicators of Compromise', text:'Evidence that a system has been compromised: malicious IP addresses, file hashes of known malware, suspicious registry keys, unusual outbound domains. IoCs are shared via threat intelligence feeds (STIX/TAXII format) so organizations can detect known threats across the industry.' },
    { type:'tip', label:'üéØ Correlate ‚Äî Don\'t Investigate in Isolation', text:'One locked account = probably a forgotten password. Five accounts locked in 30 seconds + impossible travel on one + outbound traffic to a suspicious IP = <strong>active attack</strong>. SIEM correlation rules chain these indicators together to reveal attacks that individual events would miss.' },
  ],
  quiz: [
    { q:'A security analyst notices an employee\'s account authenticated successfully from Chicago at 8:00 AM, then from Singapore at 8:47 AM. What type of indicator is this?', choices:['Account lockout','Resource consumption anomaly','Impossible travel','Concurrent session usage'], answer:2, explain:'<strong>Impossible travel</strong> ‚Äî it\'s physically impossible to travel from Chicago to Singapore in 47 minutes. This strongly indicates stolen credentials being used by a threat actor in a different location. Immediate response: force password reset, enable MFA, investigate the account\'s recent activity.' },
    { q:'During a routine log review, an analyst notices that security logs from last Tuesday are completely missing, even though the logging system shows it was running all day. What does this most likely indicate?', choices:['A logging system misconfiguration','An attacker covering their tracks by deleting logs','Normal log rotation behavior','A storage capacity issue'], answer:1, explain:'<strong>Missing logs</strong> that should exist are a strong indicator of malicious activity. Attackers commonly delete logs to remove evidence of their intrusion. This is why logs should be shipped to a centralized, write-protected SIEM in real time ‚Äî local log deletion doesn\'t erase the evidence.' },
    { q:'A company receives a notification from a threat intelligence service that employee email addresses and password hashes from their domain are being sold on a dark web forum. What does this indicate?', choices:['An attempted but unsuccessful attack','A phishing simulation result','A confirmed breach has already occurred','An insider threat report'], answer:2, explain:'Credentials appearing on the dark web means a <strong>breach has already occurred</strong> ‚Äî data was exfiltrated and is being monetized. Immediate response: force password resets for all affected accounts, enable MFA, investigate the breach source and timeline.' },
  ]
},

'mitigation-basics': {
  title: 'Mitigation Techniques: Securing the Enterprise',
  subtitle: 'Segmentation, access control, patching, least privilege ‚Äî the core defensive toolkit',
  domain: 2, domainName: '2.0 Threats, Vulnerabilities, and Mitigations',
  content: [
    { type:'analogy', label:'üè¶ Defense is about layers and zones', text:'A bank doesn\'t just lock the front door. It has zones ‚Äî public lobby, teller area, manager offices, vault. Each zone requires higher clearance. If someone gets past the lobby, they hit the next locked door. That\'s segmentation + access control. Apply this thinking to your network.' },
    { type:'section', title:'Network Segmentation', icon:'üèóÔ∏è', bg:'#4f8ef7',
      items:[
        { type:'definition', label:'Segmentation', text:'Dividing a network into separate zones so compromise of one doesn\'t automatically give access to everything else. Ransomware in the finance VLAN shouldn\'t be able to reach HR or production servers.' },
        { type:'table', headers:['Method','How It Works'], rows:[
          ['VLANs','Logical separation at Layer 2 ‚Äî different VLANs can\'t communicate without a router/firewall'],
          ['DMZ (Screened Subnet)','Isolated zone for public-facing servers ‚Äî sits between internet and internal network'],
          ['Air Gap','Physical separation with no network connection ‚Äî used for most sensitive systems'],
          ['Microsegmentation','Granular segmentation down to individual workloads ‚Äî each server has its own policy'],
        ]}
      ]
    },
    { type:'section', title:'Access Control & Least Privilege', icon:'üîë', bg:'#22d06b',
      items:[
        { type:'definition', label:'Least Privilege', text:'Every user, service, and application should have only the minimum access needed to do their job. A marketing employee doesn\'t need access to the customer database. A web server process shouldn\'t run as root.' },
        { type:'definition', label:'Application Allow List', text:'Only pre-approved applications can run on a system ‚Äî everything else is blocked by default. Much more secure than a deny list (which only blocks known-bad, allowing everything unknown).' },
        { type:'definition', label:'Access Control Lists (ACLs)', text:'Rules on firewalls and routers defining allowed or denied traffic. Processed top-to-bottom, first match wins. Always ends in an implicit deny all.' },
      ]
    },
    { type:'section', title:'Core Mitigation Priorities', icon:'üõ°Ô∏è', bg:'#7c5cfc',
      items:[
        { type:'table', headers:['Mitigation','Priority','Why'], rows:[
          ['Patching','Critical','Unpatched known vulnerabilities are the #1 attack vector ‚Äî patch fast'],
          ['Network Segmentation','High','Limits lateral movement ‚Äî breach stays contained'],
          ['Least Privilege','High','Reduces blast radius ‚Äî compromised account has limited reach'],
          ['Encryption','High','Stolen data is useless without the key'],
          ['Monitoring','High','You can\'t respond to what you can\'t see'],
          ['Decommissioning','Medium','Old forgotten systems are unpatched and forgotten ‚Äî remove them'],
        ]}
      ]
    },
  ],
  quiz: [
    { q:'Ransomware spreads from one workstation across the entire flat network, encrypting every server it reaches. Which mitigation would have MOST limited the damage?', choices:['Application allow listing','Network segmentation','Increased logging','Stronger passwords'], answer:1, explain:'<strong>Network segmentation</strong> limits lateral movement. With proper segmentation, ransomware on a user workstation can\'t freely reach production servers in other VLANs. Flat networks allow unrestricted east-west movement ‚Äî exactly what ransomware needs to spread.' },
    { q:'A web server compromise occurs. Investigators find the web server process ran with root privileges, giving the attacker full system access. Which security principle was violated?', choices:['Defense in depth','Separation of duties','Least privilege','Need to know'], answer:2, explain:'<strong>Least privilege</strong> requires processes run with only minimum necessary permissions. A web server only needs to read web files and listen on ports 80/443 ‚Äî never root. Running as root turns a web compromise into a full system compromise.' },
    { q:'A company maintains a list of approved applications that employees can run on company laptops. Any unlisted application is automatically blocked from executing. What is this called?', choices:['Deny list (blacklist)','Application allow list','EDR policy','Configuration enforcement'], answer:1, explain:'An <strong>application allow list</strong> (whitelist) only permits pre-approved applications to execute. This is far more secure than a deny list, which only blocks known-bad applications while allowing everything unknown ‚Äî including new malware that hasn\'t been seen before.' },
  ]
},

'hardening': {
  title: 'System Hardening Techniques',
  subtitle: 'Reducing attack surface at the system level ‚Äî from vulnerable defaults to secure baselines',
  domain: 2, domainName: '2.0 Threats, Vulnerabilities, and Mitigations',
  content: [
    { type:'analogy', label:'üè† A new house vs. a secured home', text:'A brand-new house has unlocked doors, no alarm, no cameras, and the spare key under the mat. Hardening is installing deadbolts, setting up the alarm, adding cameras, removing that spare key. Default system installs are the same ‚Äî convenient but wide open.' },
    { type:'section', title:'Core Hardening Techniques', icon:'‚öôÔ∏è', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Technique','What You Do','Why It Matters'], rows:[
          ['Change Default Passwords','Replace all manufacturer default credentials immediately','Default creds are publicly known ‚Äî attackers scan for them constantly'],
          ['Disable Unused Services','Turn off services and roles not needed for the system\'s function','Every running service is an attack surface; minimize the footprint'],
          ['Close Unused Ports','Block ports not required ‚Äî only open what\'s necessary','Every open port is a potential entry point'],
          ['Remove Unnecessary Software','Uninstall applications not required for the system\'s role','Less software = fewer vulnerabilities to patch and exploit'],
          ['Host-Based Firewall','Enable and configure OS firewall on each system','Defense even if network firewall is bypassed'],
          ['Endpoint Protection (EDR)','Deploy antivirus/EDR on all endpoints','Detects and blocks malware execution and malicious behavior'],
          ['Encryption','Encrypt disk, sensitive files, network communications','Protects data even if physical access is gained'],
        ]}
      ]
    },
    { type:'section', title:'Hardening by Device Type', icon:'üéØ', bg:'#ff7b39',
      items:[
        { type:'table', headers:['Target','Key Hardening Steps'], rows:[
          ['Workstations','Full-disk encryption, EDR, no local admin rights, screen lock, patch management, disable USB boot'],
          ['Servers','Disable unnecessary roles/services, remove GUI if unneeded, host firewall, enable logging'],
          ['Routers/Switches','Change defaults, disable Telnet ‚Üí use SSH, disable unused interfaces, enable port security'],
          ['Cloud Infrastructure','Disable public access by default, IAM least privilege, MFA for all accounts, enable logging'],
          ['Mobile Devices','MDM enrollment, screen lock, encryption, remote wipe, disable sideloading'],
          ['IoT Devices','Change default creds, update firmware, isolate on separate VLAN, disable unused features'],
        ]}
      ]
    },
    { type:'definition', label:'Secure Baseline / CIS Benchmarks', text:'A documented minimum security configuration all systems of a given type must meet. CIS (Center for Internet Security) publishes free hardening benchmarks for Windows, Linux, macOS, network devices, and cloud environments. These are the industry standard and referenced heavily in enterprise security.' },
    { type:'tip', label:'üéØ Configuration Drift', text:'Systems that start secure become insecure over time ‚Äî patches skipped, settings changed for convenience, new software installed. <strong>Configuration enforcement</strong> tools continuously monitor systems against their baseline and correct or alert on drift. Without this, hardened systems gradually become vulnerable again.' },
  ],
  quiz: [
    { q:'A newly deployed Windows server has FTP, Telnet, and several other default services running that are not needed for its role as a web server. What hardening step should be performed first?', choices:['Install a host-based IPS','Disable unused services and close unnecessary ports','Enable full-disk encryption','Install antivirus software'], answer:1, explain:'<strong>Disabling unnecessary services and closing unused ports</strong> is the most impactful first hardening step ‚Äî it eliminates attack surface immediately. Services like Telnet transmit in plaintext and FTP is unnecessary for a web server. Remove what you don\'t need before adding protective controls.' },
    { q:'An organization applies a standardized minimum security configuration to all new laptops before distributing them, including disk encryption, screen lock, required antivirus, and disabled USB boot. What is this practice called?', choices:['Patch management','Security baseline deployment','Vulnerability assessment','Change management'], answer:1, explain:'This is <strong>security baseline deployment</strong> ‚Äî applying a standardized minimum security configuration to systems before they enter production. CIS Benchmarks are the most widely used industry-standard baselines for different operating systems and device types.' },
    { q:'A security team discovers that several previously hardened servers have had their host-based firewalls disabled and non-standard software installed over time. What security concept addresses this problem?', choices:['Vulnerability scanning','Configuration drift monitoring / enforcement','Incident response','Patch management'], answer:1, explain:'<strong>Configuration drift</strong> occurs when systems change from their approved secure baseline over time. <strong>Configuration enforcement</strong> tools (like SCAP scanners, Desired State Configuration, or Ansible) continuously monitor for drift and either alert or automatically remediate deviations.' },
  ]
},

'crypto-pki': {
  title: 'PKI and Encryption Fundamentals',
  subtitle: 'How cryptography secures data and proves identity ‚Äî 1.4',
  domain: 1, domainName: '1.0 General Security Concepts',
  content: [
    { type:'analogy', label:'üìÆ Asymmetric encryption = a special mailbox', text: 'Imagine a mailbox with a PUBLIC slot anyone can drop a letter into, but only YOU have the PRIVATE key to open the box and read the letters. Anyone can encrypt to you (using your public key). Only you can decrypt (using your private key).' },
    { type:'section', title:'Symmetric vs. Asymmetric Encryption', icon:'üîë', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Type','How it works','Speed','Key Count','Best For'], rows:[
          ['Symmetric','Same key encrypts AND decrypts','Very Fast','1 shared key','Encrypting large amounts of data (files, disk, database)'],
          ['Asymmetric','Public key encrypts; Private key decrypts','Slower','2 keys (public+private)','Key exchange, digital signatures, SSL/TLS handshakes'],
        ]},
        { type:'text', text:'In practice, most systems use <strong>BOTH</strong>: asymmetric encryption to securely exchange a symmetric key, then symmetric encryption for the actual data. This gives you the security of asymmetric with the speed of symmetric.' },
        { type:'definition', label:'Key Exchange', text:'The process of securely sharing a symmetric key between parties. <strong>Diffie-Hellman (DH)</strong> allows two parties to create a shared secret over an insecure channel without ever transmitting the key itself.' }
      ]
    },
    { type:'section', title:'PKI (Public Key Infrastructure)', icon:'üèõÔ∏è', bg:'#22d06b',
      items:[
        { type:'text', text:'PKI is the system that manages digital certificates and trust. It\'s why your browser trusts that amazon.com is actually Amazon, not an imposter.' },
        { type:'table', headers:['Component','Role'], rows:[
          ['Certificate Authority (CA)','Trusted entity that issues and signs digital certificates. Like the DMV issuing driver\'s licenses.'],
          ['Digital Certificate','Binds a public key to an identity. Contains: owner name, public key, CA signature, validity period.'],
          ['Certificate Signing Request (CSR)','Request sent to a CA asking for a certificate. Contains your public key and identity info.'],
          ['Root of Trust','The top-level CA that all certificates ultimately chain up to. Trusted by operating systems/browsers.'],
          ['CRL (Certificate Revocation List)','List of certificates that have been revoked before expiration. Checked to validate certs.'],
          ['OCSP','Online Certificate Status Protocol ‚Äî real-time certificate validity check (faster than CRL).'],
        ]}
      ]
    },
    { type:'section', title:'Hashing & Digital Signatures', icon:'üñäÔ∏è', bg:'#ff7b39',
      items:[
        { type:'definition', label:'Hashing', text:'A one-way function that produces a fixed-length output (hash/digest) from any input. Same input always produces same hash. <strong>Cannot be reversed.</strong> Common algorithms: MD5 (broken, legacy), SHA-256, SHA-3.' },
        { type:'definition', label:'Salting', text:'Adding a random value to a password BEFORE hashing it. Prevents rainbow table attacks. Two users with the same password will have different hashes because their salts differ.' },
        { type:'definition', label:'Digital Signature', text:'Created with sender\'s PRIVATE key. Verified with sender\'s PUBLIC key. Proves: (1) who sent it, (2) data wasn\'t modified. Provides non-repudiation.' },
        { type:'tip', label:'üéØ Signature vs. Encryption Direction', text:'<strong>Encryption for confidentiality:</strong> encrypt with recipient\'s PUBLIC key ‚Üí only they can decrypt with their PRIVATE key. <strong>Digital signature:</strong> sign with YOUR PRIVATE key ‚Üí anyone can verify with YOUR PUBLIC key.' }
      ]
    },
    { type:'terms', title:'Exam-Critical Terms', terms:[
      { term:'TPM', def:'Trusted Platform Module ‚Äî hardware chip that stores crypto keys; used for disk encryption (BitLocker)' },
      { term:'HSM', def:'Hardware Security Module ‚Äî dedicated hardware for high-security crypto operations (enterprise/CA use)' },
      { term:'Key Escrow', def:'A copy of encryption keys stored with a trusted third party (law enforcement access, recovery)' },
      { term:'Wildcard Cert', def:'Certificate valid for a domain and ALL its subdomains (*.example.com)' },
      { term:'Self-Signed Cert', def:'Certificate signed by yourself, not a CA. Browsers will warn users. OK for internal use.' },
      { term:'Key Stretching', def:'Making a weak password harder to crack by running it through expensive hash functions many times (bcrypt, PBKDF2)' },
    ]},
  ],
  quiz: [
    { q:'A company wants to encrypt data being transmitted over the internet efficiently. They use TLS, which establishes an encrypted channel. TLS uses asymmetric encryption for the initial handshake to securely exchange a symmetric key, then switches to symmetric for the actual data transfer. Why?', choices:['Asymmetric is more secure for data in transit','Symmetric encryption is faster and better for bulk data encryption','Symmetric is more secure, asymmetric is faster','Asymmetric uses a single key which is simpler to manage'], answer:1, explain:'<strong>Symmetric encryption is significantly faster</strong> than asymmetric and is ideal for bulk data. Asymmetric encryption is used for the key exchange because you can do it securely without pre-sharing a secret ‚Äî then the fast symmetric cipher takes over for actual data.' },
    { q:'A user receives a digitally signed email. To verify the signature, the user needs which key?', choices:['The sender\'s private key','The receiver\'s public key','The receiver\'s private key','The sender\'s public key'], answer:3, explain:'Digital signatures are created with the <strong>sender\'s private key</strong> and verified with the <strong>sender\'s public key</strong>. Anyone with the sender\'s public key can verify the signature, which is why public keys can be... public.' },
    { q:'Which of the following BEST prevents rainbow table attacks against hashed passwords?', choices:['Using SHA-256 instead of MD5','Salting the passwords before hashing','Encrypting the hash database','Using a longer password policy'], answer:1, explain:'<strong>Salting</strong> adds a unique random value to each password before hashing. This means even if two users have the same password, they have different hashes, and pre-computed rainbow tables become useless because attackers would need a different table for every possible salt value.' },
  ]
},

'social-engineering': {
  title: 'Social Engineering: Hacking Humans',
  subtitle: 'The psychological attacks that bypass all your technical controls',
  domain: 2, domainName: '2.0 Threats, Vulnerabilities, and Mitigations',
  content: [
    { type:'analogy', label:'üé≠ You can\'t patch human nature', text: 'A company can spend millions on firewalls and still get breached because an employee clicked a fake email. Social engineering attacks humans ‚Äî the weakest link. Understanding these attacks is essential for both passing the exam AND real-world security.' },
    { type:'section', title:'Phishing Family (Message-Based)', icon:'üé£', bg:'#ff4d6d',
      items:[
        { type:'table', headers:['Attack','Description','Channel'], rows:[
          ['Phishing','Fraudulent emails impersonating legitimate sources to steal credentials/install malware','Email'],
          ['Spear Phishing','Targeted phishing using personalized info about the victim (LinkedIn research)','Email (targeted)'],
          ['Whaling','Spear phishing targeting executives (CEOs, CFOs) ‚Äî high-value targets','Email (executive)'],
          ['Vishing','Voice phishing ‚Äî attacker calls pretending to be IT support, bank, IRS, etc.','Phone/VoIP'],
          ['Smishing','SMS phishing ‚Äî malicious text messages with links or urgent requests','Text/SMS'],
          ['Business Email Compromise','Attacker impersonates an executive via email to authorize fraudulent wire transfers','Email (impersonation)'],
        ]}
      ]
    },
    { type:'section', title:'Other Social Engineering Techniques', icon:'üé™', bg:'#ff7b39',
      items:[
        { type:'table', headers:['Technique','How it Works'], rows:[
          ['Pretexting','Creating a fabricated scenario (pretext) to manipulate victims into revealing info. "Hi, I\'m from IT and need your password to fix your account."'],
          ['Impersonation','Posing as someone else ‚Äî IT support, delivery person, auditor ‚Äî to gain access or info'],
          ['Watering Hole','Attacker infects a website the target ORGANIZATION is known to visit ‚Äî then waits for employees to come to them'],
          ['Typosquatting','Registering domain names with common misspellings (goggle.com, amazzon.com) to catch mistyped URLs'],
          ['Brand Impersonation','Fake websites/emails that perfectly mimic trusted brands (Chase Bank, Microsoft, etc.)'],
          ['Misinformation/Disinformation','Spreading false info to manipulate decisions; disinformation is intentional, misinformation can be unintentional'],
        ]}
      ]
    },
    { type:'tip', label:'üéØ Key Principles Attackers Exploit', text:'Social engineers leverage: <strong>Authority</strong> (I\'m from IT/the IRS), <strong>Urgency</strong> ("Your account will be deleted TODAY"), <strong>Scarcity</strong> ("Limited time offer"), <strong>Familiarity</strong> (using victim\'s name/details from social media), <strong>Fear</strong> ("Legal action will be taken").' },
  ],
  quiz: [
    { q:'An attacker registers the domain "paypa1.com" (with a number 1 instead of letter l) and creates a fake PayPal login page. Users who mistype PayPal\'s URL are directed to this fake site. This attack is called:', choices:['Brand impersonation','Watering hole','Typosquatting','Phishing'], answer:2, explain:'This is <strong>typosquatting</strong> ‚Äî registering domain names that are common misspellings or look-alikes of legitimate domains, hoping to capture users who make typing mistakes.' },
    { q:'Attackers research a target company on LinkedIn and discover that employees often visit a specific industry news website. They compromise that website and embed malware, waiting for target employees to visit. This is a:', choices:['Phishing attack','Watering hole attack','Pretexting attack','Business email compromise'], answer:1, explain:'A <strong>watering hole attack</strong> infects a website that the target organization\'s employees are known to visit ‚Äî like animals gathering at a watering hole. The attacker waits for victims to come to them.' },
    { q:'A fraudster calls an employee pretending to be from the corporate IT helpdesk, saying there\'s an urgent security incident and they need the employee\'s password to investigate. What TWO social engineering principles are being exploited?', choices:['Urgency and Familiarity','Authority and Urgency','Scarcity and Fear','Reciprocity and Trust'], answer:1, explain:'This attack uses <strong>Authority</strong> (impersonating IT helpdesk) and <strong>Urgency</strong> ("urgent security incident"). These are the two most common levers in social engineering attacks targeting employees.' },
  ]
},

'arch-cloud': {
  title: 'Cloud Architecture & Security',
  subtitle: 'IaaS/PaaS/SaaS, shared responsibility, IaC, containers, serverless ‚Äî 3.1',
  domain: 3, domainName: '3.0 Security Architecture',
  content: [
    { type:'analogy', label:'‚òÅÔ∏è The cloud is someone else\'s computer ‚Äî with rules', text:'When you rent an apartment, the landlord maintains the building structure but YOU lock your door and don\'t leave the stove on. Cloud computing works the same way ‚Äî the shared responsibility model defines exactly who secures what.' },
    { type:'section', title:'Cloud Service Models', icon:'üì¶', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Model','Provider Manages','Customer Manages','Example'], rows:[
          ['IaaS','Physical hardware, hypervisor, networking','OS, middleware, applications, data','AWS EC2, Azure VMs ‚Äî you manage everything above the hardware'],
          ['PaaS','Hardware + OS + runtime environment','Applications and data','Google App Engine ‚Äî you just deploy code'],
          ['SaaS','Everything ‚Äî hardware through application','Data governance and access management','Microsoft 365, Salesforce ‚Äî you just use it'],
        ]}
      ]
    },
    { type:'section', title:'Shared Responsibility ‚Äî The Critical Concept', icon:'ü§ù', bg:'#ff7b39',
      items:[
        { type:'definition', label:'What the Customer Always Owns', text:'Regardless of cloud model (IaaS, PaaS, or SaaS), the customer is <strong>always</strong> responsible for: data governance, user access management, and defining who can access what. The provider never controls your data classification or your IAM policies.' },
        { type:'tip', label:'üéØ Biggest Misconception', text:'"The cloud provider handles security." FALSE. The provider secures the infrastructure. You secure your configuration, your data, and your users. The #1 cause of cloud breaches is customer misconfiguration ‚Äî not provider failure.' },
      ]
    },
    { type:'section', title:'Modern Cloud Concepts', icon:'‚öôÔ∏è', bg:'#22d06b',
      items:[
        { type:'definition', label:'Infrastructure as Code (IaC)', text:'Defining and provisioning infrastructure using code files (Terraform, CloudFormation, Ansible) rather than manual configuration. Security benefit: version-controlled, auditable, reproducible. Risk: misconfigured IaC templates deploy misconfigured infrastructure at scale ‚Äî one bad template affects hundreds of resources.' },
        { type:'definition', label:'Serverless', text:'Running code without managing servers ‚Äî the provider handles all infrastructure. Security shift: no OS to patch, but application code and IAM are entirely the customer\'s responsibility. Attack surface moves to the application and identity layers.' },
        { type:'definition', label:'Containers', text:'Packaging applications with their dependencies (Docker). Containers share the host OS kernel but are isolated from each other. Security considerations: container escape, vulnerable base images, registry security, runtime monitoring.' },
        { type:'definition', label:'Microservices', text:'Breaking applications into small independent services communicating via APIs. Security concern: massive increase in internal API communication creates a large internal attack surface. Each API endpoint between services is a potential attack vector.' },
      ]
    },
    { type:'section', title:'Cloud Deployment Considerations', icon:'üåê', bg:'#7c5cfc',
      items:[
        { type:'table', headers:['Consideration','Security Implication'], rows:[
          ['Hybrid Cloud','Data flows between on-premises and cloud ‚Äî secure with VPN/Direct Connect; enforce consistent security policies both sides'],
          ['Data Sovereignty','Where data physically resides matters for GDPR, HIPAA ‚Äî ensure data stays in compliant regions'],
          ['Third-Party Vendors','Cloud marketplaces include third-party software ‚Äî vet vendors; supply chain risk applies'],
          ['Scalability','Auto-scaling spins up new instances ‚Äî security must be baked into the base image or template'],
        ]}
      ]
    },
  ],
  quiz: [
    { q:'A company uses a SaaS email provider. Under the shared responsibility model, which security control is the company ALWAYS responsible for, regardless of cloud model?', choices:['Physical data center security','Hypervisor patching','Application runtime security','User access management and data governance'], answer:3, explain:'Under shared responsibility, <strong>data governance and access management are always the customer\'s responsibility</strong> ‚Äî even in SaaS. Who has access to your company email, what data you store, how you classify it ‚Äî the SaaS provider never controls this.' },
    { q:'A security engineer defines all cloud network infrastructure ‚Äî VPCs, subnets, security groups ‚Äî in Terraform config files stored in a Git repository. What practice is this?', choices:['Containerization','Infrastructure as Code (IaC)','Serverless architecture','Virtualization'], answer:1, explain:'<strong>Infrastructure as Code (IaC)</strong> defines infrastructure in code files, enabling version control, peer review, and reproducible deployments. Security benefit: infrastructure changes go through the same review process as application code, catching misconfigurations before deployment.' },
    { q:'An organization migrates to microservices. The security team notes internal API calls increased from dozens to thousands per day. What is the PRIMARY new security concern?', choices:['Increased patch management burden','Expanded internal attack surface from API communication','Reduced availability due to service dependencies','Loss of data encryption at rest'], answer:1, explain:'Microservices dramatically expand the <strong>internal attack surface</strong> ‚Äî each API endpoint between services is a potential attack vector. Lateral movement through compromised services, insecure API authentication, and insufficient internal traffic encryption become primary concerns.' },
  ]
},

'arch-network': {
  title: 'Network Architecture & Specialized Systems',
  subtitle: 'SDN, IoT, ICS/SCADA, embedded systems, high availability concepts ‚Äî 3.2',
  domain: 3, domainName: '3.0 Security Architecture',
  content: [
    { type:'analogy', label:'üè≠ Modern networks are more than just PCs', text:'Your corporate network probably has servers, laptops, phones, printers, building access systems, HVAC controllers, factory equipment, and security cameras ‚Äî all networked. Each has different security requirements. One-size-fits-all security doesn\'t work.' },
    { type:'section', title:'Specialized Network Infrastructure', icon:'üåê', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Type','Description','Key Security Challenge'], rows:[
          ['SDN (Software-Defined Networking)','Network controlled by software/controller rather than individual device configs','Centralized controller = single point of failure and high-value target'],
          ['IoT (Internet of Things)','Connected devices: cameras, sensors, smart building systems','Often weak/no security; hard to patch; massive attack surface'],
          ['ICS/SCADA','Industrial control systems managing physical processes ‚Äî power grids, water treatment, manufacturing','Cannot be patched easily; compromise = physical consequences; often needs air gap'],
          ['RTOS (Real-Time OS)','OS with strict timing requirements for industrial/medical devices','Limited security features; long lifecycles; hard to update'],
          ['Embedded Systems','Computers built into devices ‚Äî cars, medical equipment, appliances','Fixed function; often no security update mechanism'],
          ['OT (Operational Technology)','Hardware/software controlling physical industrial equipment','Convergence with IT networks increases attack surface significantly'],
        ]}
      ]
    },
    { type:'section', title:'Network Isolation Methods', icon:'üîÄ', bg:'#22d06b',
      items:[
        { type:'definition', label:'Air Gap', text:'Complete physical network isolation ‚Äî no connection whatsoever. The most secure isolation. Used for nuclear control systems, classified government networks, some ICS/SCADA. Data moves only via physical media. Stuxnet famously crossed an air gap via infected USB drives in Iranian nuclear facilities.' },
        { type:'definition', label:'Logical Segmentation', text:'Network segments created via software (VLANs, firewalls) without physical separation. More practical than air gapping. Traffic between segments must pass through security controls ‚Äî firewalls, IPS.' },
        { type:'definition', label:'Centralized vs. Decentralized Architecture', text:'<strong>Centralized</strong>: security controlled from one point. Efficient but single point of failure. <strong>Decentralized</strong>: security distributed across systems. More resilient but harder to manage consistently. Most enterprises use a hybrid approach.' },
      ]
    },
    { type:'section', title:'Availability & Resilience Concepts', icon:'‚ö°', bg:'#7c5cfc',
      items:[
        { type:'table', headers:['Concept','Definition'], rows:[
          ['High Availability (HA)','Designing systems to minimize downtime ‚Äî redundant components, automatic failover'],
          ['Scalability','Ability to handle increased load ‚Äî security controls must scale with the system'],
          ['Resilience','Ability to recover quickly from failures or attacks'],
          ['Platform Diversity','Using different vendors/platforms so a single vendor outage doesn\'t take everything down'],
          ['Patch Availability','Whether the vendor still provides updates ‚Äî EOL = no patches = permanent vulnerability'],
        ]}
      ]
    },
  ],
  quiz: [
    { q:'A power utility\'s grid control systems are completely isolated with no internet or corporate network connection. Data transfers only via encrypted USB drives with strict access controls. What security architecture is this?', choices:['Software-defined networking','Logical segmentation','Air gap','High availability clustering'], answer:2, explain:'An <strong>air gap</strong> is complete physical network isolation ‚Äî no network connection at all. Power grids, nuclear facilities, and classified government networks use air gaps. Note: Stuxnet proved air gaps aren\'t perfect ‚Äî they can be crossed via infected removable media.' },
    { q:'A manufacturing company\'s SCADA systems control robotic assembly lines running software that cannot be updated without shutting down production for weeks. What is the BEST security approach?', choices:['Immediately patch all systems and accept the downtime','Decommission all SCADA and use manual controls','Network segmentation and compensating controls around the unpatched systems','Replace all SCADA systems immediately'], answer:2, explain:'When patching is infeasible, <strong>network segmentation plus compensating controls</strong> is correct ‚Äî isolate SCADA on its own segment, restrict all communication to only necessary systems, add enhanced monitoring, and document the compensating controls formally. This is the reality of ICS/SCADA security.' },
  ]
},

'infra-security': {
  title: 'Securing Enterprise Infrastructure',
  subtitle: 'Security zones, jump servers, proxies, load balancers, port security, failure modes ‚Äî 3.2',
  domain: 3, domainName: '3.0 Security Architecture',
  content: [
    { type:'analogy', label:'üè¢ Security zones are like a corporate building\'s access levels', text:'Lobby = public. Badge-required offices = internal. Server room = restricted. CEO suite = highly restricted. Networks have the same zones. Where you place a device determines what attacks it faces and what controls it needs.' },
    { type:'section', title:'Network Security Zones', icon:'üó∫Ô∏è', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Zone','What Lives Here','Trust Level'], rows:[
          ['Internet / Untrusted','External traffic','Zero trust ‚Äî assume hostile'],
          ['DMZ (Screened Subnet)','Web servers, email gateways, DNS, reverse proxies','Partial ‚Äî public-facing but isolated from internal'],
          ['Internal Network','Employee workstations, internal apps','Trusted ‚Äî Zero Trust challenges this assumption'],
          ['Restricted Zone','Sensitive data servers, domain controllers, HR systems','High ‚Äî strict access control required'],
          ['Management Zone','Out-of-band network for managing network devices','Separate from production ‚Äî admin access only'],
        ]}
      ]
    },
    { type:'section', title:'Key Network Appliances', icon:'üñß', bg:'#22d06b',
      items:[
        { type:'definition', label:'Jump Server (Bastion Host)', text:'A hardened server that is the ONLY authorized access point to a restricted network segment. Admins connect to the jump server first, then from there to internal systems. Creates a chokepoint for logging and controlling all privileged access. Also called a jump box.' },
        { type:'definition', label:'Proxy Server', text:'Sits between clients and the internet, making requests on their behalf. <strong>Forward proxy</strong>: internal users accessing the internet (content filtering, anonymity, SSL inspection). <strong>Reverse proxy</strong>: external users accessing internal services (hides internal architecture, load balancing).' },
        { type:'definition', label:'Load Balancer', text:'Distributes incoming traffic across multiple servers. Security functions: SSL termination, DDoS mitigation, health checking (removes compromised servers from rotation). High availability benefit: if one server fails, load balancer routes to healthy ones.' },
        { type:'definition', label:'802.1X Port Security', text:'IEEE standard for Network Access Control. Before a device uses a network port, it must authenticate via EAP to a RADIUS server. Prevents unauthorized devices from plugging in. Requires RADIUS infrastructure.' },
      ]
    },
    { type:'section', title:'Failure Modes ‚Äî Critical Exam Topic', icon:'‚ö†Ô∏è', bg:'#ff4d6d',
      items:[
        { type:'definition', label:'Fail-Open', text:'When a security device fails, it <strong>allows ALL traffic</strong>. Prioritizes <strong>availability</strong> over security. Used in environments where stopping legitimate traffic is more harmful than a security gap (some healthcare). Dangerous from a security standpoint.' },
        { type:'definition', label:'Fail-Closed (Fail-Secure)', text:'When a security device fails, it <strong>blocks ALL traffic</strong>. Prioritizes <strong>security</strong> over availability. Default for most security controls ‚Äî if the firewall crashes, nothing gets through. Causes availability impact but prevents security bypass.' },
        { type:'tip', label:'üéØ Which Fails Which Way?', text:'<strong>IDS failure</strong> = fail-open (you lose detection but traffic flows ‚Äî acceptable). <strong>Firewall/IPS failure</strong> = should fail-closed (you lose availability but stay secure). The exam will give you a scenario and ask which failure mode is appropriate.' },
      ]
    },
  ],
  quiz: [
    { q:'An organization wants all administrative access to production servers logged, monitored, and accessible only from a single hardened system. What should they implement?', choices:['A load balancer','A jump server (bastion host)','A reverse proxy','A RADIUS server'], answer:1, explain:'A <strong>jump server (bastion host)</strong> is a hardened system serving as the single authorized gateway for admin access to a restricted network. All admin sessions go through it ‚Äî providing centralized logging, session recording, and access control for all privileged operations.' },
    { q:'A critical firewall fails and is configured to allow all traffic through during the failure. What is this called, and what does it prioritize?', choices:['Fail-closed ‚Äî prioritizes security','Fail-open ‚Äî prioritizes availability','Fail-secure ‚Äî prioritizes integrity','High availability ‚Äî prioritizes resilience'], answer:1, explain:'<strong>Fail-open</strong> allows all traffic when the device fails, prioritizing <strong>availability</strong>. Business operations continue but the security control is bypassed during the failure window. Sometimes necessary in healthcare environments where blocking traffic could be life-threatening.' },
    { q:'Before a laptop can connect to the corporate network via an ethernet port, it must present valid credentials verified against a policy server. What technology enforces this?', choices:['MAC address filtering','802.1X port-based Network Access Control','Host-based firewall','ACL on the switch'], answer:1, explain:'<strong>802.1X</strong> is the IEEE standard for port-based Network Access Control. Authentication is required before granting network access through a port. It uses EAP for the authentication protocol and a RADIUS server for centralized authentication decisions.' },
  ]
},

'firewall-types': {
  title: 'Firewall Types, VPNs & Network Security',
  subtitle: 'WAF, NGFW, UTM, IPSec, TLS, SD-WAN, SASE ‚Äî the full network security toolkit',
  domain: 3, domainName: '3.0 Security Architecture',
  content: [
    { type:'analogy', label:'üö¶ Different checkpoints for different roads', text:'A traffic cop checks license plates (stateful firewall). A customs agent inspects your luggage contents (NGFW with deep packet inspection). A specialist who speaks the language of what you\'re carrying (WAF, which understands HTTP). Right tool for the right traffic.' },
    { type:'section', title:'Firewall Types', icon:'üî•', bg:'#ff4d6d',
      items:[
        { type:'table', headers:['Type','What It Inspects','Best For'], rows:[
          ['Packet Filter (Layer 3/4)','IP addresses, ports, protocols only ‚Äî fast but limited','Basic perimeter filtering; high-speed environments'],
          ['Stateful Inspection','Tracks connection state ‚Äî knows if a packet belongs to an established session','Standard enterprise perimeter ‚Äî most common firewall type'],
          ['Next-Generation Firewall (NGFW)','Deep packet inspection, application awareness, user identity, built-in IPS, SSL inspection','Modern enterprise ‚Äî understands applications, not just ports'],
          ['Web Application Firewall (WAF)','HTTP/HTTPS specifically ‚Äî blocks SQLi, XSS, CSRF, OWASP Top 10','Protecting web applications ‚Äî sits in front of web servers'],
          ['Unified Threat Management (UTM)','All-in-one: firewall + IPS + antivirus + content filter + VPN','Small/medium businesses ‚Äî convenience over raw performance'],
        ]}
      ]
    },
    { type:'section', title:'VPN & Encrypted Tunneling', icon:'üîí', bg:'#4f8ef7',
      items:[
        { type:'definition', label:'VPN (Virtual Private Network)', text:'Creates an encrypted tunnel over the public internet. <strong>Site-to-site</strong>: connects two offices permanently. <strong>Remote access</strong>: individual users connect to corporate network. <strong>Split tunnel</strong>: only corporate-destined traffic goes through VPN. <strong>Full tunnel</strong>: ALL traffic goes through VPN.' },
        { type:'definition', label:'IPSec', text:'Network-layer encryption protocol suite used in VPNs. Two modes: <strong>Transport mode</strong> ‚Äî encrypts payload only, used for host-to-host. <strong>Tunnel mode</strong> ‚Äî encrypts entire packet including headers, used in VPN gateways. Components: AH (Authentication Header) and ESP (Encapsulating Security Payload).' },
        { type:'definition', label:'TLS (Transport Layer Security)', text:'The cryptographic protocol securing most internet communication ‚Äî HTTPS, email, VoIP. TLS 1.3 is current. TLS 1.0/1.1 are deprecated and should not be used. Provides authentication (certificates), confidentiality (encryption), and integrity (MAC). SSL is broken ‚Äî never use SSL terminology as if it\'s current.' },
      ]
    },
    { type:'section', title:'Modern Network Security Architectures', icon:'üåê', bg:'#22d06b',
      items:[
        { type:'definition', label:'SD-WAN', text:'Software-Defined Wide Area Network ‚Äî manages and optimizes WAN connections across multiple internet links via software. Automatically routes traffic over best-performing links. Can include encryption and security policy enforcement.' },
        { type:'definition', label:'SASE (Secure Access Service Edge)', text:'Cloud-delivered framework combining networking (SD-WAN) and security (firewall, CASB, Zero Trust) into one cloud service. Security and connectivity delivered from the cloud edge, close to users wherever they are. The modern answer to securing a distributed workforce.' },
        { type:'tip', label:'üéØ WAF vs. NGFW', text:'A <strong>WAF</strong> understands HTTP ‚Äî it inspects the content of web requests and blocks SQLi, XSS, CSRF. A <strong>NGFW</strong> understands applications broadly ‚Äî it knows if traffic is Facebook vs. Salesforce vs. BitTorrent. For protecting a web app, WAF. For enterprise traffic control, NGFW.' },
      ]
    },
  ],
  quiz: [
    { q:'A company\'s web application is being attacked with SQL injection and XSS. Which security control BEST protects specifically against these application-layer attacks?', choices:['Next-Generation Firewall (NGFW)','Unified Threat Management (UTM)','Web Application Firewall (WAF)','Stateful inspection firewall'], answer:2, explain:'A <strong>WAF</strong> specifically understands HTTP/HTTPS and the OWASP Top 10 ‚Äî SQLi, XSS, CSRF. A standard firewall sees these as valid web traffic (correct port/protocol) and passes them through. Only the WAF inspects the actual content of web requests.' },
    { q:'A company configures IPSec VPN between two offices. The configuration encrypts the entire original IP packet (headers + payload) and wraps it in a new outer IP packet. Which IPSec mode is this?', choices:['Transport mode','Tunnel mode','AH-only mode','ESP transport mode'], answer:1, explain:'<strong>Tunnel mode</strong> encrypts the entire original IP packet and wraps it in a new outer packet ‚Äî used for VPN gateways connecting networks. Transport mode only encrypts the payload and is used for host-to-host communication within a network.' },
    { q:'An organization wants to deliver firewall, CASB, Zero Trust access, and SD-WAN as a single cloud-based service for remote employees. What architecture does this describe?', choices:['UTM appliance','VPN concentrator','SASE (Secure Access Service Edge)','DMZ architecture'], answer:2, explain:'<strong>SASE</strong> converges networking (SD-WAN) and security (firewall, CASB, Zero Trust) into a single cloud-delivered service. It\'s designed for the distributed workforce ‚Äî security is applied at the cloud edge, close to users wherever they connect from.' },
  ]
},

'secure-comms': {
  title: 'Secure Communication Protocols',
  subtitle: 'Replace insecure protocols with secure ones ‚Äî know the ports cold',
  domain: 3, domainName: '3.0 Security Architecture',
  content: [
    { type:'analogy', label:'üìÆ Protocols are like postal rules', text:'Regular mail is readable by anyone who intercepts it. A sealed registered diplomatic pouch is encrypted and authenticated. Secure protocols are the "diplomatic pouch" of network communication ‚Äî same information, completely protected.' },
    { type:'section', title:'Insecure ‚Üí Secure Protocol Replacements', icon:'üîÑ', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Insecure Protocol','Secure Replacement','What It Secures','Port Change'], rows:[
          ['HTTP','HTTPS (HTTP + TLS)','Web traffic','80 ‚Üí 443'],
          ['FTP','SFTP or FTPS','File transfer','21 ‚Üí 22 (SFTP) or 990 (FTPS)'],
          ['Telnet','SSH','Remote administration','23 ‚Üí 22'],
          ['SMTP (plain)','SMTPS / STARTTLS','Email transmission','25 ‚Üí 465 or 587'],
          ['SNMP v1/v2','SNMPv3','Network device monitoring','161 (v3 adds encryption + auth)'],
          ['LDAP','LDAPS','Directory services','389 ‚Üí 636'],
          ['RDP (no NLA)','RDP with NLA + TLS','Remote desktop','3389 (add NLA + TLS)'],
        ]}
      ]
    },
    { type:'section', title:'Remote Access Security', icon:'üîë', bg:'#22d06b',
      items:[
        { type:'definition', label:'SSH (Secure Shell)', text:'Encrypted replacement for Telnet. Provides encrypted terminal sessions, secure file transfer (SFTP/SCP), and port forwarding. Authentication via password or public key ‚Äî key-based is more secure since no password is transmitted. Port 22.' },
        { type:'definition', label:'RDP Security Best Practices', text:'Remote Desktop Protocol (port 3389) must be secured with: <strong>Network Level Authentication (NLA)</strong> ‚Äî forces authentication before full connection. <strong>TLS encryption</strong>. <strong>MFA</strong>. Exposed RDP is one of the most attacked internet-facing services ‚Äî always require VPN or jump server first.' },
      ]
    },
    { type:'tip', label:'üéØ Port Numbers to Memorize', text:'SSH=22, SMTP=25, DNS=53, HTTP=80, HTTPS=443, SMB=445, RDP=3389, LDAP=389, LDAPS=636, SNMP=161. The exam describes a service and asks what port to allow/block or what secure protocol to use. Know these cold.' },
  ],
  quiz: [
    { q:'Network administrators are using Telnet to manage routers remotely. What is the primary security risk and what should replace it?', choices:['Telnet uses too much bandwidth ‚Äî replace with SNMP','Telnet transmits credentials in plaintext ‚Äî replace with SSH','Telnet uses an insecure port ‚Äî replace with RDP','Telnet lacks logging ‚Äî replace with HTTPS'], answer:1, explain:'<strong>Telnet transmits everything in plaintext</strong> ‚Äî usernames, passwords, all commands. Anyone with network access can capture credentials with a packet sniffer. <strong>SSH</strong> (port 22) encrypts the entire session and should always replace Telnet (port 23).' },
    { q:'A firewall policy should allow encrypted web traffic while blocking unencrypted web traffic. Which ports should be allowed and blocked?', choices:['Allow 443, block 8080','Allow 80, block 443','Allow 443, block 80','Allow 8443, block 443'], answer:2, explain:'<strong>HTTPS runs on port 443</strong> (encrypted) and <strong>HTTP runs on port 80</strong> (unencrypted). To force encrypted web traffic, allow 443 and block 80. Some environments redirect port 80 to 443 rather than blocking it to provide a better user experience.' },
    { q:'A company uses LDAP for internal directory services. The security team finds user credentials are transmitted in cleartext during LDAP queries. What is the fix?', choices:['Upgrade to LDAP v3','Switch to LDAPS on port 636','Enable SNMPv3','Use SAML instead'], answer:1, explain:'<strong>LDAPS</strong> (LDAP over TLS/SSL) runs on port 636 and encrypts all directory service communication including credentials. Standard LDAP on port 389 transmits in plaintext. LDAPS is the direct secure replacement.' },
  ]
},

'data-types': {
  title: 'Data Types & Classification',
  subtitle: 'Regulated, trade secret, PII, PHI ‚Äî understanding what you have and how to protect it',
  domain: 3, domainName: '3.0 Security Architecture',
  content: [
    { type:'analogy', label:'üìÅ Not all files are equal', text:'Your grocery list and your Social Security number are both "documents" ‚Äî but they need completely different protection. Data classification assigns the appropriate security level so protection matches sensitivity. You wouldn\'t store your passport in the same drawer as a magazine.' },
    { type:'section', title:'Data Types You Must Know', icon:'üìã', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Data Type','Description','Examples','Governing Regulation'], rows:[
          ['PII','Personally Identifiable Information ‚Äî identifies a specific individual','Name+address, SSN, email, biometrics','GDPR, CCPA, state privacy laws'],
          ['PHI','Protected Health Information ‚Äî health data tied to an individual','Medical records, diagnoses, treatment history','HIPAA'],
          ['Financial Data','Payment and financial information','Credit cards, bank accounts, financial statements','PCI DSS, SOX, GLBA'],
          ['Intellectual Property','Proprietary business information with competitive value','Source code, patents, product designs, trade secrets','Trade secret law, NDAs'],
          ['Legal Information','Attorney-client communications and legal strategy','Litigation documents, legal opinions','Attorney-client privilege'],
        ]}
      ]
    },
    { type:'section', title:'Data Classification Levels', icon:'üè∑Ô∏è', bg:'#22d06b',
      items:[
        { type:'table', headers:['Level','Description','Example'], rows:[
          ['Public','Can be freely shared ‚Äî no harm from disclosure','Marketing materials, press releases'],
          ['Internal/Private','For employees only ‚Äî not catastrophic if leaked','Internal memos, org charts'],
          ['Confidential','Sensitive ‚Äî damage if disclosed ‚Äî limited to specific roles','Customer PII, business strategies, employee records'],
          ['Restricted/Critical','Most sensitive ‚Äî severe damage if disclosed','Trade secrets, encryption keys, classified government data'],
        ]}
      ]
    },
    { type:'section', title:'Data States & Sovereignty', icon:'üåç', bg:'#7c5cfc',
      items:[
        { type:'definition', label:'Data at Rest', text:'Stored data ‚Äî on hard drives, databases, backups. Protected by: encryption (FDE, database encryption), access controls, physical security.' },
        { type:'definition', label:'Data in Transit', text:'Moving across networks. Protected by: TLS, IPSec, VPN, SFTP. Never transmit sensitive data over unencrypted channels.' },
        { type:'definition', label:'Data in Use', text:'Actively being processed in RAM or CPU. Hardest to protect. Risks: memory scraping, cold boot attacks. Secure enclaves (Intel SGX, ARM TrustZone) provide hardware-level protection.' },
        { type:'definition', label:'Data Sovereignty', text:'Data is subject to the laws of the country where it physically resides. EU citizens\' data stored on a US server is subject to both GDPR and US law. Cloud providers offer region selection for compliance.' },
      ]
    },
  ],
  quiz: [
    { q:'A hospital stores patient medical records including diagnoses, medications, and treatment histories linked to patient names and insurance IDs. What type of data is this and what regulation governs it?', choices:['PII ‚Äî governed by GDPR','PHI ‚Äî governed by HIPAA','Financial data ‚Äî governed by PCI DSS','Regulated data ‚Äî governed by SOX'], answer:1, explain:'Patient medical records linked to individual identities are <strong>PHI (Protected Health Information)</strong>, governed by <strong>HIPAA</strong>. HIPAA requires specific technical (encryption, access controls), administrative (policies, training), and physical safeguards for all PHI.' },
    { q:'A company\'s proprietary trading algorithm source code is stolen by a former employee. What type of data was compromised?', choices:['Regulated data','PII','Intellectual property / Trade secret','PHI'], answer:2, explain:'Source code for a proprietary algorithm is <strong>intellectual property and a trade secret</strong>. It derives value from being kept confidential. Exposure to a competitor could destroy competitive advantage. Protected under trade secret law and NDAs.' },
    { q:'A European company uses a US-based cloud provider. The security team must ensure EU customer data never leaves European data centers. What concept drives this?', choices:['Data sovereignty','Data at rest protection','Geolocation filtering','Classification policy'], answer:0, explain:'<strong>Data sovereignty</strong> ‚Äî data is subject to the laws of the country where it physically resides. GDPR restricts transfer of EU personal data outside the EU unless specific protections are in place. Cloud region selection is the primary technical control.' },
  ]
},

'data-security': {
  title: 'Methods to Secure Data',
  subtitle: 'Encryption, masking, tokenization, DLP, segmentation ‚Äî protecting data at every layer',
  domain: 3, domainName: '3.0 Security Architecture',
  content: [
    { type:'analogy', label:'üõ°Ô∏è Multiple shields, multiple angles', text:'A medieval knight didn\'t rely on just one piece of armor. Helmet + chainmail + breastplate + shield = layered protection. Data security works the same: classify it, encrypt it, restrict access, control where it can go, and log everything.' },
    { type:'section', title:'Data Security Methods Compared', icon:'üîí', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Method','How It Works','Best For'], rows:[
          ['Encryption','Math scrambles data ‚Äî unreadable without the key. Reversible.','All sensitive data at rest and in transit'],
          ['Hashing','One-way fingerprint ‚Äî verifies integrity, can\'t reverse to original','Password storage (with salt), file integrity, digital signatures'],
          ['Masking','Replaces real data with realistic fake data. Original NOT preserved.','Dev/test environments needing realistic data without real PII'],
          ['Tokenization','Replaces sensitive data with a non-sensitive token. Original stored securely elsewhere. Reversible.','Payment processing (PCI DSS), reducing compliance scope'],
          ['Obfuscation','Makes data harder to understand without encrypting it','Code obfuscation; not a primary security control'],
          ['Segmentation','Isolates sensitive data on separate systems/networks','Limiting blast radius; restricting access to PHI or financial data servers'],
          ['Permission Restrictions','ACLs and RBAC controlling read/write/delete access','Enforce need-to-know; least privilege for data access'],
          ['Geographic Restrictions','Prevent data access from/to specific countries or regions','Compliance with data sovereignty laws (GDPR)'],
        ]}
      ]
    },
    { type:'section', title:'DLP ‚Äî Data Loss Prevention', icon:'üö´', bg:'#ff7b39',
      items:[
        { type:'definition', label:'What DLP Does', text:'Monitors, detects, and blocks unauthorized transmission of sensitive data. Can detect if someone emails a file containing 100+ Social Security numbers and automatically block it or alert the security team.' },
        { type:'table', headers:['DLP Type','Where It Operates'], rows:[
          ['Network DLP','Monitors network traffic for sensitive data in transit ‚Äî emails, uploads, web posts'],
          ['Endpoint DLP','Agent on devices ‚Äî monitors copy/paste, USB transfers, printing of sensitive data'],
          ['Cloud DLP','Monitors data stored in and transferred through cloud services'],
        ]}
      ]
    },
    { type:'tip', label:'üéØ Masking vs. Tokenization vs. Encryption', text:'<strong>Masking</strong>: fake data replaces real ‚Äî original GONE, not reversible. Good for dev environments. <strong>Tokenization</strong>: token replaces real data, original preserved in a secure vault ‚Äî reversible by authorized systems. Preferred for PCI DSS. <strong>Encryption</strong>: math scrambles data, reversible with key. All three protect data differently.' },
  ],
  quiz: [
    { q:'A development team needs realistic customer data for testing. The security team provides a database where all names, emails, and SSNs have been replaced with realistic-looking but entirely fake values. The original data is not recoverable from this database. What technique was used?', choices:['Tokenization','Encryption','Data masking','Obfuscation'], answer:2, explain:'<strong>Data masking</strong> replaces real sensitive data with realistic but fake data ‚Äî the original is NOT preserved. This is used in development and test environments that need realistic data formats without exposing real PII. Unlike tokenization, there is no vault storing the originals.' },
    { q:'An employee attempts to email a spreadsheet containing 500 customer SSNs to their personal Gmail. The system automatically detects the SSNs in the attachment and blocks the email. What technology did this?', choices:['Firewall','DLP (Data Loss Prevention)','IDS','Email gateway antivirus'], answer:1, explain:'<strong>DLP</strong> monitors for sensitive data patterns (SSNs, credit card numbers) and enforces policies to prevent unauthorized transmission. It detected the SSN pattern in the attachment and blocked the outbound email before it left the organization.' },
    { q:'A retailer processes credit cards but stores a random string instead of the actual card number. When a customer returns, the retailer uses this string to reference the original transaction. The actual card number is stored with their payment processor. What technique is this?', choices:['Encryption','Data masking','Tokenization','Hashing'], answer:2, explain:'<strong>Tokenization</strong> replaces sensitive data (card number) with a non-sensitive token (random string). The original is stored securely by the payment processor ‚Äî not the retailer. This reduces PCI DSS scope dramatically since the retailer never handles real card numbers.' },
  ]
},

'ha-bcdr': {
  title: 'High Availability, BC & DR',
  subtitle: 'Hot/warm/cold sites, clustering, RTO/RPO, business continuity planning ‚Äî 3.4',
  domain: 3, domainName: '3.0 Security Architecture',
  content: [
    { type:'analogy', label:'‚úàÔ∏è Airlines plan for everything that can go wrong', text:'Airlines have backup planes, alternate airports, detailed emergency procedures, and crew trained for every scenario. They don\'t hope the plane works ‚Äî they plan for when it doesn\'t. Your IT infrastructure needs the same level of resilience planning.' },
    { type:'section', title:'High Availability Concepts', icon:'‚ö°', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Concept','Description','Example'], rows:[
          ['Load Balancing','Distributes traffic across multiple servers ‚Äî one fails, others absorb load','Web farm: 3 servers behind a load balancer'],
          ['Clustering','Multiple servers act as one logical system ‚Äî shared storage, automatic failover','Database cluster where secondary instantly takes over if primary fails'],
          ['Redundancy','Duplicate critical components ‚Äî single failure doesn\'t cause outage','Dual power supplies, RAID disks, redundant network links'],
          ['Failover','Automatic or manual switch to backup when primary fails','DNS failover to secondary data center'],
        ]}
      ]
    },
    { type:'section', title:'Alternate Site Types', icon:'üè¢', bg:'#22d06b',
      items:[
        { type:'table', headers:['Site Type','What\'s Ready','RTO','Cost'], rows:[
          ['Hot Site','Fully operational ‚Äî hardware, software, live data replication. Ready in minutes.','Minutes to hours','Very High'],
          ['Warm Site','Hardware and software ready, but data must be loaded from backup','Hours to days','Moderate'],
          ['Cold Site','Physical space only ‚Äî power and cooling. Nothing else.','Days to weeks','Low'],
          ['Geographic Dispersion','Sites in different regions protect against regional disasters','Varies','High'],
        ]}
      ]
    },
    { type:'section', title:'BC & DR Planning', icon:'üìã', bg:'#7c5cfc',
      items:[
        { type:'definition', label:'Business Continuity Planning (BCP)', text:'How the organization maintains BUSINESS OPERATIONS during a disruption ‚Äî not just IT. Includes manual workarounds, alternate staffing, communication plans. Broader scope than DR.' },
        { type:'definition', label:'Disaster Recovery (DR)', text:'Specifically how IT SYSTEMS are restored after a major incident. Focused on technology recovery. A subset of BCP.' },
        { type:'definition', label:'Capacity Planning', text:'Ensuring you have enough people, technology, and infrastructure during disaster recovery. If your DR plan requires 50 staff at the alternate site, do you actually have 50 staff available?' },
        { type:'tip', label:'üéØ RTO vs. RPO ‚Äî Memorize These', text:'<strong>RTO (Recovery Time Objective)</strong>: maximum acceptable downtime ‚Äî how long until systems are back. Site type determines RTO (hot=minutes, cold=weeks). <strong>RPO (Recovery Point Objective)</strong>: maximum acceptable data loss ‚Äî backup frequency determines RPO (hourly backup = max 1hr RPO).' },
      ]
    },
  ],
  quiz: [
    { q:'A financial services company requires its trading platform be recoverable within 15 minutes of any failure, with no more than 5 minutes of data loss. Which combination BEST meets these requirements?', choices:['Cold site with daily backups','Warm site with hourly backups','Hot site with real-time data replication','Warm site with real-time replication'], answer:2, explain:'A 15-minute RTO requires near-instant failover ‚Äî only a <strong>hot site</strong> can achieve this. A 5-minute RPO requires near-real-time data replication. Only a hot site with continuous replication meets both requirements. Cost is high but justified for a trading platform.' },
    { q:'What is the key difference between load balancing and clustering?', choices:['Load balancing is for databases; clustering is for web servers','Load balancing distributes traffic across independent servers; clustering makes multiple servers act as one logical system with shared failover','Load balancing requires more servers','Clustering only works in cloud environments'], answer:1, explain:'<strong>Load balancing</strong> distributes traffic across independent servers for performance and basic availability. <strong>Clustering</strong> makes multiple servers act as a single logical unit with shared resources and automatic failover ‚Äî if one node fails, the cluster continues seamlessly with stronger HA guarantees.' },
    { q:'A company\'s RPO is 4 hours. What backup strategy ensures they meet this requirement?', choices:['Daily full backups','Weekly full with daily differential','Backups performed at least every 4 hours','Real-time replication only'], answer:2, explain:'<strong>RPO = maximum acceptable data loss</strong>. A 4-hour RPO means the company can afford to lose at most 4 hours of data. To guarantee this, backups must be performed at least every 4 hours. If backups run every 8 hours, a failure could mean up to 8 hours of data loss ‚Äî violating the RPO.' },
  ]
},

'backups-power': {
  title: 'Backups, Recovery & Power Resilience',
  subtitle: 'Full/incremental/differential, 3-2-1 rule, UPS, generators ‚Äî the last line of defense',
  domain: 3, domainName: '3.0 Security Architecture',
  content: [
    { type:'analogy', label:'üíæ Backups are your time machine', text:'When everything goes wrong ‚Äî ransomware, hardware failure, accidental deletion, natural disaster ‚Äî backups are what bring you back. But a backup you\'ve never tested is just hope, not a plan. And a backup stored next to the original is no backup at all.' },
    { type:'section', title:'Backup Types Compared', icon:'üíæ', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Type','What Gets Backed Up','Restore Speed','Storage Use','Restore Process'], rows:[
          ['Full','Everything ‚Äî complete copy of all data','Fastest (one set)','Largest','Restore from one full backup'],
          ['Incremental','Only changes since LAST backup (full OR incremental)','Slowest','Smallest','Full + every incremental in sequence'],
          ['Differential','Only changes since LAST FULL backup','Medium','Medium (grows over time)','Full + most recent differential only'],
          ['Snapshot','Point-in-time copy of VM or volume state using copy-on-write','Fast','Efficient for VMs','Restore single snapshot'],
        ]}
      ]
    },
    { type:'section', title:'Backup Best Practices', icon:'üìã', bg:'#22d06b',
      items:[
        { type:'definition', label:'3-2-1 Backup Rule', text:'<strong>3</strong> copies of data, on <strong>2</strong> different media types, with <strong>1</strong> copy offsite. Protects against: hardware failure (multiple copies), media failure (different types), site disaster (offsite copy). Ransomware encrypting local systems cannot reach properly maintained offsite cloud backups.' },
        { type:'definition', label:'Backup Encryption', text:'Backups must be encrypted ‚Äî they contain copies of ALL sensitive data. An unencrypted backup tape is a breach waiting to happen. Encryption ensures stolen backups are useless without the key.' },
        { type:'definition', label:'Replication vs. Backup', text:'<strong>Replication</strong>: real-time copy to secondary system ‚Äî near-zero RPO but also replicates ransomware/corruption instantly. <strong>Backup</strong>: periodic point-in-time snapshot ‚Äî can restore to a clean state from before the attack. You need BOTH.' },
        { type:'definition', label:'Testing Backups', text:'An untested backup is not a real backup. Regularly test restores ‚Äî many organizations discover their backups are corrupt or incomplete only during an actual disaster. Schedule quarterly restore tests minimum.' },
      ]
    },
    { type:'section', title:'Power Resilience', icon:'‚ö°', bg:'#ff7b39',
      items:[
        { type:'table', headers:['Solution','What It Does','Handles'], rows:[
          ['UPS (Uninterruptible Power Supply)','Battery backup ‚Äî provides instant power during outages','Short outages (minutes); bridges gap until generator starts'],
          ['Generator','Fuel-powered backup providing long-term power','Extended outages ‚Äî hours to days; needs fuel supply'],
          ['PDU (Power Distribution Unit)','Manages and distributes power to rack equipment with monitoring','Intelligent power distribution in data centers'],
        ]},
        { type:'tip', label:'üéØ UPS + Generator = Continuous Power', text:'UPS provides <strong>instant</strong> power (milliseconds) while the generator spins up (30-60 seconds). Together: UPS bridges the gap, generator sustains. Security devices (firewalls, SIEM) must be on UPS ‚Äî a power event cannot create a security gap.' },
      ]
    },
  ],
  quiz: [
    { q:'A company performs full backups every Sunday and incremental backups every weekday night. The system fails Thursday afternoon. Which backups are needed to fully restore?', choices:['Thursday\'s incremental only','Sunday\'s full + Monday, Tuesday, Wednesday incrementals','Sunday\'s full + Wednesday\'s incremental only','Sunday\'s full backup only'], answer:1, explain:'<strong>Incremental restore</strong> requires the last full backup PLUS every incremental since that full in sequence: Sunday full + Monday incremental + Tuesday incremental + Wednesday incremental. Each incremental only contains changes from the previous day, so all are needed.' },
    { q:'A company\'s primary data center loses power. UPS activates immediately but the outage may last 6+ hours. What additional solution is needed?', choices:['More UPS batteries','A diesel generator','A warm site activation','PDU failover'], answer:1, explain:'UPS systems provide short-term power (typically minutes to an hour). For extended outages of 6+ hours, a <strong>generator</strong> is required. The UPS bridges the gap while the generator starts up (30-60 seconds), then the generator provides sustained power as long as fuel is available.' },
    { q:'A company stores backups on local NAS, copies to a second NAS in the same building, and sends encrypted copies to cloud storage weekly. Does this meet the 3-2-1 rule?', choices:['Yes ‚Äî 3 copies, 2 media types, 1 offsite','No ‚Äî both local copies are on NAS (same media type), and offsite is only weekly','Yes ‚Äî cloud counts as both offsite and a different media type','No ‚Äî cloud storage is not an approved backup medium'], answer:1, explain:'This setup has issues: both local copies use the same media type (NAS), and the offsite copy is only weekly (creating a large RPO gap). A true <strong>3-2-1 setup</strong> requires 2 genuinely different media types (e.g., NAS + tape, or disk + cloud) and the offsite copy frequency must match your RPO requirements.' },
  ]
},

'siem-monitoring': {
  title: 'SIEM and Security Monitoring',
  subtitle: 'The tools and processes that detect threats in real time ‚Äî 4.4',
  domain: 4, domainName: '4.0 Security Operations',
  content: [
    { type:'analogy', label:'üéõÔ∏è A SIEM is like an air traffic control tower', text: 'Air traffic control doesn\'t fly any planes ‚Äî it aggregates info from hundreds of flights, detects problems, and coordinates responses. A SIEM does the same for security events across your entire environment.' },
    { type:'section', title:'SIEM ‚Äî Security Information and Event Management', icon:'üñ•Ô∏è', bg:'#4f8ef7',
      items:[
        { type:'definition', label:'What a SIEM does', text:'Collects logs from across the environment (firewalls, servers, endpoint agents, cloud services), <strong>correlates events</strong> to identify patterns that indicate attacks, generates <strong>alerts</strong> for security analysts, stores logs for forensic investigation and compliance.' },
        { type:'table', headers:['SIEM Capability','What it does in practice'], rows:[
          ['Log Aggregation','Pull logs from hundreds of sources into one place'],
          ['Correlation Rules','"If this event AND that event happen within X minutes ‚Äî alert" (detects multi-step attacks)'],
          ['Alert Tuning','Adjust sensitivity to reduce false positives without missing real threats'],
          ['Dashboards','Visual display of security posture in real time'],
          ['Archiving','Long-term storage for compliance (often 1-7 years required)'],
        ]}
      ]
    },
    { type:'section', title:'Key Monitoring Tools', icon:'üîß', bg:'#7c5cfc',
      items:[
        { type:'terms', title:'', terms:[
          { term:'IDS', def:'Intrusion Detection System ‚Äî passively monitors and ALERTS. Does NOT block. (Detective control)' },
          { term:'IPS', def:'Intrusion Prevention System ‚Äî actively BLOCKS malicious traffic inline. (Preventive + Corrective)' },
          { term:'NetFlow', def:'Network traffic metadata showing who talked to whom, when, how much ‚Äî not the content, just the conversation records' },
          { term:'DLP', def:'Data Loss Prevention ‚Äî monitors for sensitive data (SSNs, credit cards) being exfiltrated' },
          { term:'SNMP Traps', def:'Alerts sent by network devices (routers, switches) when something notable occurs' },
          { term:'Vulnerability Scanner', def:'Automated tool checking systems for known vulnerabilities (Nessus, OpenVAS, Qualys)' },
          { term:'EDR', def:'Endpoint Detection and Response ‚Äî advanced endpoint monitoring with behavioral analysis and response capabilities' },
          { term:'XDR', def:'Extended Detection and Response ‚Äî EDR expanded to cover network, cloud, email, identity' },
          { term:'SCAP', def:'Security Content Automation Protocol ‚Äî standardized format for automated security checking/compliance' },
        ]}
      ]
    },
    { type:'tip', label:'üéØ IDS vs. IPS Placement', text:'<strong>IDS</strong> is connected via a TAP or SPAN port ‚Äî it sees a copy of traffic but isn\'t inline. <strong>IPS</strong> is inline ‚Äî traffic passes through it. An IPS can block; an IDS can only alert. If an IPS fails, it can be configured to <strong>fail-open</strong> (allow all traffic) or <strong>fail-closed</strong> (block all traffic).' },
  ],
  quiz: [
    { q:'A security analyst receives dozens of alerts per hour about normal business traffic, making it difficult to identify real threats. What should they do?', choices:['Increase the IPS sensitivity to catch more threats','Perform alert tuning to reduce false positives','Disable the SIEM correlation rules temporarily','Switch from an IDS to an IPS'], answer:1, explain:'<strong>Alert tuning</strong> is the process of adjusting SIEM/IDS rules to reduce false positives while maintaining detection of real threats. Too many false positives cause alert fatigue, which leads to real alerts being missed.' },
    { q:'Which monitoring tool would BEST help a security team detect an employee uploading a large file containing hundreds of Social Security numbers to a personal cloud storage account?', choices:['IDS/IPS','NetFlow analyzer','Data Loss Prevention (DLP)','SNMP traps'], answer:2, explain:'<strong>DLP (Data Loss Prevention)</strong> specifically monitors for sensitive data (like SSNs, credit card numbers, PHI) being transmitted or exfiltrated. It can detect, alert, and block such transfers.' },
    { q:'A security analyst sees traffic to an unusual external IP address, but needs to know the content of the packets to determine if it\'s malicious. What tool would provide the actual packet contents?', choices:['NetFlow analyzer','SNMP monitoring','Packet capture (PCAP)','Vulnerability scanner'], answer:2, explain:'<strong>Packet capture (PCAP)</strong> captures the full content of network traffic. NetFlow only captures metadata (source, destination, port, volume) ‚Äî not the actual data. PCAP tools like Wireshark let you inspect packet payloads.' },
  ]
},

'governance-policies': {
  title: 'Security Governance & Policies',
  subtitle: 'The policies, standards, and frameworks that guide security programs ‚Äî 5.1',
  domain: 5, domainName: '5.0 Security Program Management & Oversight',
  content: [
    { type:'analogy', label:'üìú Policy is like employee law', text: 'Laws tell citizens what they can and cannot do. Policies tell employees what they can and cannot do with company systems. Without policy, there are no rules to enforce.' },
    { type:'section', title:'Policy Hierarchy', icon:'üìä', bg:'#00e5c5',
      items:[
        { type:'table', headers:['Level','What it is','Example'], rows:[
          ['Policy','High-level statement of intent and direction','Information Security Policy: "All data must be protected"'],
          ['Standard','Specific requirements that implement the policy','Passwords must be 12+ characters, include uppercase, lowercase, numbers'],
          ['Procedure','Step-by-step instructions for performing tasks','How to reset a password: Step 1, go to... Step 2...'],
          ['Guideline','Recommendations (not mandatory)','Suggested ways to create strong passwords'],
        ]}
      ]
    },
    { type:'section', title:'Key Security Policies to Know', icon:'üìã', bg:'#4f8ef7',
      items:[
        { type:'terms', title:'', terms:[
          { term:'AUP (Acceptable Use Policy)', def:'Defines what employees can and cannot do with company IT resources. Usually the first policy users sign.' },
          { term:'Incident Response Policy', def:'Defines how incidents are detected, reported, and responded to' },
          { term:'Business Continuity Policy', def:'How the organization maintains operations during a disruption' },
          { term:'Disaster Recovery Policy', def:'How IT systems are restored after a major incident' },
          { term:'SDLC Policy', def:'Security requirements for software development ‚Äî when security reviews happen' },
          { term:'Change Management Policy', def:'How changes to IT systems are approved, tested, and deployed' },
        ]}
      ]
    },
    { type:'section', title:'Data Roles & Responsibilities', icon:'üë•', bg:'#7c5cfc',
      items:[
        { type:'table', headers:['Role','Responsibility'], rows:[
          ['Data Owner','Business executive responsible for data ‚Äî classifies it, approves access'],
          ['Data Custodian/Steward','IT person who implements the owner\'s decisions ‚Äî manages backups, access controls'],
          ['Data Controller','Organization that determines WHY and HOW personal data is processed (GDPR term)'],
          ['Data Processor','Organization that processes data on behalf of the controller (GDPR term)'],
          ['Data Subject','The individual whose data is being processed (GDPR term)'],
        ]}
      ]
    },
  ],
  quiz: [
    { q:'A company issues a document stating that employees may not use company laptops for personal social media during work hours. What type of governance document is this?', choices:['Standard','Guideline','Procedure','Policy'], answer:3, explain:'This is a <strong>Policy</strong> ‚Äî a high-level statement of organizational intent and rules. It states WHAT is required (no personal social media on company equipment) without detailing HOW to enforce it.' },
    { q:'Under GDPR, a healthcare company shares patient data with a third-party analytics firm to analyze treatment outcomes. The healthcare company decides WHY the data is processed and what data to share. What is the healthcare company\'s role?', choices:['Data Processor','Data Subject','Data Custodian','Data Controller'], answer:3, explain:'The <strong>Data Controller</strong> is the entity that determines the purposes and means of processing personal data. The healthcare company decides WHY (analytics) and WHAT data to share. The analytics firm that actually processes it is the <strong>Data Processor</strong>.' },
  ]
},

'risk-process': {
  title: 'Risk Management Process',
  subtitle: 'Identify, assess, treat, monitor ‚Äî the continuous cycle of managing risk',
  domain: 5, domainName: '5.0 Security Program Management & Oversight',
  content: [
    { type:'analogy', label:'‚öñÔ∏è Risk management is like personal health decisions', text:'You identify risks (family history of heart disease), assess them (how likely, how bad?), decide how to treat them (eat healthier, exercise, or accept the risk), and monitor (annual checkups). Security risk management follows the same process for organizational threats.' },
    { type:'section', title:'Risk Management Process', icon:'üîÑ', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Step','What It Means','Example'], rows:[
          ['1. Identify','Find the risks ‚Äî what could go wrong?','Unpatched servers, lack of MFA, insider threats'],
          ['2. Assess','Determine likelihood and impact','Critical server exploit: High likelihood √ó High impact = Critical risk'],
          ['3. Prioritize','Focus on the biggest risks first','Fix critical vulns before low-priority hardening'],
          ['4. Treat','Choose a risk response strategy','Avoid, Transfer, Mitigate, or Accept ‚Äî see below'],
          ['5. Monitor','Continuously track risk levels and effectiveness of controls','Quarterly risk reviews, KRI dashboards, control effectiveness testing'],
        ]}
      ]
    },
    { type:'section', title:'Risk Treatment Strategies', icon:'üéØ', bg:'#ff7b39',
      items:[
        { type:'table', headers:['Strategy','What You Do','Example'], rows:[
          ['Avoid','Eliminate the activity that creates the risk','Stop storing credit cards if you don\'t need to ‚Äî no PCI DSS compliance required'],
          ['Transfer','Shift financial risk to someone else','Buy cyber insurance; outsource high-risk processing to a vendor'],
          ['Mitigate','Reduce likelihood or impact with controls','Patch the vulnerability, add MFA, segment the network'],
          ['Accept','Acknowledge the risk and accept the potential consequences','Document risk acceptance with formal exception or exemption'],
        ]}
      ]
    },
    { type:'section', title:'Risk Assessment Concepts', icon:'üìä', bg:'#22d06b',
      items:[
        { type:'table', headers:['Term','Definition','How It\'s Used'], rows:[
          ['Threat','A potential cause of an unwanted incident','Ransomware, insider threat, natural disaster'],
          ['Vulnerability','A weakness that can be exploited','Unpatched software, weak password, misconfigured firewall'],
          ['Likelihood','Probability the threat will occur','Low, Medium, High or percentage (20% chance per year)'],
          ['Impact','Damage if the threat occurs','Financial loss, reputation damage, downtime, data breach'],
          ['Risk','Combination of likelihood √ó impact','High likelihood + high impact = critical risk requiring immediate action'],
        ]}
      ]
    },
  ],
  quiz: [
    { q:'A company discovers a critical vulnerability in a public-facing web server. They immediately apply the vendor patch to eliminate the vulnerability. Which risk treatment strategy is this?', choices:['Avoid','Transfer','Mitigate','Accept'], answer:2, explain:'Patching the vulnerability is <strong>Mitigation</strong> ‚Äî reducing the risk by implementing a control. The company didn\'t eliminate the web server (avoid), didn\'t buy insurance (transfer), and didn\'t leave it unpatched (accept). They reduced the risk to an acceptable level.' },
    { q:'After conducting a risk assessment, a small business decides not to purchase cyber insurance because the premiums exceed the expected annual loss from potential incidents. What risk strategy is this?', choices:['Avoid','Transfer','Mitigate','Accept'], answer:3, explain:'Choosing not to buy insurance after assessing the cost-benefit is <strong>Accept</strong> ‚Äî the organization acknowledges the risk exists and consciously accepts the potential consequences. Acceptance should always be a documented, informed decision ‚Äî never neglect masquerading as strategy.' },
  ]
},

'risk-quantitative': {
  title: 'Quantitative Risk Analysis',
  subtitle: 'SLE, ALE, ARO, risk registers ‚Äî mastering the math of risk',
  domain: 5, domainName: '5.0 Security Program Management & Oversight',
  content: [
    { type:'analogy', label:'üìä Insurance companies live by risk math', text:'Insurers don\'t know if YOUR car will crash ‚Äî but they know statistically that X% of drivers in your demographic will crash this year, costing Y dollars on average. That math determines your premium. Quantitative risk analysis does the same for security decisions ‚Äî turning gut feelings into numbers.' },
    { type:'section', title:'Quantitative Risk Formulas', icon:'üßÆ', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Term','Formula','What It Answers'], rows:[
          ['Asset Value (AV)','(No formula ‚Äî assessed value)','How much is this asset worth in dollars?'],
          ['Exposure Factor (EF)','% of asset value lost in one incident','If this threat occurs, what percentage of the asset value is lost?'],
          ['Single Loss Expectancy (SLE)','SLE = AV √ó EF','How much does ONE occurrence of this threat cost?'],
          ['Annualized Rate of Occurrence (ARO)','Incidents per year (e.g., 0.1 = once per 10 years, 3 = three times per year)','How often does this threat occur annually?'],
          ['Annualized Loss Expectancy (ALE)','ALE = SLE √ó ARO','How much does this threat cost PER YEAR on average?'],
          ['Value of Safeguard','ALE(before) - ALE(after) - Cost of Safeguard','Is this security control worth buying?'],
        ]},
        { type:'tip', label:'üí° Worked Example', text:'Server worth $200,000 (AV). Ransomware could affect 80% of it (EF=0.8). Ransomware hits 3 times per year (ARO=3). <strong>SLE = $200,000 √ó 0.8 = $160,000</strong>. <strong>ALE = $160,000 √ó 3 = $480,000/year</strong>. An EDR solution costs $50,000/year and reduces ARO to 0.5: New ALE = $160,000 √ó 0.5 = $80,000. Savings: $480K - $80K - $50K = <strong>$350,000/year net benefit</strong>. Buy the EDR.' },
      ]
    },
    { type:'section', title:'Risk Registers & Governance', icon:'üìã', bg:'#22d06b',
      items:[
        { type:'definition', label:'Risk Register', text:'A formal document tracking all identified risks: description, likelihood, impact, risk score, risk owner (person accountable), current controls, and treatment plan. It\'s a living document updated continuously ‚Äî every significant organizational risk should be in the register with an assigned owner.' },
        { type:'table', headers:['Risk Register Element','Description'], rows:[
          ['Key Risk Indicators (KRIs)','Metrics that signal a risk is increasing ‚Äî early warning system (e.g., patch compliance dropping below 90%)'],
          ['Risk Owners','Specific individual accountable for managing each risk ‚Äî not a committee, a named person'],
          ['Risk Threshold','The maximum acceptable risk level ‚Äî risks above threshold require escalation and immediate action'],
        ]}
      ]
    },
    { type:'section', title:'Risk Appetite vs. Risk Tolerance', icon:'üéØ', bg:'#7c5cfc',
      items:[
        { type:'definition', label:'Risk Appetite', text:'The AMOUNT of risk an organization is WILLING to accept in pursuit of its objectives. A startup might have high risk appetite (move fast, accept more risk for growth). A bank has very low risk appetite (preserve capital and trust above all). Three styles: <strong>Expansionary</strong> (aggressive, high risk for high reward), <strong>Conservative</strong> (risk-averse), <strong>Neutral</strong> (balanced).' },
        { type:'definition', label:'Risk Tolerance', text:'The SPECIFIC MEASURABLE amount of variation from the risk appetite that is acceptable. Appetite = "we accept some cybersecurity risk to enable business agility." Tolerance = "but never more than $5M annual loss exposure or 2 hours of acceptable downtime." Tolerance is the boundary line.' },
        { type:'definition', label:'Qualitative vs. Quantitative Analysis', text:'<strong>Quantitative</strong>: uses numbers ‚Äî SLE, ALE, ARO. More precise but requires good data and actuarial assumptions. <strong>Qualitative</strong>: uses descriptors ‚Äî High/Medium/Low likelihood √ó High/Medium/Low impact = risk rating. Faster and works when you lack precise data. Most organizations use both ‚Äî qualitative for initial triage, quantitative for major decisions.' },
      ]
    },
  ],
  quiz: [
    { q:'A database server is valued at $500,000. A SQL injection attack could compromise 60% of the data. SQL injection attacks occur approximately 4 times per year against this server. What is the Annualized Loss Expectancy (ALE)?', choices:['$300,000','$120,000','$1,200,000','$500,000'], answer:2, explain:'SLE = AV √ó EF = $500,000 √ó 0.6 = <strong>$300,000</strong>. ALE = SLE √ó ARO = $300,000 √ó 4 = <strong>$1,200,000 per year</strong>. This database is losing an expected $1.2M annually to SQL injection ‚Äî justifying significant investment in a WAF, parameterized queries, and input validation.' },
    { q:'An organization states: "We prioritize rapid growth and market expansion over minimizing security risk ‚Äî we\'re willing to accept higher risk in exchange for faster innovation." What best describes this organization\'s risk posture?', choices:['Conservative risk appetite','Neutral risk appetite','Expansionary risk appetite','Zero risk tolerance'], answer:2, explain:'This is an <strong>expansionary risk appetite</strong> ‚Äî the organization actively accepts higher risk in pursuit of business objectives (growth, speed, innovation). Startups and high-growth companies often have expansionary risk appetite. Banks and healthcare organizations typically have conservative risk appetite.' },
    { q:'A CISO presents two security controls. Control A costs $100,000/year and reduces ALE from $800,000 to $200,000. Control B costs $150,000/year and reduces ALE from $800,000 to $100,000. Which provides better value?', choices:['Control A ‚Äî lower cost','Control B ‚Äî achieves lower ALE','Control A ‚Äî net benefit is $500K vs $550K for B, so B provides $50K more value despite higher cost','They provide equal value'], answer:2, explain:'Control A: Saves $800K-$200K=$600K in ALE, costs $100K ‚Üí <strong>net benefit $500K</strong>. Control B: Saves $800K-$100K=$700K in ALE, costs $150K ‚Üí <strong>net benefit $550K</strong>. Control B provides $50K more net value despite being more expensive. Choose B if budget allows ‚Äî it delivers greater risk reduction per dollar invested.' },
  ]
},

'vendor-risk': {
  title: 'Third-Party Risk & Vendor Management',
  subtitle: 'Due diligence, SLAs, right-to-audit, agreement types ‚Äî securing the supply chain',
  domain: 5, domainName: '5.0 Security Program Management & Oversight',
  content: [
    { type:'analogy', label:'ü§ù Your security is only as strong as your weakest vendor', text:'Target\'s 2013 breach started through an HVAC vendor with network access. SolarWinds compromised 18,000+ organizations through a software update. Your vendors are extensions of your attack surface ‚Äî their security failures become YOUR security incidents. Vendor risk management isn\'t optional.' },
    { type:'section', title:'Vendor Assessment Process', icon:'üîç', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Assessment Method','What It Does','When Used'], rows:[
          ['Security Questionnaires','Standardized questions about vendor security controls, policies, incident history','Initial vendor evaluation; annual reassessment; lightweight ongoing monitoring'],
          ['Independent Assessments','Third-party audit or certification of vendor security (SOC 2 Type II, ISO 27001)','Higher-risk vendors; validates questionnaire answers with audited evidence'],
          ['Penetration Testing','Ethical hacking of vendor systems or their integration points with your environment','High-risk integrations where vendor has privileged access; requires right-to-audit clause'],
          ['Evidence of Internal Audits','Review vendor\'s own internal audit results and remediation tracking','Validates vendor has active security program and fixes issues; look for recurring findings'],
          ['Supply Chain Analysis','Map all vendors within your vendors ‚Äî understanding nth-party risk dependencies','Critical for high-value suppliers; understanding full dependency chain'],
        ]}
      ]
    },
    { type:'section', title:'Agreement Types You Must Know', icon:'üìã', bg:'#22d06b',
      items:[
        { type:'table', headers:['Agreement','Abbreviation','Purpose'], rows:[
          ['Service-Level Agreement','SLA','Defines performance commitments ‚Äî uptime guarantees, response times, support levels. Security SLAs: breach notification timelines (24-72hr), vulnerability patching windows, incident response cooperation.'],
          ['Non-Disclosure Agreement','NDA','Protects confidential information shared during business relationship. Required before sharing sensitive system details, network diagrams, or security architectures with vendors.'],
          ['Master Service Agreement','MSA','Overarching contract governing the entire relationship ‚Äî terms, conditions, payment, liability, legal framework. All other agreements (SOWs, SLAs) operate under the MSA.'],
          ['Statement of Work','SOW / Work Order','Specific deliverables, timelines, and scope for a particular project or engagement within the MSA.'],
          ['Memorandum of Understanding','MOU','Informal agreement of intent ‚Äî less binding than a contract; used for partnerships, information sharing, cooperative arrangements.'],
          ['Memorandum of Agreement','MOA','More formal than MOU ‚Äî both parties agree to specific actions and responsibilities; often precedes a full contract.'],
          ['Business Partners Agreement','BPA','Defines security and operational responsibilities between business partners with ongoing data sharing or integrated systems.'],
          ['Right-to-Audit Clause','(Embedded in MSA/contract)','Gives you the legal right to audit the vendor\'s security controls, request SOC reports, or send auditors to vendor facilities. Critical for high-risk vendors ‚Äî without this, vendor can refuse access.'],
        ]}
      ]
    },
    { type:'tip', label:'üéØ Due Diligence vs. Due Care', text:'<strong>Due diligence</strong>: doing the research BEFORE making a decision ‚Äî vetting a vendor before signing the contract, reviewing their security posture, checking references. <strong>Due care</strong>: ongoing maintenance of reasonable precautions AFTER the decision ‚Äî monitoring vendor security posture throughout the relationship, reviewing audit reports, responding to vendor incidents. Both are legal obligations for organizations handling sensitive data.' },
  ],
  quiz: [
    { q:'A company wants to ensure it can verify a critical cloud provider\'s security controls are being maintained as promised, including the ability to send auditors to the provider\'s data centers. What contract element must be included?', choices:['Service-level agreement','Non-disclosure agreement','Right-to-audit clause','Master service agreement'], answer:2, explain:'A <strong>right-to-audit clause</strong> in the contract gives the customer the legal right to inspect vendor security controls, request audit reports, and send auditors to vendor facilities. Without this clause, the vendor can refuse access even if you suspect non-compliance with security requirements.' },
    { q:'An organization signs an informal document with a partner organization agreeing to share threat intelligence data, but the document is not a binding legal contract. What type of agreement is this?', choices:['SLA','BPA','NDA','MOU'], answer:3, explain:'A <strong>MOU (Memorandum of Understanding)</strong> is a non-binding agreement expressing mutual intent and understanding. Used for partnerships and information-sharing arrangements where a formal contract isn\'t yet in place. An MOA (Memorandum of Agreement) is more formal and closer to binding, but still short of a full contract.' },
  ]
},

'compliance': {
  title: 'Security Compliance & Privacy',
  subtitle: 'Compliance reporting, consequences of non-compliance, GDPR, HIPAA, PCI DSS',
  domain: 5, domainName: '5.0 Security Program Management & Oversight',
  content: [
    { type:'analogy', label:'‚öñÔ∏è Compliance is the legal minimum; security is the goal', text:'A 55 mph speed limit is the legal minimum ‚Äî it doesn\'t mean driving 55 in a blizzard is actually safe. Compliance frameworks set legal minimums. Security programs should exceed them. But failing the legal minimum has real consequences ‚Äî fines, sanctions, business shutdown.' },
    { type:'section', title:'Key Compliance Frameworks', icon:'üìã', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Framework','What It Governs','Who Must Comply','Key Requirements'], rows:[
          ['HIPAA','Protected Health Information (PHI)','Healthcare providers, insurers, business associates','Encryption, access controls, breach notification within 60 days, BAAs'],
          ['PCI DSS','Payment card data security','Any organization that processes, stores, or transmits credit card data','Network segmentation, encryption, access logging, quarterly scans, annual audits'],
          ['GDPR','EU personal data protection and privacy rights','Any organization handling EU residents\' data ‚Äî global reach','72-hour breach notification, right to be forgotten, data portability, massive fines'],
          ['SOX','Financial reporting integrity and IT controls','Publicly traded US companies','IT control audits, change management documentation, access controls for financial systems'],
          ['CCPA','California Consumer Privacy Act','Businesses meeting thresholds handling California residents\' data','Similar to GDPR for California ‚Äî disclosure, deletion, opt-out rights'],
          ['GLBA','Financial data protection','Financial institutions ‚Äî banks, insurance, brokers','Safeguard customer financial data; privacy notices'],
        ]}
      ]
    },
    { type:'section', title:'Consequences of Non-Compliance', icon:'‚ö†Ô∏è', bg:'#ff4d6d',
      items:[
        { type:'table', headers:['Consequence','Examples'], rows:[
          ['Financial Fines','GDPR: up to ‚Ç¨20M or 4% of global revenue (whichever is higher). PCI DSS: $5,000-$100,000/month. HIPAA: up to $1.9M/year per violation category. SOX violations: criminal charges for executives.'],
          ['Sanctions','Restrictions on processing certain data types; required remediation programs; government oversight; monitoring by regulators'],
          ['Reputational Damage','Public disclosure of breaches and non-compliance; customer trust loss; media coverage; stock price impact'],
          ['Loss of License/Ability to Operate','Payment processors can revoke ability to process credit cards (PCI DSS). Healthcare licenses can be suspended (HIPAA). Banks can lose operating licenses (GLBA).'],
          ['Contractual Impacts','Breach of contract with customers/partners who required compliance; termination of business agreements; loss of major customers'],
        ]}
      ]
    },
    { type:'section', title:'Privacy Concepts ‚Äî GDPR Focus', icon:'üîè', bg:'#22d06b',
      items:[
        { type:'definition', label:'GDPR Key Principles', text:'<strong>Data Subject</strong>: the individual whose data is collected. <strong>Right to Be Forgotten</strong>: data subjects can request deletion of their personal data (with some exceptions). <strong>Data Portability</strong>: subjects can request their data in a portable, machine-readable format. <strong>72-Hour Breach Notification</strong>: must notify supervisory authority within 72 hours of discovering a breach affecting personal data. Fines for non-compliance are severe ‚Äî designed to hurt even the largest companies.' },
        { type:'definition', label:'Data Controller vs. Data Processor', text:'<strong>Controller</strong>: decides WHY and HOW data is processed ‚Äî the organization with the business purpose (your company collecting customer data). <strong>Processor</strong>: processes data on controller\'s behalf following controller\'s instructions (your cloud provider, your CRM vendor). Controllers have greater legal responsibility. Processors must implement appropriate security and only process per controller instructions.' },
        { type:'definition', label:'Data Inventory & Retention', text:'Know what personal data you collect, where it\'s stored, how long you keep it, and the legal basis for processing it. Keeping data longer than necessary increases risk AND may violate GDPR (data minimization principle). Every organization handling EU data must maintain a data inventory ‚Äî a record of processing activities.' },
      ]
    },
  ],
  quiz: [
    { q:'A European company discovers that a data breach exposed 10,000 EU customers\' personal data on a Saturday. Under GDPR, by when must they notify their supervisory authority?', choices:['Within 24 hours','Within 72 hours of becoming aware of the breach','Within 30 days','Within 7 business days'], answer:1, explain:'GDPR Article 33 requires notification to the supervisory authority <strong>within 72 hours of becoming aware</strong> of a personal data breach ‚Äî weekends count. If notification is delayed beyond 72 hours, the organization must explain the reasons for the delay. High-risk breaches also require notification to affected individuals without undue delay.' },
    { q:'A marketing company collects EU residents\' email addresses for advertising campaigns and uses a third-party email platform to send campaigns. Under GDPR, what is the marketing company\'s role?', choices:['Data Processor ‚Äî they process data on behalf of customers','Data Controller ‚Äî they determine why and how the data is processed','Data Subject ‚Äî they are the individuals whose data is collected','Data Custodian ‚Äî they manage technical storage'], answer:1, explain:'The marketing company is the <strong>Data Controller</strong> ‚Äî they determine the purpose (advertising campaigns) and means of processing EU residents\' personal data. The third-party email platform is the <strong>Data Processor</strong> ‚Äî they process data on the controller\'s behalf per the controller\'s instructions. Controllers have primary legal responsibility under GDPR.' },
  ]
},

'audits-pentest': {
  title: 'Audits, Assessments & Penetration Testing',
  subtitle: 'Internal vs external audits, black/gray/white box testing, reconnaissance types',
  domain: 5, domainName: '5.0 Security Program Management & Oversight',
  content: [
    { type:'analogy', label:'üîç Audits vs. pen tests are like inspectors vs. burglars', text:'A building inspector reviews fire exits, checks electrical panels, and verifies code compliance (audit). A security consultant tries to actually BREAK IN to find vulnerabilities the inspector would miss (penetration test). Both are necessary ‚Äî one checks compliance, one checks actual security effectiveness.' },
    { type:'section', title:'Types of Audits & Assessments', icon:'üìã', bg:'#4f8ef7',
      items:[
        { type:'table', headers:['Type','Who Conducts It','Purpose','Independence Level'], rows:[
          ['Internal Audit','Your own audit team','Check compliance with internal policies; identify control gaps for management','Low ‚Äî same organization; potential bias toward management'],
          ['External Regulatory Audit','Regulatory body (SEC, OCC, FTC, state regulators)','Verify compliance with laws and regulations; enforce penalties for non-compliance','High ‚Äî independent government authority with enforcement power'],
          ['Independent Third-Party Audit','Hired external audit firm (Big 4, specialized security auditors)','SOC 2, ISO 27001 certification; provide customer assurance; objective assessment','High ‚Äî independent from both you and regulators; reputation-driven'],
          ['Self-Assessment','Department/team assesses themselves','Quick internal check; identify issues before formal audits; continuous improvement','Lowest ‚Äî no independence; useful for process improvement, not assurance'],
        ]}
      ]
    },
    { type:'section', title:'Penetration Testing Types', icon:'üéØ', bg:'#ff7b39',
      items:[
        { type:'table', headers:['Test Type','Tester Knowledge','Simulates','Also Called'], rows:[
          ['Black Box','No prior knowledge of environment','External attacker with zero inside information ‚Äî must do all reconnaissance from scratch','Unknown environment test'],
          ['White Box','Full knowledge ‚Äî network diagrams, source code, credentials, architecture documentation','Thorough security audit or insider threat with complete access ‚Äî finds maximum vulnerabilities','Known environment / Crystal box'],
          ['Gray Box','Partial knowledge ‚Äî basic user credentials, some network info, limited documentation','Compromised employee; partner with partial access; realistic middle ground','Partially known environment'],
          ['Physical Pen Test','N/A (focuses on physical security)','Physical intrusion ‚Äî social engineering, lock picking, tailgating, badge cloning','Physical security assessment'],
        ]},
        { type:'definition', label:'Offensive vs Defensive vs Integrated', text:'<strong>Offensive (Red Team)</strong>: active attack simulation trying to achieve specific goals (exfiltrate data, gain domain admin). <strong>Defensive (Blue Team)</strong>: monitors and responds to attacks ‚Äî tests detection and response capability. <strong>Integrated (Purple Team)</strong>: red team attacks while blue team responds simultaneously ‚Äî collaborative learning exercise where both sides improve.' },
      ]
    },
    { type:'section', title:'Reconnaissance Types', icon:'üî≠', bg:'#22d06b',
      items:[
        { type:'definition', label:'Passive Reconnaissance', text:'Gathering information WITHOUT directly interacting with the target ‚Äî OSINT (open-source intelligence), public records, social media scraping, job postings (reveal internal tools), DNS lookups (public records), WHOIS queries. Target CANNOT detect passive recon. Examples: LinkedIn employee scraping, Shodan searches for exposed services, reading public financial filings for vendor information.' },
        { type:'definition', label:'Active Reconnaissance', text:'Directly interacting with the target to gather information ‚Äî port scanning, service enumeration, vulnerability scanning, sending packets to the target. Target MAY detect active recon (appears in firewall logs, IDS alerts, security monitoring). Examples: Nmap port scans, banner grabbing from services, web application spidering, DNS zone transfer attempts.' },
        { type:'tip', label:'üéØ Rules of Engagement ‚Äî Absolutely Critical', text:'Before ANY penetration test, a <strong>Rules of Engagement (RoE)</strong> document must be signed by both parties defining: scope (what systems are in/out of scope), testing windows (when can you test?), emergency contacts (who to call if something breaks), allowed techniques (can you test DoS? social engineering?), and explicit written authorization signed by someone with authority. Testing without proper authorization = federal crime (CFAA violations). The RoE protects both parties legally.' },
      ]
    },
  ],
  quiz: [
    { q:'A company hires an external firm to perform a penetration test. The testers are given no information about the company\'s network, systems, or architecture before beginning. They must discover everything from scratch like a real attacker. What type of test is this?', choices:['White box test','Gray box test','Black box test','Physical penetration test'], answer:2, explain:'A <strong>black box</strong> test (unknown environment) provides the tester with no prior knowledge of the target. They must perform full reconnaissance and enumeration just as a real external attacker would. This most closely simulates an external threat actor with zero insider knowledge or documentation.' },
    { q:'Before beginning a penetration test engagement, a security firm and their client must define which systems can be tested, what testing methods are allowed, testing time windows, and emergency contacts. What document establishes these parameters?', choices:['Statement of Work (SOW)','Non-Disclosure Agreement (NDA)','Rules of Engagement (RoE)','Master Service Agreement (MSA)'], answer:2, explain:'The <strong>Rules of Engagement</strong> document defines the specific boundaries and conditions for a penetration test: scope, allowed techniques, testing timeframes, emergency procedures, and authorization. Without this legally, testing could be considered unauthorized access (CFAA violation) and could disrupt business operations. The RoE protects both the tester and the client.' },
  ]
},

'awareness-training': {
  title: 'Security Awareness & Training Programs',
  subtitle: 'Phishing simulations, anomalous behavior recognition, building the human firewall',
  domain: 5, domainName: '5.0 Security Program Management & Oversight',
  content: [
    { type:'analogy', label:'üë• Technology can\'t fix human behavior ‚Äî only training can', text:'You can have the most expensive firewall in the world and an employee will still click the phishing email with "URGENT: YOUR ACCOUNT WILL BE CLOSED" in the subject line. The human layer is always the weakest link ‚Äî and the most frequently targeted. A strong security awareness program turns your employees from a liability into a defensive layer.' },
    { type:'section', title:'Phishing Awareness Programs', icon:'üé£', bg:'#ff4d6d',
      items:[
        { type:'definition', label:'Phishing Simulation Campaigns', text:'Controlled simulated phishing attacks sent to employees to measure click rates and train recognition. Employees who click are immediately shown educational content about what indicators they missed. Metrics tracked: click-through rate, credential submission rate, reporting rate. Well-run programs reduce real phishing click rates from 30%+ to under 5% over 6-12 months of training.' },
        { type:'table', headers:['Training Element','What to Teach'], rows:[
          ['Recognizing Phishing','Urgency language, suspicious sender domains, unexpected requests, mismatched URLs, generic greetings, grammatical errors ‚Äî always hover before clicking links'],
          ['Reporting Suspicious Messages','How to report (phish alert button, forward to security@, IT ticketing system) ‚Äî importance of reporting even if they clicked (early detection)'],
          ['Vishing Recognition','IT will never call asking for your password or MFA code; always verify caller identity through independently looked-up phone numbers, not numbers provided by caller'],
          ['Smishing Recognition','Don\'t click SMS links from unknown numbers; legitimate organizations don\'t ask for credentials via text; banks never text asking to verify your account urgently'],
        ]}
      ]
    },
    { type:'section', title:'Anomalous Behavior Recognition', icon:'üëÅÔ∏è', bg:'#ff7b39',
      items:[
        { type:'definition', label:'Risky Behavior', text:'Actions that knowingly or unknowingly increase security risk: using personal email for work files, disabling VPN to improve performance, sharing passwords with coworkers for convenience, connecting to unsecured public Wi-Fi for work tasks, storing credentials in plaintext documents.' },
        { type:'definition', label:'Unexpected Behavior', text:'Actions outside normal patterns: large data downloads outside normal work hours, accessing systems they\'ve never used before, attempting to access restricted areas physically, visiting facilities at unusual times, taking excessive interest in systems outside their role.' },
        { type:'definition', label:'Unintentional Behavior', text:'Accidental security violations: emailing the wrong person (sending confidential data externally), attaching the wrong file, misconfiguring a cloud storage bucket to public, leaving documents visible on desk in open office. Training helps users recognize and report these mistakes quickly before they become incidents.' },
      ]
    },
    { type:'section', title:'Training Program Elements', icon:'üìö', bg:'#22d06b',
      items:[
        { type:'table', headers:['Element','Description'], rows:[
          ['Policies & Handbooks','Acceptable use policy, security policies, clear written guidelines employees acknowledge signing during onboarding'],
          ['Situational Awareness','Teaching employees to notice suspicious activity ‚Äî tailgating attempts, shoulder surfing, unexpected visitors, people in restricted areas, unusual questions'],
          ['Insider Threat Awareness','Recognize indicators in colleagues ‚Äî financial stress, unusual data access patterns, resentment toward employer, attempts to bypass controls'],
          ['Password Management','Best practices, password manager usage, recognizing credential theft attempts (phishing, vishing), never reusing passwords'],
          ['Removable Media','Don\'t plug in unknown USB drives found in parking lots or sent unsolicited; treat all found media as potentially malicious until verified'],
          ['Operational Security (OPSEC)','Don\'t post work details on social media (infrastructure, vendors, schedules); be careful about conversations in public; travel security for executives'],
          ['Remote Work Security','Home Wi-Fi security, VPN usage requirements, physical security of home office, public Wi-Fi dangers, video call security (virtual backgrounds for confidential spaces)'],
        ]},
        { type:'tip', label:'üéØ Training Program Lifecycle', text:'Effective programs are continuous, not one-time events: <strong>Initial</strong> training during onboarding when employees join. <strong>Recurring</strong> annual (minimum) refresher training for all employees. <strong>Targeted</strong> training triggered by policy violations, role changes, or security incidents. <strong>Measured</strong> via phishing simulation metrics, incident rates, and pre/post-training assessments. Training without measurement is just compliance theater.' },
      ]
    },
  ],
  quiz: [
    { q:'An employee receives a simulated phishing email as part of the company\'s security awareness program and clicks the link. What should happen next according to best practices?', choices:['The employee should be immediately disciplined','The employee should be immediately shown targeted educational content about the phishing indicators they missed','Their account should be locked pending security review','The simulation should be re-sent until they pass'], answer:1, explain:'Phishing simulations are training tools, not punishment mechanisms. Best practice: <strong>immediately show the employee educational content</strong> explaining what phishing indicators they missed (suspicious sender, urgency language, mismatched URL). Punishment-based approaches reduce reporting rates ‚Äî employees fear reporting real phishing if they\'ll be punished for clicking. The goal is behavior change through education, not fear.' },
    { q:'A company trains employees annually and after security incidents. They also send monthly simulated phishing emails and track click rates over time. What type of training element are the monthly simulations?', choices:['Initial training','Recurring/ongoing training','Reactive training','Compliance-only training'], answer:1, explain:'Monthly phishing simulations are <strong>recurring (ongoing) training</strong> ‚Äî continuously reinforcing awareness rather than providing it once at hire and never again. Regular simulations keep security awareness top-of-mind, provide ongoing measurement of program effectiveness, and maintain muscle memory for recognizing threats. Annual training alone has been proven ineffective ‚Äî humans forget without reinforcement.' },
    { q:'An employee notices that a coworker has been staying late every night for the past month, accessing the customer database outside their normal job responsibilities, and seems very stressed about personal finances. The employee reports this to security. What type of threat indicator is being identified?', choices:['External threat actor reconnaissance','Hacktivist threat','Potential insider threat indicators','Supply chain compromise'], answer:2, explain:'The described behaviors ‚Äî unusual system access outside normal role, behavioral changes (stress, financial issues), irregular work hours ‚Äî are classic <strong>insider threat indicators</strong>. Security awareness training specifically covers recognizing these patterns in colleagues and encourages confidential reporting to security teams for investigation. Insider threats are detected through observant employees as often as through technical controls.' },
  ]
},

};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// QUESTION BANK ‚Äî Organized by domain & difficulty
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const QUESTIONS = [
// DOMAIN 1
{ id:'d1q1',domain:1,diff:1,type:'mc',
  q:'Which of the following BEST describes the purpose of the Availability pillar of the CIA triad?',
  choices:['Ensuring data is only seen by authorized users','Ensuring data has not been modified without authorization','Ensuring systems and data are accessible when needed','Ensuring users cannot deny their actions'],
  answer:2, explain:'<strong>Availability</strong> ensures that systems, services, and data are accessible to authorized users when needed. DDoS attacks are the classic attack against Availability.',
  domain_name:'1.0 General Security Concepts'
},
{ id:'d1q2',domain:1,diff:1,type:'mc',
  q:'A security guard checks employee badges before allowing anyone into the server room. What type of control is this?',
  choices:['Technical, Preventive','Physical, Preventive','Operational, Detective','Managerial, Directive'],
  answer:1, explain:'Checking badges is a <strong>Physical</strong> control (it\'s physically enforced) and <strong>Preventive</strong> (it stops unauthorized people from entering before they do harm).',
  domain_name:'1.0 General Security Concepts'
},
{ id:'d1q3',domain:1,diff:2,type:'mc',
  q:'An organization cannot immediately patch a critical vulnerability in a legacy system because doing so would break a critical application. Instead, they place additional firewall rules and enhanced monitoring around that system. What type of control is this additional protection?',
  choices:['Corrective','Preventive','Compensating','Directive'],
  answer:2, explain:'When you cannot implement the primary control (patching), a <strong>Compensating control</strong> provides alternative protection. The firewall rules and monitoring compensate for the inability to patch.',
  domain_name:'1.0 General Security Concepts'
},
{ id:'d1q4',domain:1,diff:2,type:'mc',
  q:'A digital forensics investigator needs to prove that a piece of evidence collected from a server has not been modified since collection. Which cryptographic tool is BEST suited for this purpose?',
  choices:['Asymmetric encryption','Digital certificate','Hashing','Key escrow'],
  answer:2, explain:'<strong>Hashing</strong> creates a unique fingerprint of data. If you hash evidence at collection and again later, identical hashes prove the data was not modified. Any change in the data produces a completely different hash.',
  domain_name:'1.0 General Security Concepts'
},
{ id:'d1q5',domain:1,diff:3,type:'mc',
  q:'In a Zero Trust architecture, which component evaluates real-time risk signals (user identity, device health, threat intelligence) and makes the grant/deny access decision?',
  choices:['Policy Enforcement Point','Policy Administrator','Policy Engine','Implicit Trust Zone'],
  answer:2, explain:'The <strong>Policy Engine</strong> is the decision-making component of Zero Trust. It evaluates all contextual signals and makes the access decision. The Policy Administrator then implements that decision, and the Policy Enforcement Point enforces it.',
  domain_name:'1.0 General Security Concepts'
},
{ id:'d1q6',domain:1,diff:3,type:'mc',
  q:'A company stores encryption keys in a secure hardware device that performs cryptographic operations internally, preventing key material from ever being exposed in software memory. What is this device?',
  choices:['TPM','HSM','Key Management System','Secure Enclave'],
  answer:1, explain:'A <strong>Hardware Security Module (HSM)</strong> is a dedicated hardware device for high-assurance cryptographic operations. Keys are generated and stored inside the HSM and never leave it ‚Äî all operations happen within the secure hardware.',
  domain_name:'1.0 General Security Concepts'
},
{ id:'d1q7',domain:1,diff:4,type:'mc',
  q:'An organization implements a PKI where an intermediate CA issues certificates to end entities. The intermediate CA\'s certificate was signed by the root CA. A user receives a TLS certificate from a web server. To validate it, the user\'s browser checks the certificate chain back to a trusted root. Which PKI component establishes the foundation of this trust?',
  choices:['CRL','OCSP','Certificate Signing Request','Root of Trust'],
  answer:3, explain:'The <strong>Root of Trust</strong> (root CA) is the anchor of the PKI trust chain. Browsers and operating systems ship with a pre-installed list of trusted root CAs. All other certificates derive their trustworthiness from being signed by ‚Äî or chaining back to ‚Äî a trusted root.',
  domain_name:'1.0 General Security Concepts'
},

// DOMAIN 2
{ id:'d2q1',domain:2,diff:1,type:'mc',
  q:'An attacker sends millions of requests to a web server from thousands of compromised computers, causing it to become unavailable. What type of attack is this?',
  choices:['SQL Injection','DDoS (Distributed Denial of Service)','Man-in-the-middle','Ransomware'],
  answer:1, explain:'A <strong>DDoS (Distributed Denial of Service)</strong> attack uses many distributed sources (botnet) to flood a target with traffic, exhausting its resources and making it unavailable to legitimate users.',
  domain_name:'2.0 Threats, Vulnerabilities, and Mitigations'
},
{ id:'d2q2',domain:2,diff:1,type:'mc',
  q:'An attacker convinces an employee to click a link in an email that appears to come from the company\'s IT department, requesting them to verify their credentials. What type of attack is this?',
  choices:['Vishing','Smishing','Phishing','Pretexting'],
  answer:2, explain:'<strong>Phishing</strong> is a fraudulent email designed to trick recipients into revealing credentials or clicking malicious links. Since this is delivered via email (not voice or SMS), it\'s phishing specifically.',
  domain_name:'2.0 Threats, Vulnerabilities, and Mitigations'
},
{ id:'d2q3',domain:2,diff:2,type:'mc',
  q:'A vulnerability in a web application allows an attacker to insert malicious SQL code into a search field, causing the database to return all user records. What type of attack is this?',
  choices:['Cross-site scripting (XSS)','Buffer overflow','SQL Injection (SQLi)','Directory traversal'],
  answer:2, explain:'<strong>SQL Injection (SQLi)</strong> occurs when unsanitized user input is inserted into SQL queries, allowing attackers to manipulate the query and access, modify, or delete database data.',
  domain_name:'2.0 Threats, Vulnerabilities, and Mitigations'
},
{ id:'d2q4',domain:2,diff:2,type:'mc',
  q:'An attacker discovers that a web server logs user-provided input directly to a page without sanitizing it. They inject a script that runs in the browsers of anyone who visits that page, stealing their session cookies. What type of attack is this?',
  choices:['SQL Injection','Directory Traversal','Cross-Site Scripting (XSS)','CSRF'],
  answer:2, explain:'<strong>Cross-Site Scripting (XSS)</strong> injects malicious scripts into web pages that execute in victims\' browsers. Stored XSS persists on the server and affects all visitors to the page.',
  domain_name:'2.0 Threats, Vulnerabilities, and Mitigations'
},
{ id:'d2q5',domain:2,diff:3,type:'mc',
  q:'A security analyst notices that a user account logged in from New York at 9:00 AM and then appears to log in from London at 9:45 AM. What type of indicator of malicious activity is this?',
  choices:['Account lockout','Resource consumption','Impossible travel','Out-of-cycle logging'],
  answer:2, explain:'<strong>Impossible travel</strong> is when a user\'s account shows logins from geographically distant locations within a timeframe that\'s physically impossible to travel between. This indicates stolen credentials or account compromise.',
  domain_name:'2.0 Threats, Vulnerabilities, and Mitigations'
},
{ id:'d2q6',domain:2,diff:3,type:'mc',
  q:'A threat actor exploits a software vulnerability that the vendor does not yet know about, for which no patch exists. What type of vulnerability is this?',
  choices:['Misconfiguration','Legacy vulnerability','Zero-day vulnerability','Supply chain vulnerability'],
  answer:2, explain:'A <strong>zero-day vulnerability</strong> is one that is unknown to the software vendor, meaning there is no available patch ("zero days" for the vendor to fix it before exploitation).',
  domain_name:'2.0 Threats, Vulnerabilities, and Mitigations'
},
{ id:'d2q7',domain:2,diff:4,type:'mc',
  q:'An attacker intercepts network traffic between a client and server. They downgrade the TLS connection from TLS 1.3 to TLS 1.0, which has known vulnerabilities, allowing them to decrypt the traffic. What type of attack is this?',
  choices:['Credential replay','Birthday attack','On-path (man-in-the-middle) with downgrade','Collision attack'],
  answer:2, explain:'This is an <strong>on-path (MITM) attack with a cryptographic downgrade</strong>. The attacker forces both parties to use a weaker protocol version they can then exploit. Downgrade attacks are a type of cryptographic attack.',
  domain_name:'2.0 Threats, Vulnerabilities, and Mitigations'
},

// DOMAIN 3
{ id:'d3q1',domain:3,diff:1,type:'mc',
  q:'Which of the following cloud deployment considerations outlines which security responsibilities belong to the cloud provider versus the customer?',
  choices:['Service level agreement','Shared responsibility matrix','Hybrid cloud model','Infrastructure as Code'],
  answer:1, explain:'The <strong>Shared Responsibility Matrix</strong> (or model) defines which security controls are the cloud provider\'s responsibility and which are the customer\'s. In IaaS, customers manage more; in SaaS, the provider manages most.',
  domain_name:'3.0 Security Architecture'
},
{ id:'d3q2',domain:3,diff:2,type:'mc',
  q:'A company configures its firewall so that if the firewall hardware fails, all traffic is denied until the issue is resolved. What is this configuration called?',
  choices:['Fail-open','Fail-closed','Fail-secure','Fail-safe'],
  answer:1, explain:'<strong>Fail-closed</strong> (also called fail-secure) means that when a device fails, it defaults to denying all traffic ‚Äî the secure posture. <strong>Fail-open</strong> would allow all traffic if the firewall fails (prioritizes availability over security).',
  domain_name:'3.0 Security Architecture'
},
{ id:'d3q3',domain:3,diff:2,type:'mc',
  q:'An organization requires that its core transaction processing system have a Recovery Time Objective (RTO) of 15 minutes. Which site type would BEST meet this requirement?',
  choices:['Cold site','Warm site','Hot site','Cloud backup site'],
  answer:2, explain:'A <strong>Hot site</strong> is a fully operational duplicate of the primary site with live data replication ‚Äî it can take over almost immediately. With a 15-minute RTO, you need instant failover capability that only a hot site provides.',
  domain_name:'3.0 Security Architecture'
},
{ id:'d3q4',domain:3,diff:3,type:'mc',
  q:'A company stores customer medical records that are subject to HIPAA regulations. Under what data classification would this data most likely fall?',
  choices:['Public','Internal','Confidential','Critical'],
  answer:2, explain:'Medical records (PHI - Protected Health Information) are highly sensitive and regulated under HIPAA. They would be classified as <strong>Confidential</strong> or higher, meaning access is tightly controlled and the data must be protected both at rest and in transit.',
  domain_name:'3.0 Security Architecture'
},
{ id:'d3q5',domain:3,diff:3,type:'mc',
  q:'A web application firewall (WAF) is BEST described as which type of control?',
  choices:['A Layer 3 firewall that filters based on IP addresses and ports','An application-layer firewall that inspects HTTP/HTTPS traffic for malicious patterns','A network IDS that passively monitors web traffic','A VPN gateway for securing web application access'],
  answer:1, explain:'A <strong>WAF (Web Application Firewall)</strong> operates at Layer 7 (Application layer) and specifically inspects HTTP/HTTPS traffic for web-based attacks like SQL injection, XSS, and CSRF. Unlike traditional firewalls that filter at Layer 3/4, WAFs understand web application logic.',
  domain_name:'3.0 Security Architecture'
},

// DOMAIN 4
{ id:'d4q1',domain:4,diff:1,type:'mc',
  q:'Which mobile device deployment model means employees use their personal devices for work purposes, and the company has a policy governing acceptable use?',
  choices:['COPE (Corporate-Owned, Personally Enabled)','CYOD (Choose Your Own Device)','BYOD (Bring Your Own Device)','MDM (Mobile Device Management)'],
  answer:2, explain:'<strong>BYOD (Bring Your Own Device)</strong> allows employees to use personal devices for work. The company typically requires MDM enrollment and has policies for acceptable use. COPE is company-owned but personally used; CYOD lets employees choose from company-approved devices.',
  domain_name:'4.0 Security Operations'
},
{ id:'d4q2',domain:4,diff:2,type:'mc',
  q:'During a forensic investigation, an analyst must collect evidence from a compromised server. In what order should evidence be collected, according to the order of volatility?',
  choices:['Hard disk ‚Üí RAM ‚Üí Network connections ‚Üí CPU registers','CPU registers ‚Üí RAM ‚Üí Network state ‚Üí Hard disk','Hard disk ‚Üí Logs ‚Üí RAM ‚Üí CPU registers','Logs ‚Üí Hard disk ‚Üí RAM ‚Üí Network connections'],
  answer:1, explain:'The <strong>order of volatility</strong> dictates collecting the most volatile (shortest-lived) evidence first: <strong>CPU registers ‚Üí RAM ‚Üí Network state/connections ‚Üí Running processes ‚Üí Hard disk ‚Üí Remote logs ‚Üí Archival media</strong>. RAM is lost when a system powers off.',
  domain_name:'4.0 Security Operations'
},
{ id:'d4q3',domain:4,diff:2,type:'mc',
  q:'An organization wants to prevent specific employees who work in Accounts Payable from accessing systems outside of business hours (8 AM - 6 PM). What access control mechanism should be implemented?',
  choices:['Role-based access control','Mandatory access control','Time-of-day restrictions','Attribute-based access control'],
  answer:2, explain:'<strong>Time-of-day restrictions</strong> limit when users can authenticate and access systems, regardless of their role permissions. This is a common control for preventing after-hours access by limiting the attack window for compromised credentials.',
  domain_name:'4.0 Security Operations'
},
{ id:'d4q4',domain:4,diff:3,type:'mc',
  q:'A SOC analyst notices that an employee\'s account is sending 500 emails per hour, including to external addresses, after normal business hours. The employee\'s workstation shows processes the employee\'s device has never run before. What FIRST step should the analyst take?',
  choices:['Delete the suspicious processes immediately','Contain the workstation by isolating it from the network','Call the employee to ask if they are sending the emails','Format the workstation and reinstall the OS'],
  answer:1, explain:'Per incident response, the correct sequence is Detection ‚Üí Analysis ‚Üí <strong>Containment</strong> ‚Üí Eradication ‚Üí Recovery. The FIRST response to an active incident is <strong>containment</strong> ‚Äî isolate the system to prevent further spread or damage. Deleting processes or formatting is eradication/recovery, which comes later.',
  domain_name:'4.0 Security Operations'
},
{ id:'d4q5',domain:4,diff:3,type:'mc',
  q:'Which of the following email security controls helps receiving mail servers verify that an email actually came from the domain it claims to be from by checking a list of authorized sending IP addresses?',
  choices:['DKIM (DomainKeys Identified Mail)','DMARC (Domain-based Message Authentication Reporting and Conformance)','SPF (Sender Policy Framework)','TLS encryption'],
  answer:2, explain:'<strong>SPF (Sender Policy Framework)</strong> allows domain owners to specify which IP addresses are authorized to send email on behalf of their domain. Receiving servers check the SPF record to verify the sender\'s IP is on the authorized list.',
  domain_name:'4.0 Security Operations'
},
{ id:'d4q6',domain:4,diff:4,type:'mc',
  q:'A security team implements a SOAR platform to automate their incident response. When the platform detects a phishing email, it automatically quarantines the email, blocks the sending domain in the firewall, and creates a ticket in the ticketing system. What BEST describes this implementation?',
  choices:['A vulnerability management lifecycle','A threat intelligence feed integration','A security orchestration and automation playbook','A SIEM correlation rule'],
  answer:2, explain:'This is a <strong>SOAR (Security Orchestration, Automation, and Response) playbook</strong> ‚Äî automated workflows that execute multiple actions across different security tools in response to detected threats. The key elements: automated (no human action), orchestrated (multiple tools working together), response-oriented.',
  domain_name:'4.0 Security Operations'
},

// DOMAIN 5
{ id:'d5q1',domain:5,diff:1,type:'mc',
  q:'Which of the following BEST describes the purpose of a Business Impact Analysis (BIA)?',
  choices:['Identifying all vulnerabilities in a system','Determining which business functions are critical and how long they can survive a disruption','Calculating the annual security budget based on risk','Evaluating third-party vendor security controls'],
  answer:1, explain:'A <strong>BIA (Business Impact Analysis)</strong> identifies critical business functions, determines the maximum tolerable downtime (RTO), acceptable data loss (RPO), and the financial/operational impact of disruptions. It drives disaster recovery planning.',
  domain_name:'5.0 Security Program Management'
},
{ id:'d5q2',domain:5,diff:2,type:'mc',
  q:'A company requires its vendors to undergo a security audit before becoming approved suppliers. The contract gives the company the right to send auditors to the vendor\'s facility to review their security controls. What contract clause enables this?',
  choices:['Non-disclosure agreement','Service-level agreement','Right-to-audit clause','Master service agreement'],
  answer:2, explain:'A <strong>right-to-audit clause</strong> in a contract gives an organization the legal right to inspect a vendor\'s security controls, processes, and compliance posture. This is a critical third-party risk management tool.',
  domain_name:'5.0 Security Program Management'
},
{ id:'d5q3',domain:5,diff:2,type:'mc',
  q:'Which type of penetration test is conducted where the tester has NO prior knowledge of the target environment and must gather information just as a real attacker would?',
  choices:['Known environment','Partially known environment (gray box)','Unknown environment (black box)','Integrated test'],
  answer:2, explain:'An <strong>unknown environment (black box)</strong> test simulates an external attacker with no insider knowledge ‚Äî the tester must perform reconnaissance from scratch, just as a real attacker would. This most closely simulates a real-world external attack.',
  domain_name:'5.0 Security Program Management'
},
{ id:'d5q4',domain:5,diff:3,type:'mc',
  q:'An organization\'s ALE for a specific risk is $50,000. A security control that would eliminate this risk costs $80,000 annually to maintain. What is the BEST risk management decision?',
  choices:['Implement the control because eliminating all risk is always worth it','Do not implement the control ‚Äî it costs more than the expected annual loss','Implement the control and charge customers for the security improvement','Transfer the risk to a third party by outsourcing the affected system'],
  answer:1, explain:'A core risk management principle: if a control costs MORE than the <strong>ALE (Annualized Loss Expectancy)</strong>, it\'s not financially justified. Spending $80K/year to prevent $50K/year in losses is a net loss of $30K/year. Consider risk acceptance or a cheaper compensating control.',
  domain_name:'5.0 Security Program Management'
},
{ id:'d5q5',domain:5,diff:4,type:'mc',
  q:'GDPR\'s "right to be forgotten" requires an organization to delete a customer\'s personal data upon request. Which of the following represents the MOST significant conflict this creates for security professionals?',
  choices:['Encryption requirements conflict with deletion requests','Log retention requirements for security auditing may conflict with deletion obligations','The right to be forgotten only applies to marketing data, not security logs','Deleting data violates data integrity principles'],
  answer:1, explain:'Organizations are legally required to retain security logs (often 1-7 years) for audit, forensic, and compliance purposes. GDPR\'s right to be forgotten creates a conflict when a data subject\'s information appears in security logs. Organizations must balance deletion obligations against legitimate security/legal log retention needs ‚Äî often using anonymization or pseudonymization as a compromise.',
  domain_name:'5.0 Security Program Management'
},
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// APP STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let currentView = 'home';
let currentLesson = null;
let currentMode = 'adaptive';
let qCount = 25;
let selectedDomain = null;
let quizSession = { qs:[], idx:0, score:0, selected:null, answered:false };

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// VIEW MANAGEMENT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showView(v){
  document.querySelectorAll('[id^="view-"]').forEach(el=>el.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(el=>el.classList.remove('active'));
  document.getElementById('view-'+v).classList.add('active');
  const navMap = {home:0,learn:1,prove:2,stats:3};
  document.querySelectorAll('.nav-btn')[navMap[v]].classList.add('active');
  currentView = v;
  if(v==='home') renderHome();
  if(v==='learn') renderLearnSidebar();
  if(v==='stats') renderStats();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HOME
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderHome(){
  const overall = Math.round(Object.values(state.domainMastery).reduce((a,b)=>a+b,0)/5);
  document.getElementById('overall-pct').textContent=overall+'%';
  document.getElementById('overall-fill').style.width=overall+'%';

  const dColors = DOMAINS.map(d=>d.color);
  document.getElementById('domain-grid').innerHTML = DOMAINS.map(d=>`
    <div class="domain-card" style="--domain-color:${d.color}" onclick="showView('learn');openDomain(${d.id})">
      <div class="domain-badge">${d.icon} Domain ${d.id}</div>
      <div class="domain-name">${d.name}</div>
      <div class="domain-meta">
        <span class="domain-pct">${d.pct} of exam</span>
        <span>${d.topics.length} topic areas</span>
        <span>${d.topics.reduce((a,t)=>a+t.lessons.length,0)} lessons</span>
      </div>
      <div class="domain-progress">
        <div class="domain-progress-fill" style="width:${state.domainMastery[d.id]}%;background:${d.color}"></div>
      </div>
    </div>
  `).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// LEARN SIDEBAR
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let openDomainId = 1;
function renderLearnSidebar(){
  const sb = document.getElementById('learn-sidebar');
  sb.innerHTML = `<div class="sidebar-header">üìñ Course Content</div>` +
    DOMAINS.map(d=>`
      <div class="sidebar-domain">
        <div class="sidebar-domain-header ${openDomainId===d.id?'open':''}" onclick="toggleDomain(${d.id})" id="dh-${d.id}">
          <span style="display:flex;align-items:center;gap:8px">
            <span class="d-num" style="--domain-color:${d.color}">D${d.id}</span>
            <span style="font-size:12px">${d.name}</span>
          </span>
          <span class="chevron ${openDomainId===d.id?'open':''}">‚ñ∂</span>
        </div>
        <div class="sidebar-topics ${openDomainId===d.id?'open':''}" id="dt-${d.id}">
          ${d.topics.map(t=>{
            const showHeader = d.id<=5;
            const header = showHeader ? `<div class="sidebar-topic-header"><span class="topic-obj-id">${t.id}</span><span class="topic-obj-name">${t.name}</span></div>` : '';
            const items = t.lessons.map(lid=>{
              const lesson = LESSONS[lid];
              const name = lesson ? lesson.title : lid;
              const done = state.lessonsCompleted.includes(lid);
              return `<div class="sidebar-topic ${showHeader?'indented':''} ${state.currentLesson===lid?'active':''} ${done?'done':''}" onclick="loadLesson('${lid}')">
                <div class="check">${done?'‚úì':''}</div>
                <span>${name.length>35?name.slice(0,35)+'‚Ä¶':name}</span>
              </div>`;
            }).join('');
            return header + items;
          }).join('')}
        </div>
      </div>
    `).join('');
}

function toggleDomain(id){
  openDomainId = openDomainId===id ? null : id;
  renderLearnSidebar();
}

function openDomain(id){
  openDomainId=id;
  renderLearnSidebar();
  // Load first lesson of this domain
  const d = DOMAINS.find(d=>d.id===id);
  if(d && d.topics[0] && d.topics[0].lessons[0]) loadLesson(d.topics[0].lessons[0]);
}

function selectFirstLesson(){
  if(DOMAINS[0].topics[0].lessons[0]) loadLesson(DOMAINS[0].topics[0].lessons[0]);
}

function loadLesson(lid){
  const lesson = LESSONS[lid];
  if(!lesson){ 
    document.getElementById('lesson-content').innerHTML=`<div style="padding:40px;color:var(--text2);text-align:center"><div style="font-size:48px;margin-bottom:16px">üöß</div><div style="font-family:'Syne',sans-serif;font-size:20px;color:var(--text)">Coming Soon</div><div style="margin-top:8px">This lesson is being built. Try another topic!</div></div>`;
    return;
  }
  state.currentLesson = lid;
  saveState();
  renderLearnSidebar();

  const domain = DOMAINS.find(d=>d.id===lesson.domain);
  const dColor = domain ? domain.color : '#4f8ef7';

  const contentHTML = lesson.content.map(block=>renderContentBlock(block)).join('');
  const quizHTML = lesson.quiz ? renderMidQuiz(lesson.quiz, lid) : '';

  // Find prev/next
  const allLids = DOMAINS.flatMap(d=>d.topics.flatMap(t=>t.lessons));
  const idx = allLids.indexOf(lid);
  const prev = idx>0 ? allLids[idx-1] : null;
  const next = idx<allLids.length-1 ? allLids[idx+1] : null;

  document.getElementById('lesson-content').innerHTML = `
    <div class="lesson-header">
      <div class="lesson-domain-badge" style="color:${dColor};border-color:${dColor}30;background:${dColor}12">
        ${domain?.icon} ${lesson.domainName}
      </div>
      <div class="lesson-title">${lesson.title}</div>
      <div class="lesson-subtitle">${lesson.subtitle}</div>
    </div>
    <div class="lesson-body fade-in">
      ${contentHTML}
      ${quizHTML}
    </div>
    <div class="lesson-nav">
      ${prev ? `<button class="btn btn-secondary" onclick="loadLesson('${prev}')">‚Üê Previous</button>` : '<span></span>'}
      <button class="btn btn-success" onclick="completeLesson('${lid}','${next||''}')">
        ${state.lessonsCompleted.includes(lid) ? '‚úì Completed' : 'Mark Complete +50 XP'} ‚Üí
      </button>
      ${next ? `<button class="btn btn-secondary" onclick="loadLesson('${next}')">Next ‚Üí</button>` : ''}
    </div>
  `;
}

function renderContentBlock(block){
  if(block.type==='analogy') return `
    <div class="concept-block">
      <div class="analogy-box">
        <div class="label">${block.label}</div>
        <p>${block.text}</p>
      </div>
    </div>`;
  if(block.type==='section') return `
    <div class="concept-block">
      <div class="concept-title">
        <div class="icon" style="background:${block.bg}22;color:${block.bg}">${block.icon}</div>
        ${block.title}
      </div>
      ${block.items.map(i=>renderContentBlock(i)).join('')}
    </div>`;
  if(block.type==='definition') return `
    <div class="definition-box">
      <div class="label">${block.label}</div>
      <p>${block.text}</p>
    </div>`;
  if(block.type==='tip') return `
    <div class="tip-box">
      <div class="label">${block.label||'üí° Exam Tip'}</div>
      <p>${block.text}</p>
    </div>`;
  if(block.type==='text') return `<p class="concept-text">${block.text}</p>`;
  if(block.type==='terms') return `
    <div class="term-grid">
      ${block.terms.map(t=>`
        <div class="term-card">
          <div class="term">${t.term}</div>
          <div class="def">${t.def}</div>
        </div>`).join('')}
    </div>`;
  if(block.type==='table') return `
    <div class="table-wrap">
      <table>
        <tr>${block.headers.map(h=>`<th>${h}</th>`).join('')}</tr>
        ${block.rows.map(r=>`<tr>${r.map(c=>`<td>${c}</td>`).join('')}</tr>`).join('')}
      </table>
    </div>`;
  return '';
}

function renderMidQuiz(quiz, lid){
  return `
    <div class="quiz-section" id="mq-${lid}">
      <div class="quiz-section-header">
        <div class="qs-icon">üß™</div>
        <div>
          <h3>Quick Check</h3>
          <p>${quiz.length} questions to reinforce what you just learned</p>
        </div>
      </div>
      ${quiz.map((q,i)=>renderMidQItem(q,i,lid)).join('')}
    </div>`;
}

function renderMidQItem(q, i, lid){
  return `
    <div style="margin-bottom:24px;padding:20px;background:var(--bg);border:1px solid var(--border);border-radius:12px" id="mqi-${lid}-${i}">
      <div style="font-size:14px;font-weight:600;margin-bottom:14px;line-height:1.6">${i+1}. ${q.q}</div>
      ${q.choices.map((c,ci)=>`
        <button class="choice-btn" onclick="answerMidQ('${lid}',${i},${ci})" id="mqc-${lid}-${i}-${ci}" style="margin-bottom:8px">
          <span class="choice-letter">${String.fromCharCode(65+ci)}</span>
          <span>${c}</span>
        </button>`).join('')}
      <div id="mqf-${lid}-${i}" class="q-feedback"></div>
    </div>`;
}

function answerMidQ(lid,qi,ci){
  const q = LESSONS[lid].quiz[qi];
  const fb = document.getElementById(`mqf-${lid}-${qi}`);
  document.querySelectorAll(`[id^="mqc-${lid}-${qi}-"]`).forEach(el=>el.disabled=true);
  const correct = ci === q.answer;
  document.getElementById(`mqc-${lid}-${qi}-${ci}`).classList.add(correct?'correct':'incorrect');
  if(!correct) document.getElementById(`mqc-${lid}-${qi}-${q.answer}`).classList.add('correct');
  fb.innerHTML = `
    <div class="${correct?'feedback-correct':'feedback-incorrect'}">
      <div class="feedback-title ${correct?'good':'bad'}">${correct?'‚úÖ Correct!':'‚ùå Not quite'}</div>
      <div class="feedback-explain">${q.explain}</div>
    </div>`;
  fb.classList.add('show');
  if(correct) addXP(25);
}

function completeLesson(lid, nextLid){
  if(!state.lessonsCompleted.includes(lid)){
    state.lessonsCompleted.push(lid);
    const lesson = LESSONS[lid];
    if(lesson){
      const dm = state.domainMastery;
      const d = lesson.domain;
      const totalInDomain = DOMAINS.find(x=>x.id===d)?.topics.reduce((a,t)=>a+t.lessons.length,0)||1;
      const doneInDomain = state.lessonsCompleted.filter(l=>LESSONS[l]&&LESSONS[l].domain===d).length;
      dm[d] = Math.round((doneInDomain/totalInDomain)*100);
    }
    addXP(50);
    saveState();
    renderLearnSidebar();
    showNotification('üéâ Lesson Complete! +50 XP');
  }
  if(nextLid) loadLesson(nextLid);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PROVE MODE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let selectedQCount = 25;

function selectMode(m){
  currentMode = m;
  document.querySelectorAll('.mode-card').forEach(el=>el.classList.remove('selected'));
  document.getElementById('mode-'+m).classList.add('selected');
  document.getElementById('domain-selector').style.display = m==='domain' ? 'block' : 'none';
  if(m==='domain' && !document.getElementById('domain-select-btns').innerHTML){
    document.getElementById('domain-select-btns').innerHTML = DOMAINS.map(d=>`
      <button class="btn btn-secondary" onclick="selectDomain(${d.id},this)" style="gap:6px">
        ${d.icon} Domain ${d.id}
      </button>`).join('');
  }
}

function selectDomain(id, btn){
  selectedDomain = id;
  document.querySelectorAll('#domain-select-btns .btn').forEach(b=>{
    b.classList.remove('btn-primary'); b.classList.add('btn-secondary');
  });
  btn.classList.remove('btn-secondary'); btn.classList.add('btn-primary');
}

function setQCount(n){
  selectedQCount = n;
  document.querySelectorAll('[id^="q"]').forEach(b=>b.style.background='');
  document.getElementById('q'+n).style.background='var(--accent)';
  document.getElementById('q'+n).style.color='#fff';
}

function startProveMode(mode){
  let pool = [...QUESTIONS];
  if(mode==='domain' && selectedDomain) pool = pool.filter(q=>q.domain===selectedDomain);
  // Adaptive: weight by difficulty level
  if(mode==='adaptive'){
    pool.sort((a,b)=>{
      const da = Math.abs(a.diff - state.difficulty);
      const db = Math.abs(b.diff - state.difficulty);
      return da - db + (Math.random()-.5)*0.5;
    });
  } else {
    pool.sort(()=>Math.random()-.5);
  }
  const num = Math.min(selectedQCount, pool.length);
  quizSession = { qs: pool.slice(0,num), idx:0, score:0, selected:null, answered:false, mode };
  showProveQuiz();
}

function showProveQuiz(){
  document.getElementById('prove-setup').style.display='none';
  document.getElementById('prove-quiz').style.display='block';
  renderQuestion();
}

function renderQuestion(){
  const {qs,idx,score} = quizSession;
  if(idx>=qs.length){ showQuizComplete(); return; }
  const q = qs[idx];
  const pct = Math.round((idx/qs.length)*100);
  const diffLabels = {1:'Easy',2:'Medium',3:'Hard',4:'Expert'};
  const diffClass = {1:'diff-easy',2:'diff-medium',3:'diff-hard',4:'diff-expert'};
  const domain = DOMAINS.find(d=>d.id===q.domain);

  document.getElementById('prove-quiz').innerHTML = `
    <div class="question-ui fade-in">
      <div class="q-header">
        <span class="q-difficulty ${diffClass[q.diff]}">${diffLabels[q.diff]}</span>
        <div class="q-progress-track"><div class="q-progress-fill" style="width:${pct}%"></div></div>
        <span class="q-counter">Q${idx+1} of ${qs.length} ¬∑ ${score} correct</span>
      </div>
      <div class="q-body">
        <div class="q-domain-tag" style="color:${domain?.color||'#4f8ef7'};border-color:${domain?.color||'#4f8ef7'}30;background:${domain?.color||'#4f8ef7'}10">
          ${domain?.icon} ${q.domain_name}
        </div>
        ${q.scenario ? `<div class="q-scenario">${q.scenario}</div>` : ''}
        <div class="q-text">${q.q}</div>
        <div class="choices" id="choices">
          ${q.choices.map((c,ci)=>`
            <button class="choice-btn" onclick="selectAnswer(${ci})" id="ch-${ci}">
              <span class="choice-letter">${String.fromCharCode(65+ci)}</span>
              <span>${c}</span>
            </button>`).join('')}
        </div>
        <div id="q-feedback" class="q-feedback"></div>
      </div>
      <div class="q-footer">
        <button class="btn btn-secondary" id="submit-btn" onclick="submitAnswer()" disabled>Submit Answer</button>
      </div>
    </div>`;

  quizSession.selected = null;
  quizSession.answered = false;
}

function selectAnswer(ci){
  if(quizSession.answered) return;
  quizSession.selected = ci;
  document.querySelectorAll('.choice-btn').forEach((b,i)=>{
    b.style.borderColor = i===ci ? 'var(--accent)' : '';
    b.style.background = i===ci ? 'rgba(79,142,247,0.1)' : '';
  });
  document.getElementById('submit-btn').disabled = false;
}

function submitAnswer(){
  if(quizSession.answered || quizSession.selected===null) return;
  quizSession.answered = true;
  const q = quizSession.qs[quizSession.idx];
  const sel = quizSession.selected;
  const correct = sel === q.answer;

  // Update choices
  document.querySelectorAll('.choice-btn').forEach((b,i)=>{
    b.disabled = true;
    b.style.borderColor = ''; b.style.background = '';
    if(i===q.answer) b.classList.add('correct');
    if(i===sel && !correct) b.classList.add('incorrect');
  });

  // Feedback
  const fb = document.getElementById('q-feedback');
  fb.innerHTML = `
    <div class="${correct?'feedback-correct':'feedback-incorrect'}">
      <div class="feedback-title ${correct?'good':'bad'}">${correct?'‚úÖ Correct! +25 XP':'‚ùå Incorrect'}</div>
      <div class="feedback-explain">${q.explain}</div>
    </div>`;
  fb.classList.add('show');

  // Score
  if(correct){ quizSession.score++; addXP(25); }

  // Adaptive difficulty
  if(quizSession.mode==='adaptive'){
    const lastFive = quizSession.qs.slice(Math.max(0,quizSession.idx-4),quizSession.idx+1);
    const recentCorrect = lastFive.filter((x,i)=>i<lastFive.length && quizSession.score>0).length;
    if(correct && state.difficulty < 4) state.difficulty = Math.min(4, state.difficulty + 0.3);
    if(!correct && state.difficulty > 1) state.difficulty = Math.max(1, state.difficulty - 0.2);
    saveState();
  }

  // Update domain stats
  if(!state.questionStats.byDomain[q.domain]) state.questionStats.byDomain[q.domain]={c:0,t:0};
  state.questionStats.byDomain[q.domain].t++;
  state.questionStats.total++;
  if(correct){ state.questionStats.byDomain[q.domain].c++; state.questionStats.correct++; }
  saveState();

  // Update button
  const footer = document.querySelector('.q-footer');
  footer.innerHTML = `<button class="btn btn-primary" onclick="nextQuestion()">Next Question ‚Üí</button>`;
}

function nextQuestion(){
  quizSession.idx++;
  renderQuestion();
}

function showQuizComplete(){
  const {score,qs} = quizSession;
  const pct = Math.round((score/qs.length)*100);
  const grade = pct>=90?'üèÜ Mastery!':pct>=75?'‚úÖ Solid Work':pct>=60?'üìà Getting There':'üîÑ Keep Practicing';

  document.getElementById('prove-quiz').innerHTML='';
  document.getElementById('prove-setup').style.display='block';

  document.getElementById('modal-content').innerHTML = `
    <div style="text-align:center;margin-bottom:24px">
      <div style="font-size:56px;margin-bottom:12px">${pct>=75?'üéØ':'üí™'}</div>
      <div class="modal-title">${grade}</div>
      <div class="modal-sub">You scored <strong style="color:var(--accent)">${score}/${qs.length}</strong> ‚Äî ${pct}%</div>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px">
      <div class="stat-card" style="text-align:center">
        <div class="stat-label">Correct</div>
        <div class="stat-value" style="color:var(--success)">${score}</div>
      </div>
      <div class="stat-card" style="text-align:center">
        <div class="stat-label">Score</div>
        <div class="stat-value" style="color:var(--accent)">${pct}%</div>
      </div>
    </div>
    ${pct<75?`<div class="tip-box"><div class="label">üí° Study Tip</div><p>Review the lessons for domains where you missed questions. The Learn section has detailed explanations with real-world analogies.</p></div>`:''}
  `;

  document.getElementById('quiz-done-modal').classList.add('open');
  addXP(pct>=90?100:pct>=75?50:25);
}

function closeModal(){
  document.getElementById('quiz-done-modal').classList.remove('open');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderStats(){
  const total = state.questionStats.total;
  const correct = state.questionStats.correct;
  const pct = total>0?Math.round((correct/total)*100):0;
  document.getElementById('stats-grid').innerHTML = `
    <div class="stat-card"><div class="stat-label">Questions Answered</div><div class="stat-value" style="color:var(--accent)">${total}</div><div class="stat-sub">Total practice</div></div>
    <div class="stat-card"><div class="stat-label">Accuracy Rate</div><div class="stat-value" style="color:${pct>=75?'var(--success)':pct>=60?'var(--warn)':'var(--danger)'}">${pct}%</div><div class="stat-sub">${correct} correct</div></div>
    <div class="stat-card"><div class="stat-label">XP Earned</div><div class="stat-value" style="color:var(--accent3)">${state.xp}</div><div class="stat-sub">Level ${state.level}</div></div>
    <div class="stat-card"><div class="stat-label">Lessons Done</div><div class="stat-value" style="color:var(--accent2)">${state.lessonsCompleted.length}</div><div class="stat-sub">of ${Object.keys(LESSONS).length} available</div></div>
  `;

  document.getElementById('domain-stats').innerHTML = DOMAINS.map(d=>{
    const ds = state.questionStats.byDomain[d.id] || {c:0,t:0};
    const dp = ds.t>0?Math.round((ds.c/ds.t)*100):0;
    return `
      <div style="background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:20px;margin-bottom:12px">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
          <div style="font-family:'Syne',sans-serif;font-weight:700">${d.icon} ${d.name}</div>
          <div style="font-family:'JetBrains Mono',monospace;font-size:13px;color:${d.color}">${dp}% (${ds.c}/${ds.t})</div>
        </div>
        <div class="progress-bar"><div class="progress-fill" style="width:${dp}%;background:${d.color}"></div></div>
      </div>`;
  }).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NOTIFICATIONS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showNotification(msg){
  const el = document.createElement('div');
  el.style.cssText = 'position:fixed;bottom:24px;right:24px;background:var(--surface);border:1px solid var(--border2);border-radius:12px;padding:14px 20px;font-family:Syne,sans-serif;font-weight:600;font-size:14px;z-index:999;animation:fadeIn 0.3s ease;box-shadow:0 8px 32px rgba(0,0,0,0.4)';
  el.textContent = msg;
  document.body.appendChild(el);
  setTimeout(()=>el.remove(),3000);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
renderHome();
selectMode('adaptive');
setQCount(25);

// Check streak
const today = new Date().toDateString();
if(state.lastDate !== today){
  if(state.lastDate === new Date(Date.now()-86400000).toDateString()) state.streak++;
  else if(state.lastDate !== today) state.streak = state.lastDate ? Math.max(0,state.streak) : 0;
  state.lastDate = today;
  saveState();
  updateHeader();
}

</script>
</body>
</html>
